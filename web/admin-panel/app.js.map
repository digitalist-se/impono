{"version":3,"sources":["node_modules/browser-pack/_prelude.js","app.js","src/admin-panel/app/app-prod.js","src/admin-panel/app/app.js","src/admin-panel/app/modules/condition/condition.js","src/admin-panel/app/modules/condition/entity/Condition.js","src/admin-panel/app/modules/condition/resource/ConditionResource.js","src/admin-panel/app/modules/condition/services/Condition.js","src/admin-panel/app/modules/debug/controllers/DebugOptionsController.js","src/admin-panel/app/modules/debug/controllers/WebsitesController.js","src/admin-panel/app/modules/debug/debug.js","src/admin-panel/app/modules/debug/entity/Website.js","src/admin-panel/app/modules/debug/resource/WebsiteResource.js","src/admin-panel/app/modules/integration/controllers/BaseController.js","src/admin-panel/app/modules/integration/controllers/CreateController.js","src/admin-panel/app/modules/integration/controllers/EditController.js","src/admin-panel/app/modules/integration/controllers/ManageController.js","src/admin-panel/app/modules/integration/entity/Integration.js","src/admin-panel/app/modules/integration/integration.js","src/admin-panel/app/modules/integration/resource/IntegrationResource.js","src/admin-panel/app/modules/optOut/controllers/GeneratorController.js","src/admin-panel/app/modules/optOut/optOut.js","src/admin-panel/app/modules/optOut/services/Snippet.js","src/admin-panel/app/modules/security/controller/LoginController.js","src/admin-panel/app/modules/security/interceptor/DeleteRequestInterceptor.js","src/admin-panel/app/modules/security/interceptor/LocaleInterceptor.js","src/admin-panel/app/modules/security/interceptor/SecurityInterceptor.js","src/admin-panel/app/modules/security/resource/OAuthResource.js","src/admin-panel/app/modules/security/security.js","src/admin-panel/app/modules/security/service/Authorization.js","src/admin-panel/app/modules/security/service/Security.js","src/admin-panel/app/modules/security/service/TokenStorage.js","src/admin-panel/app/modules/security/token/AuthToken.js","src/admin-panel/app/modules/tag/controllers/BaseController.js","src/admin-panel/app/modules/tag/controllers/CreateController.js","src/admin-panel/app/modules/tag/controllers/EditController.js","src/admin-panel/app/modules/tag/controllers/ManageController.js","src/admin-panel/app/modules/tag/entity/Tag.js","src/admin-panel/app/modules/tag/entity/Template.js","src/admin-panel/app/modules/tag/entity/TemplateType.js","src/admin-panel/app/modules/tag/providers/TemplatesProvider.js","src/admin-panel/app/modules/tag/resource/TagResource.js","src/admin-panel/app/modules/tag/services/Templates.js","src/admin-panel/app/modules/tag/tag.js","src/admin-panel/app/modules/tagContainer/controllers/CreateController.js","src/admin-panel/app/modules/tagContainer/controllers/EditController.js","src/admin-panel/app/modules/tagContainer/controllers/ExplanationController.js","src/admin-panel/app/modules/tagContainer/controllers/ManageController.js","src/admin-panel/app/modules/tagContainer/controllers/PermissionsController.js","src/admin-panel/app/modules/tagContainer/controllers/PrivacyController.js","src/admin-panel/app/modules/tagContainer/entity/Container.js","src/admin-panel/app/modules/tagContainer/entity/Permission.js","src/admin-panel/app/modules/tagContainer/resource/ContainerResource.js","src/admin-panel/app/modules/tagContainer/resource/PermissionResource.js","src/admin-panel/app/modules/tagContainer/service/CurrentContainer.js","src/admin-panel/app/modules/tagContainer/service/ParamConverter.js","src/admin-panel/app/modules/tagContainer/service/PublishedStatus.js","src/admin-panel/app/modules/tagContainer/tagContainer.js","src/admin-panel/app/modules/trigger/controllers/BaseController.js","src/admin-panel/app/modules/trigger/controllers/CreateController.js","src/admin-panel/app/modules/trigger/controllers/EditController.js","src/admin-panel/app/modules/trigger/controllers/EditInsideTagController.js","src/admin-panel/app/modules/trigger/controllers/ManageController.js","src/admin-panel/app/modules/trigger/entity/Trigger.js","src/admin-panel/app/modules/trigger/resource/TriggerResource.js","src/admin-panel/app/modules/trigger/trigger.js","src/admin-panel/app/modules/update/controllers/VersionController.js","src/admin-panel/app/modules/update/directives/setVersionDirective.js","src/admin-panel/app/modules/update/resources/UpdateResource.js","src/admin-panel/app/modules/update/services/Version.js","src/admin-panel/app/modules/update/update.js","src/admin-panel/app/modules/user/controllers/BaseController.js","src/admin-panel/app/modules/user/controllers/ChangePasswordController.js","src/admin-panel/app/modules/user/controllers/CreateController.js","src/admin-panel/app/modules/user/controllers/EditController.js","src/admin-panel/app/modules/user/controllers/ManageController.js","src/admin-panel/app/modules/user/controllers/OthersSettingsController.js","src/admin-panel/app/modules/user/controllers/ResetRequestController.js","src/admin-panel/app/modules/user/controllers/SetPasswordController.js","src/admin-panel/app/modules/user/entities/User.js","src/admin-panel/app/modules/user/resources/UserResource.js","src/admin-panel/app/modules/user/user.js","src/admin-panel/app/modules/variable/controllers/BaseController.js","src/admin-panel/app/modules/variable/controllers/CreateController.js","src/admin-panel/app/modules/variable/controllers/EditController.js","src/admin-panel/app/modules/variable/controllers/ManageController.js","src/admin-panel/app/modules/variable/controllers/SelectorController.js","src/admin-panel/app/modules/variable/directives/variableClickOutside.js","src/admin-panel/app/modules/variable/directives/variableSelector.js","src/admin-panel/app/modules/variable/entity/Variable.js","src/admin-panel/app/modules/variable/entity/VariableType.js","src/admin-panel/app/modules/variable/providers/VariableFormProvider.js","src/admin-panel/app/modules/variable/resource/VariableResource.js","src/admin-panel/app/modules/variable/resource/VariableTypeResource.js","src/admin-panel/app/modules/variable/services/VariableSelector.js","src/admin-panel/app/modules/variable/variable.js","src/admin-panel/modules/alert/alert.js","src/admin-panel/modules/alert/controllers/AlertController.js","src/admin-panel/modules/alert/directives/AlertDirective.js","src/admin-panel/modules/alert/providers/AlertProvider.js","src/admin-panel/modules/alert/services/Alert.js","src/admin-panel/modules/alert/services/AlertStorage.js","src/admin-panel/modules/alert/services/RefreshAlert.js","src/admin-panel/modules/alert/services/UniqueStorage.js","src/admin-panel/modules/clipboard/clipboard.js","src/admin-panel/modules/clipboard/directives/clipboardDirective.js","src/admin-panel/modules/confirm/confirm.js","src/admin-panel/modules/confirm/directives/ConfirmDirective.js","src/admin-panel/modules/form/controller/AlertFormController.js","src/admin-panel/modules/form/directives/AlertFormDirective.js","src/admin-panel/modules/form/directives/CheckboxDirective.js","src/admin-panel/modules/form/directives/RadioButtonDirective.js","src/admin-panel/modules/form/directives/SelectDirective.js","src/admin-panel/modules/form/form.js","src/admin-panel/modules/form/services/AlertForm.js","src/admin-panel/modules/helpSystem/directives/HelpSystemDirective.js","src/admin-panel/modules/helpSystem/helpSystem.js","src/admin-panel/modules/pageInfo/controllers/BreadcrumbController.js","src/admin-panel/modules/pageInfo/controllers/TitleController.js","src/admin-panel/modules/pageInfo/directives/BreadcrumbDirective.js","src/admin-panel/modules/pageInfo/directives/TitleDirective.js","src/admin-panel/modules/pageInfo/pageInfo.js","src/admin-panel/modules/pageInfo/services/PageInfo.js","src/admin-panel/modules/sanitize/filters/tmCeilFilter.js","src/admin-panel/modules/sanitize/filters/tmDateFilter.js","src/admin-panel/modules/sanitize/sanitize.js","src/admin-panel/modules/textEditor/service/HTMLLinter.js","src/admin-panel/modules/textEditor/service/LintingRules.js","src/admin-panel/modules/textEditor/service/TagTemplateLinter.js","src/admin-panel/modules/textEditor/service/TagTemplateToJsConverter.js","src/admin-panel/modules/textEditor/service/TextEditorConfig.js","src/admin-panel/modules/textEditor/textEditor.js","src/admin-panel/modules/translation/factory/TranslationFactory.js","src/admin-panel/modules/translation/services/Translation.js","src/admin-panel/modules/translation/translation.js","src/admin-panel/modules/validator/directives/stgFormDirective.js","src/admin-panel/modules/validator/validator.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","_app","MODULE_NAME","angular","element","document","ready","bootstrap","./app.js",2,"_security","_update","_user","_tagContainer","_tag","_trigger","_variable","_integration","_condition","_debug","_optOut","_alert","_translation","_form","_confirm","_sanitize","_clipboard","_pageInfo","_helpSystem","_validator","_textEditor","run","$rootScope","$state","$alertProvider","security","OAuthResource","tokenStorage","authService","$variableFormProvider","removeToken","addType","templateUrl","addMessagePattern","animateSidebarReady","isContainerView","$on","event","toState","toStateParams","hasContainerList","undefined","data","isAuthenticated","activeContainerId","containerId","authToken","getItem","refreshToken","then","addItem","loginConfirmed","config","headers","Authorization","getToken","removeItem","loginCancelled","go","$urlRouterProvider","ngClipProvider","$translateProvider","otherwise","setPath","useSanitizeValueStrategy","useStaticFilesLoader","prefix","suffix","preferredLanguage","useLocalStorage","value","wrapperClass","filter","items","slice","reverse","./../modules/alert/alert.js","./../modules/clipboard/clipboard.js","./../modules/confirm/confirm.js","./../modules/form/form.js","./../modules/helpSystem/helpSystem.js","./../modules/pageInfo/pageInfo.js","./../modules/sanitize/sanitize.js","./../modules/textEditor/textEditor.js","./../modules/translation/translation.js","./../modules/validator/validator.js","./modules/condition/condition.js","./modules/debug/debug.js","./modules/integration/integration.js","./modules/optOut/optOut.js","./modules/security/security.js","./modules/tag/tag.js","./modules/tagContainer/tagContainer.js","./modules/trigger/trigger.js","./modules/update/update.js","./modules/user/user.js","./modules/variable/variable.js",3,"_interopRequireDefault","obj","__esModule","default","_ConditionResource","_ConditionResource2","_Condition","_Condition2","$inject","service","./resource/ConditionResource.js","./services/Condition.js",4,"_classCallCheck","instance","Constructor","TypeError","Object","defineProperty","conditionFactory","Condition","this","id","variable","condition",5,"_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","ConditionResource","$http","$q","http","q","deferred","defer","method","url","success","resp","resolve","error","err","reject","promise","../entity/Condition.js",6,"mergeVariables","arrayFirst","arraySecond","final","indexFirst","shared","indexSecond","isVariablesNameEqual","push","concat","variableFirst","variableSecond","name","findTypeByType","array","type","tempType","currentContainer","conditionResource","$conditionResource","$currentContainer","getId","conditionResourcePromise","query","typesTemp","typesIndex","variables","index","responsedTypes","actions",7,"state","stateParams","scope","translate","BREADCRUMB_TEXT","DebugOptionsController","containerResource","$stateParams","CurrentContainer","PageInfo","$scope","$translate","_this","container","getEntityObject","containerPromise","get","getContainer","$container","hasPermission","translations","clear","add","broadcast","args",8,"alert","websitesResource","WebsitesController","$websitesResource","$alert","websites","websitesPromise","parameterTypes","getWebsiteUrlWithParameter","website","getUrlWithParameter","splice","_this2","parameterType","websitePromise","put","validateContainer",9,"_DebugOptionsController","_DebugOptionsController2","_WebsitesController","_WebsitesController2","_WebsiteResource","_WebsiteResource2","MODULE_CONTAINER","MODULE_DIR","currentContainerLoading","loadContainer","currentContainerPromise","$broadcast","toParams","$stateProvider","controller","roles","permission","./controllers/DebugOptionsController.js","./controllers/WebsitesController.js","./resource/WebsiteResource.js",10,"websiteFactory","DEBUG_PARAM_NAME","URL_MIN_LENGTH","Website","hasUrl","getSeparator","separator","indexOf",11,"isResponseSuccess","status","_Website","_Website2","transformResponse","isArray","map","websiteData","parameter_type","appendTransform","defaults","transform","WebsiteResource","params","header","_this3","../entity/Website.js",12,"BaseController","$Integration","$PageInfo","integration","formTouched","getBreadcrumbText","Integration","integrationPromise","save","getAlertType","includes","integrationId","validateIntegration",13,"_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","_BaseController2","_BaseController3","CreateController","_BaseController","$IntegrationResource","getPrototypeOf","./BaseController.js",14,"EditController",15,"ManageController","TableParams","paramConverter","permissions","tableParams","page","count","sorting","total","getData","$defer","list","remove","reload",16,"integrationFactory","resource","clientId","clientSecret","createdAt","updatedAt","user","result","excludedProperty","property","isFunction","hasOwnProperty","email","post",17,"_ManageController","_ManageController2","_CreateController","_CreateController2","_EditController","_EditController2","_IntegrationResource","_IntegrationResource2","./controllers/CreateController.js","./controllers/EditController.js","./controllers/ManageController.js","./resource/IntegrationResource.js",18,"_Integration","_Integration2","client_id","client_secret","created_at","updated_at","IntegrationResource","entity","_this4","../entity/Integration.js",19,"snippet","defaultOptOutMessage","defaultOptIn","defaultOptOut","GeneratorController","$snippet","options","option","optOutMessage","optInOption","optOutOption","$watch","generateSnippet","setPageInfo","buildSnippet","replace",20,"_GeneratorController","_GeneratorController2","_Snippet","_Snippet2","./controllers/GeneratorController.js","./services/Snippet.js",21,"optOutOpeningComment","optOutClosingComment","hostname","window","location","Snippet","optInMessage","message","buildVariablesInitialization","buildExternalScript","buildMainMessage",22,"$oauthResource","$tokenStorage","$alertForm","LoginController","oauthResource","alertForm","auth","identity","password","loginPromise","getStorage","clean","loading",23,"deleteRequestInterceptor","$injector","METHOD_DELETE","POST_DELETE_URL_SUFIX","request","toUpperCase","deleteHeaderNotSupported","responseError","rejection",24,"DEFAULT_LANGUAGE","localeInterceptor","$window","localStorageLang","localStorage","test","Locale",25,"securityInterceptor",26,"_AuthToken","_AuthToken2","RESOURCE_ROUTE","LOGOUT_ROUTE","GRANT_TYPE","response","getEntity","accessToken","access_token","expiresIn","expires_in","tokenType","token_type","refresh_token","OAuthClientSettings","grant_type","username","ignoreAuthModule","token","../token/AuthToken.js",27,"_LoginController","_LoginController2","_Authorization","_Authorization2","_Security","_Security2","_OAuthResource","_OAuthResource2","_TokenStorage","_TokenStorage2","_SecurityInterceptor","_SecurityInterceptor2","_LocaleInterceptor","_LocaleInterceptor2","_DeleteRequestInterceptor","_DeleteRequestInterceptor2","$httpProvider","interceptors","controllerAs","secure","authorization","logout","disableDebugMode","isSecure","isDataDefined","authorize","OAUTH_CLIENT_ID","OAUTH_CLIENT_SECRET","factory","./controller/LoginController.js","./interceptor/DeleteRequestInterceptor.js","./interceptor/LocaleInterceptor.js","./interceptor/SecurityInterceptor.js","./resource/OAuthResource.js","./service/Authorization.js","./service/Security.js","./service/TokenStorage.js",28,"doNotEnter","hasAnyRole","$security","getUser",29,"Security","$timeout","userResource","timeout","authenticated","checked","roleString","isSuperAdmin","hasRole","use","language","force","reloadUser","authenticate","getMe",30,"TokenStorage","$localStorage","JSON","parse","capitalizeFirstLetter","stringify","string","charAt",31,"AuthToken",32,"filterTriggersForSynchronousTags","triggers","SYNCHRONOUS_TAGS_TRIGGER_TYPES","BREADCRUMB_GLOBAL","TAG_TEMPLATE_TAB_ASYNC","TAG_TEMPLATE_TAB_SYNC","PAGE_VIEW_TRIGGER_TYPE","DOM_READY_TRIGGER_TYPE","PAGE_LOAD_TRIGGER_TYPE","$tagResource","$triggerResource","$variableResource","$TableParams","$paramConverter","templatesStorage","triggerResource","tag","tagPromise","chosenTriggers","triggerPromise","displayStepsAfterFirst","synchronousTemplates","asynchronousTemplates","triggersWhenTagIsAsync","tagTemplateTab","divideTemplatesBasedOnSynchronicity","template","textEditorConfig","isCodeEditorFocused","queryAllAvailable","onLoad","cm","insertVariableIntoCode","doc","replaceSelection","focus","on","addTrigger","showTriggerForm","validateTriggers","editTrigger","editTriggerForm","placeholder","alreadyLoadedTemplates","getAll","classifyTemplate","isSynchronous","classifyAfterAllTemplateDataLoaded","setListener","variablesNotEmpty","isTagTemplateTabActive","tab","keepCurrentTemplate","deselectCurrentTemplate","rememeberCurrentTriggers","documentWirteWhenTagIsAsync","documentWrite","allTags","triggersAssignableToSyncTags","templateIsTracking","hasSelectedPluginTemplate","isTracking","hasSelectedCustomTemplate","selectedSameTemplateAsCurrent","requiresAdditionalSelectTemplateType","types","setTemplateType","respectVisitorsPrivacy","setTagTemplateTab","templateOptions","templateFields","getOptions","getTemplateUrl","selectedSameTypeAsCurrent","setOptions","fieldsLength","prepareExistingTriggersList","showListTriggersForm","existingTable","parameters","trigger","chosenLength","tagId","makeChanges","validateTag","hasSelectedTemplate",33,"TemplatesStorage",34,"initTagTemplate",35,"tagResource","publishedStatus","addReloadOnPublishListener","showTriggers","showMenu","newParams","oldParams","settings","deregisterPublishListener","changeStatus","getPublishedStatusForTag","$index","isRowExpanded",36,"tagFactory","Tag","priority","disableInDebugMode","isActive","statusChangePending","collection","copy",37,"_TemplateType","_TemplateType2","templateFactory","TemplateType","Template","brandUrl","fields","field","../entity/TemplateType.js",38,"templateTypeFactory",39,"_Template","_Template2","TemplatesProvider","onAddListener","listener","templateLength","../entity/Template.js",40,"_Tag","_Tag2","document_write","disable_in_debug_mode","is_active","respect_visitors_privacy","is_synchronous","template_options","TagResource","../entity/Tag.js",41,"findByKey","collectionLength","Templates","$templates","templatesService","typeId",42,"_TagResource","_TagResource2","_Templates","_Templates2","_TemplatesProvider","_TemplatesProvider2","MODULE_TRIGGER","MODULE_VARIABLE","MODULE_TAG_CONTAINER","provider","./providers/TemplatesProvider.js","./resource/TagResource.js","./services/Templates.js",43,44,"pageInfo","refreshBreadcrumb","breadcrumbText",45,"PAGE_TITLE","ExplanationController",46,"DEBOUNCE_TIMEOUT","currentFilterQuery","filterQuery","queryParam","useSearchByName","cancel","debounce","getPublishedStatusForContainer","searchCallback","search",47,"permissionsResource","PermissionsController","$permissionsResource","permissionsPromise","usersTable","tempRequest",48,"PrivacyController","privacyPromise","getPrivacyOptOut",49,"containerFactory","Container","codeSynchronous","version","hasUnpublishedChanges","publishedAt","delay","permissionsPrioritiedArray","text","permissionIndex",50,"permissionFactory","Permission",51,"_Container","_Container2","description","code_synchronous","has_unpublished_changes","published_at","ContainerResource","../entity/Container.js",52,"_Permission","_Permission2","permissionList","PermissionResource","../entity/Permission.js",53,"$containerResource","rootScope","cookies","PREVIEW_KEY","DEBUG_KEY","$cookies","debugMode","previewedContainer","verifyDebugMode","setTypes","publishPromise","publishVersion","restorePromise","restoreVersion","isTagView","isTriggerView","isDebugModeEnabled","cookiesDebug","previewedContainerText","cookiesPreview","_this5","respIndex","mapped",54,"ParamConverter","limit","offset",55,"getPublishedState","wasNeverPublished","containerHasBeenPublished","PUBLISHED_STATE","STATE_NEVER_PUBLISHED","STATE_DRAFT","STATE_PUBLISHED","STATE_WAITING_FOR_CONTAINER_DATA","class","PublishedStatus","dateTagChanged","Date","dateTagCreated","dateContainerPublished","tagIsDirty","tagCreatedAfterLastPublish",56,"_ExplanationController","_ExplanationController2","_PermissionsController","_PermissionsController2","_PrivacyController","_PrivacyController2","_ContainerResource","_ContainerResource2","_PermissionResource","_PermissionResource2","_ParamConverter","_ParamConverter2","_CurrentContainer","_CurrentContainer2","_PublishedStatus","_PublishedStatus2","DEBUG_MODULE_NAME","./controllers/ExplanationController.js","./controllers/PermissionsController.js","./controllers/PrivacyController.js","./resource/ContainerResource.js","./resource/PermissionResource.js","./service/CurrentContainer.js","./service/ParamConverter.js","./service/PublishedStatus.js",57,"PAGE_VIEW_TYPES","NOT_VISIBLE_TRIGGER_TYPES","$condition","filterVisibleTriggerTypes","required","typesArrayPromise","getArrayOfTypes","pageViewTriggerTypes","typesArray","conditions","getVariables","getActions","getRequired","requiredIndex","addCondition","form","$name","$setPristine","conditionLength","$valid","$invalid","variablesIndex","conditionName","conditionsIndex","isEmbededInsideSynchronousTagForm","isAddedToSynchronousTag","view",58,"setType","$emit",59,"triggerId","triggerResp","typesResp",60,61,62,"triggerFactory","Trigger","subtype","tagsCount",63,"addTriggerSubtypesInfo","DOM_READY_SUBTYPE","PAGE_LOAD_SUBTYPE","removeTriggerSubtypesInfo","_Trigger","_Trigger2","tags_count","is_added_to_synchronous_tag","transformRequest","TriggerResource","../entity/Trigger.js",64,"_EditInsideTagController","_EditInsideTagController2","_TriggerResource","_TriggerResource2","CONDITION_MODULE_NAME","./controllers/EditInsideTagController.js","./resource/TriggerResource.js",65,"updateResource","VersionController","$updateResource","latest","isUpToDate","setSession","href",66,"setVersionDirective","restrict","stgVersion","link","current","getLatest",67,"UpdateResource","$location","domain","host","Access-Control-Request-Headers",68,"Version",69,"_VersionController","_VersionController2","_UpdateResource","_UpdateResource2","_Version","_Version2","_setVersionDirective","_setVersionDirective2","directive","./controllers/VersionController.js","./directives/setVersionDirective.js","./resources/UpdateResource.js","./services/Version.js",70,"BREADCRUMB_SECTION","refreshAlert","ACTIVATION_SET_PASSWORD","ROLE_API","ROLE_USER","ROLE_SUPER_ADMIN","ROLE_CONTAINERS_CREATE","userPromise","activation","role","createContainerRole","getUserRole","roleIndex","saveMe",71,"ChangePasswordController","$userResource","validationForce","changePasswordPromise","currentPassword","plainPassword","first","second","newPassword","current_password","changePassword","changePasswordForm","$error",72,"ACTIVATION_EMAIL","RefreshAlert","isValid","createUserForm","$dirty",73,"setUser","userId","editUserForm",74,"resetPromise","resetPassword",75,"translation","OthersSettingsController","$translation","languages","getLanguages","loadTranslationsPromise","loadAvailableTranslations","storedLanguage","othersSettingsPromise","saveOthersSettings","User",76,"ResetRequestController","formTitle",77,"setPassword","resetPasswordForm",78,"userFactory","firstName","lastName","displayName","excludedInEdit","putMe","othersSettingsMe",79,"_User","_User2","CHANGE_PASSWORD_ROUTE","RESET_REQUEST_ROUTE","RESET_PASSWORD_ROUTE","first_name","last_name","display_name","UserResource","_this6","_this7","../entities/User.js",80,"_OthersSettingsController","_OthersSettingsController2","_ChangePasswordController","_ChangePasswordController2","_ResetRequestController","_ResetRequestController2","_SetPasswordController","_SetPasswordController2","_UserResource","_UserResource2","./controllers/ChangePasswordController.js","./controllers/OthersSettingsController.js","./controllers/ResetRequestController.js","./controllers/SetPasswordController.js","./resources/UserResource.js",81,"$typeResource","typeResource","variableFormProvider","typesPromise","getType","variablePromise","refresh","validateVariable",82,"getVariableTypes",83,"variableId",84,"variableResource",85,"stopBubblingEvent","stopPropagation","cancelBubble","compileListView","listTemplate","getElementById","html","compile","createWrapper","listElement","btnElement","variableSelector","getTemplate","inputGroupWrapper","wrap","getElementWrapper","parent","append","SelectorController","$compile","$variableSelector","allVariables","$element","$ngModel","ngModel","ulElement","children","elementValue","val","trim","isVariablesListVisible","removeVariablePrompt","addVariablePrompt","toggleClass","removeClass","$setViewValue","selectVariable","$render","hasClass",86,"variableClickOutside","$document","attrs","selectorCtrl","documentOnClick","outside","contains","listVisible","closeVariablePrompt","off",87,"_SelectorController","_SelectorController2","variableSelectorDirective","controllers","selectorController","init","bindToController","../controllers/SelectorController.js",88,"variableFactory","Variable",89,"variableTypeFactory","VariableType","helper",90,"VariableFormProvider",91,"_Variable","_Variable2","VariableResource","../entity/Variable.js",92,"_VariableType","_VariableType2","VariableTypeResource","../entity/VariableType.js",93,"isVariablePromptOpen","openVariablePrompt","_removeVariablePrompt","substring","elementWrapper","VariableSelector",94,"_VariableResource","_VariableResource2","_VariableTypeResource","_VariableTypeResource2","_VariableFormProvider","_VariableFormProvider2","_VariableSelector","_VariableSelector2","_variableSelector","_variableSelector2","_variableClickOutside","_variableClickOutside2","./controllers/SelectorController","./directives/variableClickOutside.js","./directives/variableSelector.js","./providers/VariableFormProvider.js","./resource/VariableResource.js","./resource/VariableTypeResource.js","./services/VariableSelector.js",95,"_AlertProvider","_AlertProvider2","_AlertController","_AlertController2","_AlertDirective","_AlertDirective2","_Alert","_Alert2","_RefreshAlert","_RefreshAlert2","_AlertStorage","_AlertStorage2","_UniqueStorage","_UniqueStorage2","./controllers/AlertController.js","./directives/AlertDirective.js","./providers/AlertProvider.js","./services/Alert.js","./services/AlertStorage.js","./services/RefreshAlert.js","./services/UniqueStorage.js",96,"AlertController","AlertStorage","storage","getAlerts",97,"alertDirective","Alert","alertProvider","interval","isDefined",98,"_typeof","Symbol","iterator","AlertProvider","messagePatterns","pattern","patterns","forEach","isObject","elem",99,"removeAfterTimeout","addAlert","convertToMessage","extend","INFO_TYPE","ERROR_TYPE","SUCCESS_TYPE","arguments","getMessagePattern","vsprintf",100,"indicator",101,"_get","object","receiver","Function","desc","getOwnPropertyDescriptor","getter","_Alert3","localStorageKey","./Alert.js",102,"_AlertStorage3","UniqueStorage","apply","has","./AlertStorage.js",103,"_clipboardDirective","_clipboardDirective2","./directives/clipboardDirective.js",104,"clipboardDirective","setCopyButtonVisible","setVisible","eventTriggeredOverTextArea","button","addClass","srcElement","nodeName","tplElement","clipboard","find","copyToClipboard",105,"_ConfirmDirective","_ConfirmDirective2","./directives/ConfirmDirective.js",106,"confirmDirective","transclude","ccConfirm","turnOn","approve","confirm",107,"_AlertController3","AlertFormController","../../alert/controllers/AlertController.js",108,"alertFormDirective",109,"CheckboxDirective","ngDisabled","updateViewFromValue","isEqualToCustomTrueValue","checkedClass","ngTrueValue","disabledClass","isDisabled",110,"RadioButtonDirective","ccRadioModel","ccDisabled","defaultValue",111,"SelectDirective","ccSelectOptions","ccSelectValue","ccSelectLabel","tmpElement","searchByValue","getActiveOptionLabel","changeSelection",112,"_CheckboxDirective","_CheckboxDirective2","_RadioButtonDirective","_RadioButtonDirective2","_SelectDirective","_SelectDirective2","_AlertForm","_AlertForm2","_AlertFormDirective","_AlertFormDirective2","_AlertFormController","_AlertFormController2","./controller/AlertFormController.js","./directives/AlertFormDirective.js","./directives/CheckboxDirective.js","./directives/RadioButtonDirective.js","./directives/SelectDirective.js","./services/AlertForm.js",113,"AlertForm","../../alert/services/Alert.js",114,"helpSystemDirective","content","placement",115,"_HelpSystemDirective","_HelpSystemDirective2","./directives/HelpSystemDirective.js",116,"BreadcrumbController","breadcrumb",117,"DEFAULT_TITLE","TitleController","title","info","setTitle","reduce","previous",118,"breadcrumbDirective",119,"titleDirective",120,"_BreadcrumbController","_BreadcrumbController2","_TitleController","_TitleController2","_BreadcrumbDirective","_BreadcrumbDirective2","_PageInfo","_PageInfo2","_TitleDirective","_TitleDirective2","./controllers/BreadcrumbController.js","./controllers/TitleController.js","./directives/BreadcrumbDirective.js","./directives/TitleDirective.js","./services/PageInfo.js",121,"navigation",122,"tmCeilFilter","number","Math","ceil",123,"tmDateFilter","$filter","defaultDateFormat","angularDateFilter","theDate","format",124,"_tmDateFilter","_tmDateFilter2","_tmCeilFilter","_tmCeilFilter2","./filters/tmCeilFilter.js","./filters/tmDateFilter.js",125,"HTMLLinter","lintRules","HTMLHint","verify",126,"HTML_LINT_RULES","tagname-lowercase","attr-lowercase","attr-value-double-quotes","attr-value-not-empty","attr-no-duplication","doctype-first","tag-pair","tag-self-close","spec-char-escape","id-unique","src-not-empty","title-require","head-script-disabled","doctype-html5","id-class-value","style-disabled","inline-style-disabled","inline-script-disabled","space-tab-mixed-disabled","id-class-ad-disabled","href-abs-or-rel","attr-unsafe-chars","JS_LINT_RULES","browser","devel","dojo","jquery","mootools","nonstandard","prototypejs","yui","bitwise","camelcase","curly","enforceall","eqeqeq","es3","es5","forin","freeze","funcscope","futurehostile","immed","latedef","nocomma","nonew","notypeof","shadow","strict","sub","undef","unused","asi","LintingRules","jsHintRules","htmlHintRules","jshint",127,"HTML_HEAD_WRAP_START","HTML_HEAD_WRAP_END","TagTemplateLinter","tagTemplateToJsConverter","lintingRules","htmlLinter","deactivate","htmlWrappedText","wrapInHtmlTag","lines","split","convert","tagTemplateWithFixedJsText","join","allErrors","lint","jsErrors","filterOutHtmlErrors","errors","mapToLintRepresentation","lineCount","isHtmlError","line","lastLineIdx","getLintingRules","from","CodeMirror","Pos","to","severity",128,"TAG_TEMPLATE_VARIABLE_START","TAG_TEMPLATE_VARIABLE_END","TagTemplateToJsConverter","textLines","lineIdx","isCursorAfterTheEndOfText","lineContainsVariable","replaceVariablesExpressions","totalLines","words","variableObj","createVariableSearchPattern","replacement","variableName","whitespace","regexStr","RegExp",129,"DEFAULT_CONFIG","mode","lineNumbers","styleActiveLine","matchBrackets","theme","gutters","TextEditorConfig","tagTemplateLinter","configOverrides","overrides","cfg","getAnnotations","opt","validate",130,"_TextEditorConfig","_TextEditorConfig2","_TagTemplateLinter","_TagTemplateLinter2","_TagTemplateToJsConverter","_TagTemplateToJsConverter2","_LintingRules","_LintingRules2","_HTMLLinter","_HTMLLinter2","./service/HTMLLinter.js","./service/LintingRules.js","./service/TagTemplateLinter.js","./service/TagTemplateToJsConverter.js","./service/TextEditorConfig.js",131,"translationFactory","cache",132,"Translation",133,"_TranslationFactory","_TranslationFactory2","_Translation","_Translation2","./factory/TranslationFactory.js","./services/Translation.js",134,"isPromise","stgFormDirective","isNotEmptyArray","Array","isNested","nested","formResource","formPromise","$parent","attributes","$setDirty",135,"_stgFormDirective","_stgFormDirective2","./directives/stgFormDirective.js"],"mappings":"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","file":"app.js","sourcesContent":["(function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()","(function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()({1:[function(require,module,exports){\n'use strict';\n\nvar _app = require('./app.js');\n\nvar MODULE_NAME = 'admin.application.prod'; /**\n                                             * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                             *\n                                             * This program is free software: you can redistribute it and/or modify it under\n                                             * the terms of the GNU Affero General Public License as published by the Free\n                                             * Software Foundation, either version 3 of the License, or (at your option) any\n                                             * later version.\n                                             *\n                                             * This program is distributed in the hope that it will be useful,\n                                             * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                             * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                             * GNU Affero General Public License for more details.\n                                             *\n                                             * You should have received a copy of the GNU Affero General Public License\n                                             * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                             */\n\nangular.module(MODULE_NAME, [_app.MODULE_NAME]);\n\nangular.element(document).ready(function () {\n    angular.bootstrap(document, [MODULE_NAME]);\n});\n\n},{\"./app.js\":2}],2:[function(require,module,exports){\n'use strict';\n\nvar _security = require('./modules/security/security.js');\n\nvar _update = require('./modules/update/update.js');\n\nvar _user = require('./modules/user/user.js');\n\nvar _tagContainer = require('./modules/tagContainer/tagContainer.js');\n\nvar _tag = require('./modules/tag/tag.js');\n\nvar _trigger = require('./modules/trigger/trigger.js');\n\nvar _variable = require('./modules/variable/variable.js');\n\nvar _integration = require('./modules/integration/integration.js');\n\nvar _condition = require('./modules/condition/condition.js');\n\nvar _debug = require('./modules/debug/debug.js');\n\nvar _optOut = require('./modules/optOut/optOut.js');\n\nvar _alert = require('./../modules/alert/alert.js');\n\nvar _translation = require('./../modules/translation/translation.js');\n\nvar _form = require('./../modules/form/form.js');\n\nvar _confirm = require('./../modules/confirm/confirm.js');\n\nvar _sanitize = require('./../modules/sanitize/sanitize.js');\n\nvar _clipboard = require('./../modules/clipboard/clipboard.js');\n\nvar _pageInfo = require('./../modules/pageInfo/pageInfo.js');\n\nvar _helpSystem = require('./../modules/helpSystem/helpSystem.js');\n\nvar _validator = require('./../modules/validator/validator.js');\n\nvar _textEditor = require('./../modules/textEditor/textEditor.js');\n\nvar MODULE_NAME = 'admin.application'; /**\n                                        * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                        *\n                                        * This program is free software: you can redistribute it and/or modify it under\n                                        * the terms of the GNU Affero General Public License as published by the Free\n                                        * Software Foundation, either version 3 of the License, or (at your option) any\n                                        * later version.\n                                        *\n                                        * This program is distributed in the hope that it will be useful,\n                                        * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                        * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                        * GNU Affero General Public License for more details.\n                                        *\n                                        * You should have received a copy of the GNU Affero General Public License\n                                        * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                        */\n\nangular.module('admin.application.plugins', [_tag.MODULE_NAME]);\n\nangular.module(MODULE_NAME, ['pascalprecht.translate', 'cgBusy', 'ui.router', 'ui.bootstrap', 'checklist-model', 'http-auth-interceptor', _security.MODULE_NAME, _update.MODULE_NAME, _user.MODULE_NAME, _condition.MODULE_NAME, _trigger.MODULE_NAME, _variable.MODULE_NAME, _integration.MODULE_NAME, _tag.MODULE_NAME, _tagContainer.MODULE_NAME, _optOut.MODULE_NAME, _alert.MODULE_NAME, _translation.MODULE_NAME, _form.MODULE_NAME, _confirm.MODULE_NAME, _sanitize.MODULE_NAME, _clipboard.MODULE_NAME, _pageInfo.MODULE_NAME, _helpSystem.MODULE_NAME, _validator.MODULE_NAME, _debug.MODULE_NAME, _textEditor.MODULE_NAME, 'ngClipboard', 'admin.application.plugins']).run(['$rootScope', '$state', 'clearcode.tm.alert.$alert', 'clearcode.tm.security.security', 'clearcode.tm.security.oauthResource', 'clearcode.tm.security.tokenStorage', 'authService', 'clearcode.tm.variable.$variableForm', function ($rootScope, $state, $alertProvider, security, OAuthResource, tokenStorage, authService, $variableFormProvider) {\n    var removeToken = false;\n\n    $variableFormProvider.addType('dataLayer', {\n        templateUrl: 'app/modules/variable/views/types/dataLayer.html'\n    }).addType('cookie', {\n        templateUrl: 'app/modules/variable/views/types/cookie.html'\n    }).addType('constant', {\n        templateUrl: 'app/modules/variable/views/types/constant.html'\n    }).addType('document', {\n        templateUrl: 'app/modules/variable/views/types/document.html'\n    }).addType('random', {\n        templateUrl: 'app/modules/variable/views/types/random.html'\n    }).addType('url', {\n        templateUrl: 'app/modules/variable/views/types/url.html'\n    }).addType('campaign', {\n        templateUrl: 'app/modules/variable/views/types/campaign.html'\n    });\n\n    $alertProvider.addMessagePattern('error.invalid', 'Form is invalid. Please correct selected fields');\n\n    $alertProvider.addMessagePattern('success.create', 'Settings saved successfully');\n\n    $alertProvider.addMessagePattern('success.edit', 'Settings saved successfully');\n\n    $alertProvider.addMessagePattern('success.remove', 'Deleted successfully');\n\n    $rootScope.$state = $state;\n    $rootScope.animateSidebarReady = false;\n\n    $rootScope.isContainerView = function () {\n        return false;\n    };\n\n    $rootScope.$on('$stateChangeStart', function (event, toState, toStateParams) {\n        $rootScope.isContainerView = function () {\n            var hasContainerList = toState.data.hasContainerList !== undefined ? toState.data.hasContainerList : false,\n                isAuthenticated = security.isAuthenticated();\n\n            if ($rootScope.animateSidebarReady === false && hasContainerList && isAuthenticated) {\n                $rootScope.animateSidebarReady = true;\n            }\n\n            return hasContainerList && isAuthenticated;\n        };\n\n        $rootScope.activeContainerId = toStateParams.containerId;\n    });\n\n    $rootScope.$on('event:auth-loginRequired', function () {\n        var authToken = tokenStorage.getItem();\n\n        if (removeToken || undefined !== authToken) {\n            OAuthResource.refreshToken(authToken.refreshToken).then(function (data) {\n                tokenStorage.addItem(data);\n\n                authService.loginConfirmed('success', function (config) {\n                    config.headers.Authorization = tokenStorage.getToken();\n\n                    return config;\n                });\n            }, function () {\n                tokenStorage.removeItem();\n                authService.loginCancelled('invalid');\n                $state.go('signIn');\n            });\n        }\n        removeToken = !removeToken;\n    });\n}]).config(['$urlRouterProvider', 'ngClipProvider', '$translateProvider', function ($urlRouterProvider, ngClipProvider, $translateProvider) {\n    $urlRouterProvider.otherwise('/containers');\n    ngClipProvider.setPath('ZeroClipboard.swf');\n    $translateProvider.useSanitizeValueStrategy('escape');\n\n    $translateProvider.useStaticFilesLoader({\n        prefix: '/api/translations/',\n        suffix: '.json'\n    });\n\n    $translateProvider.preferredLanguage('en');\n    $translateProvider.useLocalStorage();\n}]).value('cgBusyDefaults', {\n    wrapperClass: 'loading'\n}).value('longDataFormat', 'dd MMMM yyyy').value('defaultDateFormat', 'yyyy-MM-dd HH:mm').filter('reverse', function () {\n    return function (items) {\n        return items.slice().reverse();\n    };\n});\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./../modules/alert/alert.js\":95,\"./../modules/clipboard/clipboard.js\":103,\"./../modules/confirm/confirm.js\":105,\"./../modules/form/form.js\":112,\"./../modules/helpSystem/helpSystem.js\":115,\"./../modules/pageInfo/pageInfo.js\":120,\"./../modules/sanitize/sanitize.js\":124,\"./../modules/textEditor/textEditor.js\":130,\"./../modules/translation/translation.js\":133,\"./../modules/validator/validator.js\":135,\"./modules/condition/condition.js\":3,\"./modules/debug/debug.js\":9,\"./modules/integration/integration.js\":17,\"./modules/optOut/optOut.js\":20,\"./modules/security/security.js\":27,\"./modules/tag/tag.js\":42,\"./modules/tagContainer/tagContainer.js\":56,\"./modules/trigger/trigger.js\":64,\"./modules/update/update.js\":69,\"./modules/user/user.js\":80,\"./modules/variable/variable.js\":94}],3:[function(require,module,exports){\n'use strict';\n\nvar _ConditionResource = require('./resource/ConditionResource.js');\n\nvar _ConditionResource2 = _interopRequireDefault(_ConditionResource);\n\nvar _Condition = require('./services/Condition.js');\n\nvar _Condition2 = _interopRequireDefault(_Condition);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar MODULE_NAME = 'clearcode.tm.condition';\n\n_Condition2.default.$inject = [MODULE_NAME + '.conditionResource', 'clearcode.tm.tagContainer.currentContainer'];\n\n_ConditionResource2.default.$inject = ['$http', '$q'];\n\nangular.module(MODULE_NAME, ['clearcode.tm.tagContainer']).service(MODULE_NAME + '.conditionResource', _ConditionResource2.default).service(MODULE_NAME + '.condition', _Condition2.default);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./resource/ConditionResource.js\":5,\"./services/Condition.js\":6}],4:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar conditionFactory = function conditionFactory() {\n  /**\n   * @name Condition\n   * @description Condition entity\n   */\n  var Condition = function Condition() {\n    _classCallCheck(this, Condition);\n\n    /**\n     * @type {number}\n     */\n    this.id = undefined;\n\n    /**\n     * @type {string}\n     */\n    this.variable = undefined;\n\n    /**\n     * @type {string}\n     */\n    this.condition = undefined;\n\n    /**\n     * @type {string}\n     */\n    this.value = undefined;\n  };\n\n  return Condition;\n};\n\nexports.default = conditionFactory;\n\n},{}],5:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _Condition = require('../entity/Condition.js');\n\nvar _Condition2 = _interopRequireDefault(_Condition);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * @name ConditionResource\n */\nvar ConditionResource = function () {\n    /**\n     * @param  {$http} $http\n     * @param  {$q} $q\n     */\n    function ConditionResource($http, $q) {\n        _classCallCheck(this, ConditionResource);\n\n        this.http = $http;\n        this.q = $q;\n    }\n\n    /**\n     * @returns {Condition}\n     */\n\n\n    _createClass(ConditionResource, [{\n        key: 'getEntityObject',\n        value: function getEntityObject() {\n            var Condition = (0, _Condition2.default)();\n\n            return new Condition();\n        }\n\n        /**\n         * @description Send request to get conditions with their specific variables\n         *\n         * @param {number} id\n         *\n         * @returns {deferred.promise}\n         */\n\n    }, {\n        key: 'query',\n        value: function query(id) {\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: '/api/containers/' + id + '/conditions'\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }]);\n\n    return ConditionResource;\n}();\n\nexports.default = ConditionResource;\n\n},{\"../entity/Condition.js\":4}],6:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * Finding type by type id\n * @param  {Array} array\n * @param  {Number} type\n * @return {Object}\n */\nvar findTypeByType = function findTypeByType(array, type) {\n    var tempType = type;\n\n    return array.filter(function (element) {\n        return element.type === tempType;\n    });\n};\n\nvar currentContainer = void 0;\nvar conditionResource = void 0;\n\nvar Condition = function () {\n    function Condition($conditionResource, $currentContainer) {\n        _classCallCheck(this, Condition);\n\n        currentContainer = $currentContainer;\n        conditionResource = $conditionResource;\n\n        if (currentContainer.getId() !== undefined) {\n            this.conditionResourcePromise = conditionResource.query(currentContainer.getId());\n        }\n    }\n\n    _createClass(Condition, [{\n        key: 'getArrayOfTypes',\n        value: function getArrayOfTypes() {\n            return this.conditionResourcePromise.then(function (resp) {\n                var typesTemp = [],\n                    typesIndex = resp.length;\n\n                while (typesIndex--) {\n                    typesTemp[resp[typesIndex].type] = resp[typesIndex].name;\n                }\n\n                return typesTemp;\n            });\n        }\n    }, {\n        key: 'allVariables',\n        value: function allVariables() {\n            return this.conditionResourcePromise.then(function (resp) {\n                var variables = [];\n                for (var index = 0; index < resp.length; index++) {\n                    variables = variables.length ? mergeVariables(variables, resp[index].variables) : resp[index].variables;\n                }\n\n                return variables;\n            });\n        }\n    }, {\n        key: 'getVariables',\n        value: function getVariables(type) {\n            return this.conditionResourcePromise.then(function (resp) {\n                var responsedTypes = findTypeByType(resp, type);\n\n                if (responsedTypes.length === 1) {\n                    return responsedTypes[0].variables;\n                } else {\n                    return false;\n                }\n            });\n        }\n    }, {\n        key: 'getRequired',\n        value: function getRequired(type) {\n            return this.conditionResourcePromise.then(function (resp) {\n                var responsedTypes = findTypeByType(resp, type);\n\n                if (responsedTypes.length === 1) {\n                    return responsedTypes[0].variables.filter(function (variable) {\n                        return variable.name === 'Event' && responsedTypes[0].name === 'Event';\n                    });\n                } else {\n                    return false;\n                }\n            });\n        }\n    }, {\n        key: 'getActions',\n        value: function getActions(type) {\n            return this.conditionResourcePromise.then(function (resp) {\n                var responsedTypes = findTypeByType(resp, type);\n\n                if (responsedTypes.length === 1) {\n                    return responsedTypes[0].actions;\n                } else {\n                    return false;\n                }\n            });\n        }\n    }, {\n        key: 'refresh',\n        value: function refresh() {\n            this.conditionResourcePromise = conditionResource.query(currentContainer.getId());\n        }\n    }]);\n\n    return Condition;\n}();\n\nfunction mergeVariables(arrayFirst, arraySecond) {\n    var final = [];\n    for (var indexFirst in arrayFirst) {\n        var shared = false;\n        for (var indexSecond in arraySecond) {\n            if (isVariablesNameEqual(arraySecond[indexSecond], arrayFirst[indexFirst])) {\n                shared = true;\n                break;\n            }\n        }\n        if (!shared) {\n            final.push(arrayFirst[indexFirst]);\n        }\n    }\n\n    return final.concat(arraySecond);\n}\n\nfunction isVariablesNameEqual(variableFirst, variableSecond) {\n    return variableFirst.name === variableSecond.name;\n}\n\nexports.default = Condition;\n\n},{}],7:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @type {$state}\n */\nvar state = void 0;\n\n/**\n * @type {$stateParams}\n */\nvar stateParams = void 0;\n\n/**\n * @type {CurrentContainer}\n */\nvar currentContainer = void 0;\n\n/**\n * @type {$scope}\n */\nvar scope = void 0;\n\nvar translate = void 0;\n\n/**\n * @type {String}\n */\nvar BREADCRUMB_TEXT = 'Debug';\n\n/**\n * @name DebugOptionsController\n */\n\nvar DebugOptionsController =\n/**\n * @param {ContainerResource} containerResource\n * @param {$state} $state\n * @param {$stateParams} $stateParams\n * @param {currentContainer} CurrentContainer\n * @param {PageInfo} PageInfo\n * @param {$scope} $scope\n * @param {$translate} $translate\n */\nfunction DebugOptionsController(containerResource, $state, $stateParams, CurrentContainer, PageInfo, $scope, $translate) {\n    var _this = this;\n\n    _classCallCheck(this, DebugOptionsController);\n\n    state = $state;\n    stateParams = $stateParams;\n    currentContainer = CurrentContainer;\n    scope = $scope;\n    translate = $translate;\n\n    this.container = containerResource.getEntityObject();\n\n    this.containerPromise = containerResource.get(stateParams.containerId);\n\n    this.containerPromise.then(function (resp) {\n        _this.container = resp;\n    });\n\n    currentContainer.getContainer().then(function () {\n        if (currentContainer.$container.hasPermission('noaccess')) {\n            state.go('container');\n        }\n\n        translate([BREADCRUMB_TEXT]).then(function (translations) {\n            PageInfo.clear().add(currentContainer.$container.name, 'tags', {\n                containerId: currentContainer.$container.id\n            }).add(translations[BREADCRUMB_TEXT]).broadcast();\n        });\n    });\n\n    scope.$on('pageInfo.reload', function (event, args) {\n        translate([BREADCRUMB_TEXT]).then(function (translations) {\n            PageInfo.clear().add(args.name, 'tags', {\n                containerId: args.id\n            }).add(translations[BREADCRUMB_TEXT]).broadcast();\n        });\n    });\n};\n\nexports.default = DebugOptionsController;\n\n},{}],8:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar state = void 0,\n    stateParams = void 0,\n    alert = void 0,\n    currentContainer = void 0,\n    websitesResource = void 0;\n\n/**\n * @name WebsitesController\n */\n\nvar WebsitesController = function () {\n    function WebsitesController($websitesResource, $state, $stateParams, $alert, $currentContainer, $translate, $scope) {\n        var _this = this;\n\n        _classCallCheck(this, WebsitesController);\n\n        state = $state;\n        stateParams = $stateParams;\n        alert = $alert;\n        currentContainer = $currentContainer;\n        websitesResource = $websitesResource;\n\n        this.websites = [];\n        this.websitesPromise = websitesResource.query(stateParams.containerId);\n\n        this.websitesPromise.then(function (resp) {\n            _this.websites = resp.data;\n        });\n\n        $translate(['by hash', 'by query']).then(function (translations) {\n            _this.parameterTypes = [{\n                value: 0,\n                name: translations['by query']\n            }, {\n                value: 1,\n                name: translations['by hash']\n            }];\n        });\n\n        $scope.getWebsiteUrlWithParameter = function (website) {\n            return website.getUrlWithParameter();\n        };\n    }\n\n    /**\n     * Method to create new container website\n     */\n\n\n    _createClass(WebsitesController, [{\n        key: 'addContainerWebsite',\n        value: function addContainerWebsite() {\n            if (!currentContainer.$container.hasPermission('edit')) {\n                return;\n            }\n\n            if (!this.websites) {\n                this.websites = [];\n            }\n\n            this.websites.push(websitesResource.getEntityObject());\n        }\n\n        /**\n         * Method to remove container websites\n         *\n         * @param {Number} index\n         */\n\n    }, {\n        key: 'removeContainerWebsite',\n        value: function removeContainerWebsite(index) {\n            this.websites.splice(index, 1);\n        }\n\n        /**\n         * Handle form submit action\n         */\n\n    }, {\n        key: 'submitForm',\n        value: function submitForm() {\n            var _this2 = this;\n\n            var websites = [];\n\n            for (var i = 0; this.websites && i < this.websites.length; i++) {\n                var website = websitesResource.getEntityObject();\n\n                website.url = this.websites[i].url;\n                website.parameterType = this.websites[i].parameterType;\n\n                websites.push(website);\n            }\n\n            this.websitePromise = websitesResource.put(stateParams.containerId, websites);\n\n            this.websitePromise.then(function () {\n                currentContainer.get(stateParams.containerId);\n                alert.success('success.edit');\n\n                state.go('debug', { containerId: stateParams.containerId });\n            }, function () {\n                alert.error('error.invalid');\n\n                _this2.validateContainer = true;\n            });\n        }\n    }]);\n\n    return WebsitesController;\n}();\n\nexports.default = WebsitesController;\n\n},{}],9:[function(require,module,exports){\n'use strict';\n\nvar _DebugOptionsController = require('./controllers/DebugOptionsController.js');\n\nvar _DebugOptionsController2 = _interopRequireDefault(_DebugOptionsController);\n\nvar _WebsitesController = require('./controllers/WebsitesController.js');\n\nvar _WebsitesController2 = _interopRequireDefault(_WebsitesController);\n\nvar _WebsiteResource = require('./resource/WebsiteResource.js');\n\nvar _WebsiteResource2 = _interopRequireDefault(_WebsiteResource);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar MODULE_NAME = 'clearcode.tm.debug'; /**\n                                         * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                         *\n                                         * This program is free software: you can redistribute it and/or modify it under\n                                         * the terms of the GNU Affero General Public License as published by the Free\n                                         * Software Foundation, either version 3 of the License, or (at your option) any\n                                         * later version.\n                                         *\n                                         * This program is distributed in the hope that it will be useful,\n                                         * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                         * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                         * GNU Affero General Public License for more details.\n                                         *\n                                         * You should have received a copy of the GNU Affero General Public License\n                                         * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                         */\n\nvar MODULE_CONTAINER = 'clearcode.tm.tagContainer';\nvar MODULE_DIR = 'app/modules/debug';\n\n_WebsiteResource2.default.$inject = ['$http', '$q'];\n\n_WebsitesController2.default.$inject = [MODULE_NAME + '.websiteResource', '$state', '$stateParams', 'clearcode.tm.alert.alert', MODULE_CONTAINER + '.currentContainer', '$translate', '$scope'];\n\n_DebugOptionsController2.default.$inject = [MODULE_CONTAINER + '.containerResource', '$state', '$stateParams', MODULE_CONTAINER + '.currentContainer', 'clearcode.tm.pageInfo.pageInfo', '$scope', '$translate'];\n\nangular.module(MODULE_NAME, ['pascalprecht.translate', 'ui.router', 'ngTable', 'ngCookies', 'clearcode.tm.condition', 'clearcode.tm.alert', 'clearcode.tm.pageInfo', 'clearcode.tm.user']).run(['$rootScope', MODULE_CONTAINER + '.currentContainer', '$stateParams', function ($rootScope, currentContainer, $stateParams) {\n    $rootScope.currentContainerLoading = true;\n    $rootScope.currentContainer = currentContainer;\n\n    var loadContainer = function loadContainer(containerId) {\n        if (containerId !== $stateParams.containerId) {\n            var currentContainerPromise = currentContainer.get(containerId);\n\n            currentContainerPromise.then(function (container) {\n                $rootScope.$broadcast('pageInfo.reload', container);\n            });\n        }\n    };\n\n    $rootScope.$on('$stateChangeStart', function (event, toState, toParams) {\n        loadContainer(toParams.containerId);\n    });\n}]).config(['$stateProvider', function ($stateProvider) {\n    $stateProvider.state('debug', {\n        url: '/containers/{containerId}/debug',\n        controller: MODULE_NAME + '.DebugOptionsController as view',\n        templateUrl: MODULE_DIR + '/views/options.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: true,\n            permission: ['view']\n        }\n    });\n}]).controller(MODULE_NAME + '.DebugOptionsController', _DebugOptionsController2.default).controller(MODULE_NAME + '.WebsitesController', _WebsitesController2.default).service(MODULE_NAME + '.websiteResource', _WebsiteResource2.default);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./controllers/DebugOptionsController.js\":7,\"./controllers/WebsitesController.js\":8,\"./resource/WebsiteResource.js\":11}],10:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar websiteFactory = function websiteFactory() {\n    var DEBUG_PARAM_NAME = '_stg_debug';\n    var URL_MIN_LENGTH = 10;\n\n    /**\n     * @name Website\n     * @description Website entity\n     */\n\n    var Website = function () {\n        function Website() {\n            _classCallCheck(this, Website);\n\n            /**\n             * @type {string}\n             */\n            this.url = '';\n\n            /**\n             * @type {Integer}\n             */\n            this.parameterType = 0;\n        }\n\n        /**\n         * @returns {string}\n         */\n\n\n        _createClass(Website, [{\n            key: 'getUrlWithParameter',\n            value: function getUrlWithParameter() {\n                if (this.hasUrl() === false) {\n                    return '';\n                }\n\n                return this.url + this.getSeparator() + DEBUG_PARAM_NAME;\n            }\n\n            /**\n             * @returns {string}\n             */\n\n        }, {\n            key: 'getSeparator',\n            value: function getSeparator() {\n                var separator = this.parameterType === 1 ? '#' : '?';\n\n                if (this.hasUrl() === false) {\n                    return separator;\n                }\n\n                return this.url.indexOf(separator) === -1 ? separator : '&';\n            }\n        }, {\n            key: 'hasUrl',\n            value: function hasUrl() {\n                return this.url !== undefined && this.url.length > URL_MIN_LENGTH;\n            }\n        }]);\n\n        return Website;\n    }();\n\n    return Website;\n};\n\nexports.default = websiteFactory;\n\n},{}],11:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _Website = require('../entity/Website.js');\n\nvar _Website2 = _interopRequireDefault(_Website);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar transformResponse = function transformResponse(resp) {\n    var _this = this;\n\n    if (angular.isArray(resp)) {\n        return resp.map(function (websiteData) {\n            return transformResponse.call(_this, websiteData);\n        });\n    }\n\n    var website = this.getEntityObject();\n\n    if (resp !== undefined) {\n        website.url = resp.url;\n        website.parameterType = resp.parameter_type;\n    }\n\n    return website;\n};\n\nvar appendTransform = function appendTransform(defaults, transform) {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name WebsiteResource\n *\n */\n\nvar WebsiteResource = function () {\n    /**\n     * @param {$http} $http\n     * @param {$q} $q\n     */\n    function WebsiteResource($http, $q) {\n        _classCallCheck(this, WebsiteResource);\n\n        this.http = $http;\n        this.q = $q;\n    }\n\n    /**\n     * @returns {Website}\n     */\n\n\n    _createClass(WebsiteResource, [{\n        key: 'getEntityObject',\n        value: function getEntityObject() {\n            var Website = (0, _Website2.default)(this);\n\n            return new Website();\n        }\n\n        /**\n         * @description Send request to get list of entity\n         *\n         * @param {number} containerId\n         * @param {Object} params\n         *\n         * @returns {deferred.promise}\n         */\n\n    }, {\n        key: 'query',\n        value: function query(containerId, params) {\n            var _this2 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: '/api/containers/' + containerId + '/websites',\n                params: params,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (isResponseSuccess(resp, status)) {\n                        for (var i = 0; i < resp.data.length; i++) {\n                            if (resp.data[i] instanceof Object) {\n                                resp.data[i] = transformResponse.call(_this2, resp.data[i]);\n                            }\n                        }\n                    }\n\n                    return resp;\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'put',\n        value: function put(containerId, websites) {\n            var _this3 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'PUT',\n                data: {\n                    websites: websites\n                },\n                url: 'api/containers/' + containerId + '/websites',\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (isResponseSuccess(resp, status)) {\n                        return transformResponse.call(_this3, resp.data);\n                    }\n\n                    return resp;\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }]);\n\n    return WebsiteResource;\n}();\n\nfunction isResponseSuccess(resp, status) {\n    return status < 400 && resp.data !== undefined;\n}\n\nexports.default = WebsiteResource;\n\n},{\"../entity/Website.js\":10}],12:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name BaseController\n */\nvar BaseController = function () {\n    /**\n     * @param {IntegrationResource} $Integration\n     * @param {PageInfo} $PageInfo\n     * @param {$stateParams} $stateParams\n     * @param {Alert} $alert\n     * @param {$state} $state\n     * @param {$translate} $translate\n     */\n    function BaseController($Integration, $PageInfo, $stateParams, $alert, $state, $translate) {\n        var _this = this;\n\n        _classCallCheck(this, BaseController);\n\n        var BREADCRUMB_TEXT = 'Integrations';\n\n        this.integration = $Integration.getEntityObject();\n        this.stateParams = $stateParams;\n        this.alert = $alert;\n        this.state = $state;\n\n        this.formTouched = false;\n\n        $translate([BREADCRUMB_TEXT, this.getBreadcrumbText()]).then(function (translations) {\n            $PageInfo.clear().add(translations[BREADCRUMB_TEXT], 'integration').add(translations[_this.getBreadcrumbText()]).broadcast();\n        });\n    }\n\n    /**\n     * Handle form submit action\n     *\n     * @param {Integration} Integration\n     */\n\n\n    _createClass(BaseController, [{\n        key: 'submitForm',\n        value: function submitForm(Integration) {\n            var _this2 = this;\n\n            this.integrationPromise = Integration.save(this.stateParams.id);\n\n            this.integrationPromise.then(function (resp) {\n                _this2.alert.success(_this2.getAlertType());\n\n                if (_this2.state.includes('integrationCreate')) {\n                    _this2.state.go('integrationEdit', {\n                        integrationId: resp.id\n                    });\n                } else {\n                    _this2.state.go('integration');\n                }\n            }, function () {\n                _this2.alert.error('error.invalid');\n            });\n        }\n\n        /**\n         * Display error if form is invalid\n         */\n\n    }, {\n        key: 'displayInvalidFormMessage',\n        value: function displayInvalidFormMessage() {\n            this.validateIntegration = true;\n            this.alert.error('error.invalid');\n        }\n    }]);\n\n    return BaseController;\n}();\n\nexports.default = BaseController;\n\n},{}],13:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _BaseController2 = require('./BaseController.js');\n\nvar _BaseController3 = _interopRequireDefault(_BaseController2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n/**\n * @name CreateController\n */\nvar CreateController = function (_BaseController) {\n    _inherits(CreateController, _BaseController);\n\n    function CreateController($IntegrationResource, $PageInfo, $stateParams, $alert, $state, $translate) {\n        _classCallCheck(this, CreateController);\n\n        var _this = _possibleConstructorReturn(this, (CreateController.__proto__ || Object.getPrototypeOf(CreateController)).call(this, $IntegrationResource, $PageInfo, $stateParams, $alert, $state, $translate));\n\n        _this.integration = $IntegrationResource.getEntityObject();\n        return _this;\n    }\n\n    _createClass(CreateController, [{\n        key: 'getBreadcrumbText',\n        value: function getBreadcrumbText() {\n            return 'Add a new integration';\n        }\n    }, {\n        key: 'getAlertType',\n        value: function getAlertType() {\n            return 'success.create';\n        }\n    }]);\n\n    return CreateController;\n}(_BaseController3.default);\n\nexports.default = CreateController;\n\n},{\"./BaseController.js\":12}],14:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _BaseController2 = require('./BaseController.js');\n\nvar _BaseController3 = _interopRequireDefault(_BaseController2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n/**\n * @name EditController\n */\nvar EditController = function (_BaseController) {\n    _inherits(EditController, _BaseController);\n\n    /**\n     * @param {IntegrationResource} $IntegrationResource\n     * @param {PageInfo} $PageInfo\n     * @param {$stateParams} $stateParams\n     * @param {Alert} $alert\n     * @param {$state} $state\n     * @param {$translate} $translate\n     */\n    function EditController($IntegrationResource, $PageInfo, $stateParams, $alert, $state, $translate) {\n        _classCallCheck(this, EditController);\n\n        var _this = _possibleConstructorReturn(this, (EditController.__proto__ || Object.getPrototypeOf(EditController)).call(this, $IntegrationResource, $PageInfo, $stateParams, $alert, $state, $translate));\n\n        _this.integrationPromise = $IntegrationResource.get($stateParams.integrationId);\n        _this.integrationPromise.then(function (resp) {\n            _this.integration = resp;\n        });\n        _this.formTouched = true;\n        return _this;\n    }\n\n    _createClass(EditController, [{\n        key: 'getBreadcrumbText',\n        value: function getBreadcrumbText() {\n            return 'Edit integration';\n        }\n    }, {\n        key: 'getAlertType',\n        value: function getAlertType() {\n            return 'success.edit';\n        }\n    }]);\n\n    return EditController;\n}(_BaseController3.default);\n\nexports.default = EditController;\n\n},{\"./BaseController.js\":12}],15:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar $alert = void 0;\n\nvar BREADCRUMB_TEXT = 'Integrations';\n\n/**\n * @name ManageController\n */\n\nvar ManageController = function () {\n    function ManageController(TableParams, Integration, alert, paramConverter, PageInfo, $translate) {\n        _classCallCheck(this, ManageController);\n\n        $alert = alert;\n\n        this.permissions = [];\n        this.tableParams = new TableParams({\n            page: 1,\n            count: 10,\n            sorting: {\n                name: 'asc'\n            }\n        }, {\n            total: 0,\n            getData: function getData($defer, params) {\n                Integration.query(paramConverter.list(params.url())).then(function (resp) {\n                    params.total(resp.total);\n                    $defer.resolve(resp.data);\n                });\n            }\n        });\n\n        $translate([BREADCRUMB_TEXT]).then(function (translations) {\n            PageInfo.clear().add(translations[BREADCRUMB_TEXT]).broadcast();\n        });\n    }\n\n    _createClass(ManageController, [{\n        key: 'removeIntegration',\n        value: function removeIntegration(Integration) {\n            var _this = this;\n\n            Integration.remove().then(function () {\n                $alert.success('success.remove');\n                if (_this.tableParams.data.length === 1 && _this.tableParams.page() > 1) {\n                    _this.tableParams.page(_this.tableParams.page() - 1);\n                } else {\n                    _this.tableParams.reload();\n                }\n            }, function () {\n                $alert.error('error.remove');\n                _this.tableParams.reload();\n            });\n        }\n    }]);\n\n    return ManageController;\n}();\n\nexports.default = ManageController;\n\n},{}],16:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar integrationFactory = function integrationFactory(resource) {\n    /**\n     * @name Integration\n     * @description Integration entity\n     */\n    var Integration = function () {\n        function Integration() {\n            _classCallCheck(this, Integration);\n\n            /**\n             * @type {number}\n             */\n            this.id = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.name = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.clientId = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.clientSecret = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.createdAt = undefined;\n            /**\n             * @type {string}\n             */\n            this.updatedAt = undefined;\n            /**\n             * @type {Object}\n             */\n            this.user = undefined;\n        }\n\n        /**\n         * @returns {deferred.promise}\n         */\n\n\n        _createClass(Integration, [{\n            key: 'save',\n            value: function save() {\n                var result = {},\n                    promise;\n\n                var excludedProperty = ['id', 'updatedAt', 'createdAt', 'clientId', 'clientSecret', 'user'];\n\n                for (var property in this) {\n                    if (!angular.isFunction(this[property]) && this.hasOwnProperty(property) && excludedProperty.indexOf(property) === -1) {\n                        if (property === 'type') {\n                            result[property] = this[property].id;\n                        } else {\n                            result[property] = this[property];\n                        }\n                    }\n                }\n\n                if (this.id === undefined) {\n                    if (this.user.email) {\n                        result.user = {};\n                        result.user.email = this.user.email;\n                    }\n\n                    promise = resource.post(result);\n                } else {\n                    promise = resource.put(this.id, result);\n                }\n\n                return promise;\n            }\n\n            /**\n             * @returns {deferred.promise|Boolean}\n             */\n\n        }, {\n            key: 'remove',\n            value: function remove() {\n                if (this.id === undefined) {\n                    return false;\n                }\n\n                return resource.delete(this.id);\n            }\n        }]);\n\n        return Integration;\n    }();\n\n    return Integration;\n};\n\nexports.default = integrationFactory;\n\n},{}],17:[function(require,module,exports){\n'use strict';\n\nvar _ManageController = require('./controllers/ManageController.js');\n\nvar _ManageController2 = _interopRequireDefault(_ManageController);\n\nvar _CreateController = require('./controllers/CreateController.js');\n\nvar _CreateController2 = _interopRequireDefault(_CreateController);\n\nvar _EditController = require('./controllers/EditController.js');\n\nvar _EditController2 = _interopRequireDefault(_EditController);\n\nvar _IntegrationResource = require('./resource/IntegrationResource.js');\n\nvar _IntegrationResource2 = _interopRequireDefault(_IntegrationResource);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar MODULE_NAME = 'clearcode.tm.integration';\nvar MODULE_DIR = 'app/modules/integration';\n\n_ManageController2.default.$inject = ['ngTableParams', MODULE_NAME + '.IntegrationResource', 'clearcode.tm.alert.alert', 'clearcode.tm.tagContainer.paramConverter', 'clearcode.tm.pageInfo.pageInfo', '$translate'];\n\n_CreateController2.default.$inject = [MODULE_NAME + '.IntegrationResource', 'clearcode.tm.pageInfo.pageInfo', '$stateParams', 'clearcode.tm.alert.alert', '$state', '$translate'];\n\n_EditController2.default.$inject = [MODULE_NAME + '.IntegrationResource', 'clearcode.tm.pageInfo.pageInfo', '$stateParams', 'clearcode.tm.alert.alert', '$state', '$translate'];\n\n_IntegrationResource2.default.$inject = ['$http', '$q'];\n\nangular.module(MODULE_NAME, ['pascalprecht.translate', 'ui.router', 'ngTable', 'clearcode.tm.alert', 'clearcode.tm.pageInfo', 'clearcode.tm.tagContainer']).config(['$stateProvider', function ($stateProvider) {\n    $stateProvider.state('integration', {\n        url: '/integration',\n        controller: MODULE_NAME + '.ManageController as view',\n        templateUrl: MODULE_DIR + '/views/manage.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: false\n        }\n    }).state('integrationCreate', {\n        url: '/integration/create',\n        controller: MODULE_NAME + '.CreateController as view',\n        templateUrl: MODULE_DIR + '/views/create.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: false\n        }\n    }).state('integrationEdit', {\n        url: '/integration/{integrationId}/edit',\n        controller: MODULE_NAME + '.EditController as view',\n        templateUrl: MODULE_DIR + '/views/edit.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: false\n        }\n    });\n}]).run(['clearcode.tm.alert.$alert', function ($alertProvider) {\n    $alertProvider.addMessagePattern('integration.close', 'You are trying to close unsaved OAuth client.');\n}]).controller(MODULE_NAME + '.ManageController', _ManageController2.default).controller(MODULE_NAME + '.CreateController', _CreateController2.default).controller(MODULE_NAME + '.EditController', _EditController2.default).service(MODULE_NAME + '.IntegrationResource', _IntegrationResource2.default);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./controllers/CreateController.js\":13,\"./controllers/EditController.js\":14,\"./controllers/ManageController.js\":15,\"./resource/IntegrationResource.js\":18}],18:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _Integration = require('../entity/Integration.js');\n\nvar _Integration2 = _interopRequireDefault(_Integration);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar transformResponse = function transformResponse(resp) {\n    var Integration = (0, _Integration2.default)(this);\n    var integration = new Integration();\n\n    integration.id = resp.id;\n    integration.name = resp.name;\n    integration.clientId = resp.client_id;\n    integration.clientSecret = resp.client_secret;\n    integration.createdAt = resp.created_at;\n    integration.updatedAt = resp.updated_at;\n\n    integration.user = {\n        id: undefined,\n        status: undefined,\n        roles: [],\n        email: undefined\n    };\n\n    if (resp.user) {\n        integration.user.id = resp.user.id;\n        integration.user.status = resp.user.status;\n        integration.user.roles = resp.user.roles;\n\n        if (resp.user.email) {\n            integration.user.email = resp.user.email;\n        }\n    }\n\n    return integration;\n};\n\nvar appendTransform = function appendTransform(defaults, transform) {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name IntegrationResource\n */\n\nvar IntegrationResource = function () {\n    /**\n     * @param {$http} $http\n     * @param {$q} $q\n     */\n    function IntegrationResource($http, $q) {\n        _classCallCheck(this, IntegrationResource);\n\n        this.http = $http;\n        this.q = $q;\n    }\n\n    /**\n     * @returns {Integration}\n     */\n\n\n    _createClass(IntegrationResource, [{\n        key: 'getEntityObject',\n        value: function getEntityObject() {\n            var Integration = (0, _Integration2.default)(this);\n\n            return new Integration();\n        }\n\n        /**\n         * @description Send request to get specific entity\n         *\n         * @param {number} id\n         *\n         * @returns {deferred.promise}\n         */\n\n    }, {\n        key: 'get',\n        value: function get(id) {\n            var _this = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: '/api/integration/' + id,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (status < 400) {\n                        return transformResponse.call(_this, resp.data);\n                    } else {\n                        return resp;\n                    }\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n\n        /**\n         * @description Send request to get list of entity\n         *\n         * @param {Object} params\n         *\n         * @returns {deferred.promise}\n         */\n\n    }, {\n        key: 'query',\n        value: function query(params) {\n            var _this2 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: '/api/integration',\n                params: params,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp) {\n                    for (var element in resp.data) {\n                        if (resp.data[element] instanceof Object) {\n                            resp.data[element] = transformResponse.call(_this2, resp.data[element]);\n                        }\n                    }\n\n                    return resp;\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n\n        /**\n         * @description Send request to delete entity\n         *\n         * @param {number} id\n         *\n         * @returns {deferred.promise}\n         */\n\n    }, {\n        key: 'delete',\n        value: function _delete(id) {\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'DELETE',\n                url: '/api/integration/' + id\n            }).success(function (data) {\n                deferred.resolve(data);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n\n        /**\n         * @description Send request to create entity\n         *\n         * @param {object} entity\n         *\n         * @returns {deferred.promise}\n         */\n\n    }, {\n        key: 'post',\n        value: function post(entity) {\n            var _this3 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'POST',\n                url: '/api/integration',\n                data: entity,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (status < 400) {\n                        return transformResponse.call(_this3, resp.data);\n                    } else {\n                        return resp;\n                    }\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n\n        /**\n         * Send request to update entity\n         *\n         * @param {number} id\n         * @param {object} entity\n         *\n         * @returns {deferred.promise}\n         */\n\n    }, {\n        key: 'put',\n        value: function put(id, entity) {\n            var _this4 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'PUT',\n                url: '/api/integration/' + id,\n                data: entity,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (status < 400) {\n                        return transformResponse.call(_this4, resp.data);\n                    } else {\n                        return resp;\n                    }\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }]);\n\n    return IntegrationResource;\n}();\n\nexports.default = IntegrationResource;\n\n},{\"../entity/Integration.js\":16}],19:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar PageInfo = void 0,\n    translate = void 0,\n    snippet = void 0;\n\nvar BREADCRUMB_TEXT = 'Opt-out generator',\n    defaultOptOutMessage = 'You can choose to opt out of being tracked by all marketing and advertising tools installed on this website. \\nTo make that choice, please click below to receive an opt-out cookie.',\n    defaultOptIn = 'You are currently opted in. Click here to opt out.',\n    defaultOptOut = 'You are currently opted out. Click here to opt in.';\n\n/**\n * @name GeneratorController\n */\n\nvar GeneratorController = function () {\n    /*\n     * @param {PageInfo} $PageInfo\n     * @param {Snippet} $snippet\n     * @param {$scope} scope\n     * @param {$translate} $translate\n     */\n    function GeneratorController($PageInfo, $snippet, scope, $translate) {\n        var _this = this;\n\n        _classCallCheck(this, GeneratorController);\n\n        PageInfo = $PageInfo;\n        translate = $translate;\n        snippet = $snippet;\n\n        this.options = [{\n            name: 'domain',\n            value: 0\n        }, {\n            name: 'global',\n            value: 1\n        }];\n\n        this.option = 0;\n        this.optOutMessage = defaultOptOutMessage;\n        this.optInOption = defaultOptIn;\n        this.optOutOption = defaultOptOut;\n\n        scope.$watch('view.option', function () {\n            _this.generateSnippet();\n        });\n\n        this.setPageInfo();\n\n        this.generateSnippet();\n    }\n\n    _createClass(GeneratorController, [{\n        key: 'setPageInfo',\n        value: function setPageInfo() {\n            translate([BREADCRUMB_TEXT]).then(function (translations) {\n                PageInfo.clear().add(translations[BREADCRUMB_TEXT]).broadcast();\n            });\n        }\n    }, {\n        key: 'generateSnippet',\n        value: function generateSnippet() {\n            this.snippet = snippet.buildSnippet(this.option, this.optInOption, this.optOutOption, this.optOutMessage.replace(/\\n/g, '<br>'));\n        }\n    }]);\n\n    return GeneratorController;\n}();\n\nexports.default = GeneratorController;\n\n},{}],20:[function(require,module,exports){\n'use strict';\n\nvar _GeneratorController = require('./controllers/GeneratorController.js');\n\nvar _GeneratorController2 = _interopRequireDefault(_GeneratorController);\n\nvar _Snippet = require('./services/Snippet.js');\n\nvar _Snippet2 = _interopRequireDefault(_Snippet);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar MODULE_NAME = 'clearcode.tm.optOut';\nvar MODULE_DIR = 'app/modules/optOut';\n\n_GeneratorController2.default.$inject = ['clearcode.tm.pageInfo.pageInfo', MODULE_NAME + '.snippet', '$scope', '$translate'];\n\nangular.module(MODULE_NAME, ['pascalprecht.translate', 'ui.router', 'clearcode.tm.alert', 'clearcode.tm.pageInfo', 'clearcode.tm.form', 'clearcode.tm.security']).config(['$stateProvider', function ($stateProvider) {\n    $stateProvider.state('optOutGenerator', {\n        url: '/opt-out',\n        controller: MODULE_NAME + '.GeneratorController as view',\n        templateUrl: MODULE_DIR + '/views/generator.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: false\n        }\n    });\n}]).controller(MODULE_NAME + '.GeneratorController', _GeneratorController2.default).service(MODULE_NAME + '.snippet', _Snippet2.default);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./controllers/GeneratorController.js\":19,\"./services/Snippet.js\":21}],21:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar optOutOpeningComment = '<!-- Start 7Tag privacy opt-out code -->',\n    optOutClosingComment = '<!-- End 7Tag privacy opt-out code -->',\n    hostname = window.location.hostname;\n\nvar Snippet = function () {\n    function Snippet() {\n        _classCallCheck(this, Snippet);\n    }\n\n    _createClass(Snippet, [{\n        key: 'buildSnippet',\n        value: function buildSnippet(option, optInMessage, optOutMessage, message) {\n            var snippet = optOutOpeningComment + this.buildVariablesInitialization(optInMessage, optOutMessage, option) + this.buildExternalScript() + this.buildMainMessage(message) + optOutClosingComment;\n\n            return snippet;\n        }\n    }, {\n        key: 'buildVariablesInitialization',\n        value: function buildVariablesInitialization(optInMessage, optOutMessage, option) {\n            return '<script>window.sevenTag = window.sevenTag || {};' + ('window.sevenTag.optedOutCheckboxText=\"' + optOutMessage + '\";') + ('window.sevenTag.optedInCheckboxText=\"' + optInMessage + '\";') + ('window.sevenTag.isGlobal=' + !!option + ';') + ('window.sevenTag.instanceHostname=\"' + hostname + '\";</script>');\n        }\n    }, {\n        key: 'buildExternalScript',\n        value: function buildExternalScript() {\n            return '<script src=\"//' + hostname + '/containers/privacy/script.v2.js\"></script>';\n        }\n    }, {\n        key: 'buildMainMessage',\n        value: function buildMainMessage(message) {\n            return '<div id=\"_stg_opt_out_iframe_content\" style=\"display: none;\">' + ('<p>' + message + '</p>') + '<input id=\"_stg_optout_checkbox\" onclick=\"window.parent.storeUserOptOutPreferences();\" type=\"checkbox\">' + '<label id=\"_stg_optout_checkbox_label\" for=\"_stg_optout_checkbox\"></label>' + '</div>';\n        }\n    }]);\n\n    return Snippet;\n}();\n\nexports.default = Snippet;\n\n},{}],22:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar $oauthResource = void 0;\nvar $tokenStorage = void 0;\nvar state = void 0;\nvar $alertForm = void 0;\n\nvar BREADCRUMB_TEXT = 'Welcome to Impono';\n\n/**\n * @name security#LoginController\n * @description Controller for login view\n */\n\nvar LoginController = function () {\n    /**\n     * @param {OAuthResource} oauthResource\n     * @param {TokenStorage} tokenStorage\n     * @param {$state} $state\n     * @param {AlertForm} alertForm\n     * @param {PageInfo} PageInfo\n     *\n     */\n    function LoginController(oauthResource, tokenStorage, $state, alertForm, PageInfo) {\n        _classCallCheck(this, LoginController);\n\n        this.auth = {\n            identity: '',\n            password: ''\n        };\n        this.loginPromise = undefined;\n\n        $oauthResource = oauthResource;\n        $tokenStorage = tokenStorage;\n        state = $state;\n        $alertForm = alertForm;\n\n        $alertForm.getStorage().clean();\n\n        PageInfo.clear().add(BREADCRUMB_TEXT).broadcast();\n    }\n\n    _createClass(LoginController, [{\n        key: 'submitForm',\n        value: function submitForm(auth) {\n            var _this = this;\n\n            this.loading = true;\n            this.loginPromise = $oauthResource.post(auth.identity, auth.password);\n\n            this.loginPromise.then(function (resp) {\n                $alertForm.getStorage().clean();\n                $tokenStorage.addItem(resp);\n                state.go('container');\n            }, function () {\n                _this.loading = false;\n            });\n        }\n    }, {\n        key: 'displayInvalidLoginMessage',\n        value: function displayInvalidLoginMessage() {\n            $alertForm.error('login.invalid');\n        }\n    }]);\n\n    return LoginController;\n}();\n\nexports.default = LoginController;\n\n},{}],23:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar deleteRequestInterceptor = function deleteRequestInterceptor($q, $rootScope, $injector) {\n    var METHOD_DELETE = 'DELETE';\n    var POST_DELETE_URL_SUFIX = '/remove';\n\n    return {\n        request: function request(config) {\n            if (config.method.toUpperCase() === METHOD_DELETE && $rootScope.deleteHeaderNotSupported === true) {\n                config.method = 'POST';\n                config.url += POST_DELETE_URL_SUFIX;\n            }\n\n            return config;\n        },\n        responseError: function responseError(rejection) {\n            var $http = $injector.get('$http');\n            if (rejection.config.method.toUpperCase() === METHOD_DELETE) {\n                if (rejection.status === 405) {\n                    $rootScope.deleteHeaderNotSupported = true;\n\n                    return $http.post(rejection.config.url + POST_DELETE_URL_SUFIX);\n                }\n            }\n\n            return $q.reject(rejection);\n        }\n    };\n};\n\nexports.default = deleteRequestInterceptor;\n\n},{}],24:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar DEFAULT_LANGUAGE = 'en';\n\nvar localeInterceptor = function localeInterceptor($window) {\n    return {\n        request: function request(config) {\n            var localStorageLang = $window.localStorage['NG_TRANSLATE_LANG_KEY'];\n\n            if (!/^https?:\\/\\//i.test(config.url)) {\n                config.headers.Locale = localStorageLang ? localStorageLang : DEFAULT_LANGUAGE;\n            }\n\n            return config;\n        }\n    };\n};\n\nexports.default = localeInterceptor;\n\n},{}],25:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar securityInterceptor = function securityInterceptor($q, tokenStorage, $injector) {\n    return {\n        request: function request(config) {\n            if (undefined !== tokenStorage.getItem() && /(.js|.html|.css|.json)$/.test(config.url) === false) {\n                config.headers.Authorization = tokenStorage.getToken();\n            }\n\n            return config;\n        },\n\n        responseError: function responseError(rejection) {\n            // TODO: change this to state ( problem with dependency injection )\n            var $state = $injector.get('$state');\n            if (rejection.status === 400) {\n                if (rejection.data && (rejection.data.error === 'invalid_request' || rejection.data.error === 'invalid_grant')) {\n                    tokenStorage.removeItem();\n                    $state.go('signIn');\n                }\n            }\n\n            if (rejection.status === 403) {\n                $state.go('accessDenied');\n            }\n\n            return $q.reject(rejection);\n        }\n    };\n};\n\nexports.default = securityInterceptor;\n\n},{}],26:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _AuthToken = require('../token/AuthToken.js');\n\nvar _AuthToken2 = _interopRequireDefault(_AuthToken);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar RESOURCE_ROUTE = '/api/oauth/v2/token';\nvar LOGOUT_ROUTE = '/api/users/me/logout';\nvar GRANT_TYPE = 'password';\n\nvar transformResponse = function transformResponse(resp, header, status) {\n    var response = void 0;\n\n    if (status < 400) {\n        var authToken = this.getEntity();\n\n        authToken.accessToken = resp.access_token;\n        authToken.expiresIn = resp.expires_in;\n        authToken.tokenType = resp.token_type;\n        authToken.scope = resp.scope;\n        authToken.refreshToken = resp.refresh_token;\n\n        response = authToken;\n    } else {\n        response = resp;\n    }\n\n    return response;\n};\n\nvar appendTransform = function appendTransform(defaults, transform) {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name OAuthResource\n */\n\nvar OAuthResource = function () {\n    function OAuthResource($http, $q, tokenStorage, OAuthClientSettings) {\n        _classCallCheck(this, OAuthResource);\n\n        this.http = $http;\n        this.q = $q;\n        this.tokenStorage = tokenStorage;\n        this.OAuthClientSettings = OAuthClientSettings;\n    }\n\n    /**\n     * @returns {AuthToken}\n     */\n\n\n    _createClass(OAuthResource, [{\n        key: 'getEntity',\n        value: function getEntity() {\n            var _this = this;\n\n            _AuthToken2.default.prototype.save = function () {\n                var deferred = _this.q.defer();\n\n                _this.tokenStorage.add(_this);\n                deferred.resolve(_this);\n\n                return deferred.promise;\n            };\n\n            _AuthToken2.default.prototype.remove = function () {\n                var deferred = _this.q.defer();\n\n                _this.tokenStorage.remove();\n                deferred.resolve(_this);\n\n                return deferred.promise;\n            };\n\n            return new _AuthToken2.default();\n        }\n\n        /**\n         * @description Send request to get oauth\n         *\n         * @param {string} identity of user ( email or username )\n         * @param {string} password\n         *\n         * @returns {deferred.promise}\n         */\n\n    }, {\n        key: 'post',\n        value: function post(identity, password) {\n            var _this2 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'POST',\n                url: RESOURCE_ROUTE,\n                data: {\n                    /* eslint-disable */\n                    client_id: this.OAuthClientSettings.clientId,\n                    client_secret: this.OAuthClientSettings.clientSecret,\n                    grant_type: GRANT_TYPE,\n                    username: identity,\n                    password: password\n                    /* eslint-enable */\n                },\n                ignoreAuthModule: true,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    return transformResponse.call(_this2, resp, header, status);\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n\n        /**\n         * @description Send request to get new tokens\n         *\n         * @param {string} token\n         *\n         * @returns {deferred.promise}\n         */\n\n    }, {\n        key: 'refreshToken',\n        value: function refreshToken(token) {\n            var _this3 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'POST',\n                url: RESOURCE_ROUTE,\n                data: {\n                    /* eslint-disable */\n                    client_id: this.OAuthClientSettings.clientId,\n                    client_secret: this.OAuthClientSettings.clientSecret,\n                    grant_type: 'refresh_token',\n                    refresh_token: token\n                    /* eslint-enable */\n                },\n                ignoreAuthModule: true,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (resp.error !== undefined) {\n                        return resp;\n                    }\n\n                    return transformResponse.call(_this3, resp, header, status);\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n\n        /**\n         * @description Send request to logout\n         *\n         * @returns {Promise}\n         */\n\n    }, {\n        key: 'logout',\n        value: function logout() {\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: LOGOUT_ROUTE\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }]);\n\n    return OAuthResource;\n}();\n\nexports.default = OAuthResource;\n\n},{\"../token/AuthToken.js\":31}],27:[function(require,module,exports){\n'use strict';\n\nvar _LoginController = require('./controller/LoginController.js');\n\nvar _LoginController2 = _interopRequireDefault(_LoginController);\n\nvar _Authorization = require('./service/Authorization.js');\n\nvar _Authorization2 = _interopRequireDefault(_Authorization);\n\nvar _Security = require('./service/Security.js');\n\nvar _Security2 = _interopRequireDefault(_Security);\n\nvar _OAuthResource = require('./resource/OAuthResource.js');\n\nvar _OAuthResource2 = _interopRequireDefault(_OAuthResource);\n\nvar _TokenStorage = require('./service/TokenStorage.js');\n\nvar _TokenStorage2 = _interopRequireDefault(_TokenStorage);\n\nvar _SecurityInterceptor = require('./interceptor/SecurityInterceptor.js');\n\nvar _SecurityInterceptor2 = _interopRequireDefault(_SecurityInterceptor);\n\nvar _LocaleInterceptor = require('./interceptor/LocaleInterceptor.js');\n\nvar _LocaleInterceptor2 = _interopRequireDefault(_LocaleInterceptor);\n\nvar _DeleteRequestInterceptor = require('./interceptor/DeleteRequestInterceptor.js');\n\nvar _DeleteRequestInterceptor2 = _interopRequireDefault(_DeleteRequestInterceptor);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar MODULE_NAME = 'clearcode.tm.security';\n\n_Authorization2.default.$inject = [MODULE_NAME + '.security', '$state'];\n\n_Security2.default.$inject = ['$q', '$timeout', MODULE_NAME + '.tokenStorage', 'clearcode.tm.user.userResource', MODULE_NAME + '.oauthResource', '$translate'];\n\n_OAuthResource2.default.$inject = ['$http', '$q', MODULE_NAME + '.tokenStorage', 'OAuthClientSettings'];\n\n_LoginController2.default.$inject = [MODULE_NAME + '.oauthResource', MODULE_NAME + '.tokenStorage', '$state', 'clearcode.tm.form.alertForm', 'clearcode.tm.pageInfo.pageInfo'];\n\n_SecurityInterceptor2.default.$inject = ['$q', MODULE_NAME + '.tokenStorage', '$injector'];\n\n_TokenStorage2.default.$inject = ['$localStorage'];\n\n_LocaleInterceptor2.default.$inject = ['$window'];\n\n_DeleteRequestInterceptor2.default.$inject = ['$q', '$rootScope', '$injector'];\n\nangular.module(MODULE_NAME, ['pascalprecht.translate', 'ui.router', 'clearcode.tm.alert', 'clearcode.tm.tagContainer', 'clearcode.tm.user', 'clearcode.tm.pageInfo', 'clearcode.tm.form', 'clearcode.tm.update']).config(['$stateProvider', '$httpProvider', function ($stateProvider, $httpProvider) {\n    $httpProvider.interceptors.push(MODULE_NAME + '.securityInterceptor');\n    $httpProvider.interceptors.push(MODULE_NAME + '.deleteRequestInterceptor');\n    $httpProvider.interceptors.push(MODULE_NAME + '.localeInterceptor');\n\n    $stateProvider.state('signIn', {\n        url: '/sign-in',\n        controller: MODULE_NAME + '.LoginController',\n        controllerAs: 'view',\n        data: {\n            roles: [],\n            secure: false\n        },\n        templateUrl: '/app/modules/security/views/signIn.html'\n    }).state('accessDenied', {\n        url: '/access-denied',\n        data: {\n            roles: []\n        },\n        templateUrl: '/app/modules/security/views/accessDenied.html'\n    });\n}]).run(['$rootScope', MODULE_NAME + '.authorization', '$state', MODULE_NAME + '.security', 'clearcode.tm.alert.$alert', 'clearcode.tm.tagContainer.currentContainer', function ($rootScope, authorization, $state, security, $alertProvider, currentContainer) {\n    $alertProvider.addMessagePattern('login.invalid', 'Login or password is incorrect. Please try again.');\n\n    $alertProvider.addMessagePattern('request.error', 'User with passed email address does not exist.');\n\n    $alertProvider.addMessagePattern('request.success', 'The email with the activation link has been sent successfully.');\n\n    $alertProvider.addMessagePattern('changePassword.success', 'Password has been changed successfully.');\n\n    $alertProvider.addMessagePattern('changePassword.error', 'Sorry, something went wrong. Try to reset your password one more time.');\n\n    $alertProvider.addMessagePattern('changePassword.token', 'Reset password token is required.');\n\n    $alertProvider.addMessagePattern('changePassword.notCurrentPassword', 'This value should be the users current password.');\n\n    $alertProvider.addMessagePattern('invalid.email', 'Your email address is invalid.');\n\n    $alertProvider.addMessagePattern('password.different', 'Repeat password does not match.');\n\n    $alertProvider.addMessagePattern('password.both', 'Both password fields requires at least 8 characters.');\n\n    $alertProvider.addMessagePattern('password.first', 'First password field requires at least 8 characters.');\n\n    $alertProvider.addMessagePattern('password.second', 'Second password field requires at least 8 characters.');\n\n    $rootScope.logout = function () {\n        security.logout().then(function () {\n            currentContainer.disableDebugMode();\n            $state.go('signIn');\n        });\n    };\n\n    $rootScope.deleteHeaderNotSupported = false;\n    $rootScope.security = security;\n\n    $rootScope.$on('$stateChangeStart', function (event, toState) {\n        var isDataDefined = toState.data !== undefined,\n            isSecure,\n            roles;\n\n        if (isDataDefined) {\n            isSecure = toState.data.secure !== undefined ? toState.data.secure : true;\n            roles = toState.data.roles !== undefined ? toState.data.roles : [];\n        }\n\n        authorization.authorize(roles).then(function () {}, function () {\n            if (isSecure) {\n                $state.go('signIn');\n            }\n        });\n    });\n}]).value('$localStorage', localStorage).controller(MODULE_NAME + '.LoginController', _LoginController2.default).service(MODULE_NAME + '.authorization', _Authorization2.default).service(MODULE_NAME + '.security', _Security2.default).service(MODULE_NAME + '.oauthResource', _OAuthResource2.default).service(MODULE_NAME + '.tokenStorage', _TokenStorage2.default).value('OAuthClientSettings', {\n    clientId: typeof OAUTH_CLIENT_ID === 'undefined' ? '1_1234567890' : OAUTH_CLIENT_ID,\n    clientSecret: typeof OAUTH_CLIENT_SECRET === 'undefined' ? 'sec1234567890' : OAUTH_CLIENT_SECRET\n}).factory(MODULE_NAME + '.securityInterceptor', _SecurityInterceptor2.default).factory(MODULE_NAME + '.localeInterceptor', _LocaleInterceptor2.default).factory(MODULE_NAME + '.deleteRequestInterceptor', _DeleteRequestInterceptor2.default);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./controller/LoginController.js\":22,\"./interceptor/DeleteRequestInterceptor.js\":23,\"./interceptor/LocaleInterceptor.js\":24,\"./interceptor/SecurityInterceptor.js\":25,\"./resource/OAuthResource.js\":26,\"./service/Authorization.js\":28,\"./service/Security.js\":29,\"./service/TokenStorage.js\":30}],28:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar security = void 0;\nvar state = void 0;\n\n/**\n * @name security#Authorization\n * @description\n * Service for authorization\n */\n\nvar Authorization = function () {\n    function Authorization($security, $state) {\n        _classCallCheck(this, Authorization);\n\n        security = $security;\n        state = $state;\n    }\n\n    _createClass(Authorization, [{\n        key: 'authorize',\n        value: function authorize(roles) {\n            return security.getUser().then(function () {\n                if (doNotEnter(roles)) {\n                    state.go('signIn');\n                }\n            });\n        }\n    }]);\n\n    return Authorization;\n}();\n\nfunction doNotEnter(roles) {\n    var isAuthenticated = security.isAuthenticated();\n\n    return roles && roles.length > 0 && !security.hasAnyRole(roles) && !isAuthenticated;\n}\n\nexports.default = Authorization;\n\n},{}],29:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name Security\n * @description\n * Store information about current user access token\n */\nvar Security = function () {\n    function Security($q, $timeout, tokenStorage, userResource, oauthResource, $translate) {\n        _classCallCheck(this, Security);\n\n        this.q = $q;\n        this.timeout = $timeout;\n        this.user = undefined;\n        this.authenticated = false;\n        this.tokenStorage = tokenStorage;\n        this.userResource = userResource;\n        this.oauthResource = oauthResource;\n        this.translate = $translate;\n        this.checked = false;\n    }\n\n    _createClass(Security, [{\n        key: 'isAuthenticated',\n        value: function isAuthenticated() {\n            return this.authenticated;\n        }\n    }, {\n        key: 'isChecked',\n        value: function isChecked() {\n            return this.checked;\n        }\n    }, {\n        key: 'isSuperAdmin',\n        value: function isSuperAdmin() {\n            return this.user.roles.indexOf('ROLE_SUPER_ADMIN') !== -1;\n        }\n    }, {\n        key: 'hasRole',\n        value: function hasRole(roleString) {\n            if (!this.authenticated || roleString === undefined) {\n                return false;\n            }\n\n            return this.user.roles.indexOf(roleString) !== -1 || this.isSuperAdmin();\n        }\n    }, {\n        key: 'hasAnyRole',\n        value: function hasAnyRole(roles) {\n            if (!this.authenticated || roles === undefined) {\n                return false;\n            }\n\n            for (var i = 0; i < roles.length; i++) {\n                if (this.hasRole(roles[i])) {\n                    return true;\n                }\n            }\n\n            return false;\n        }\n    }, {\n        key: 'authenticate',\n        value: function authenticate(user) {\n            this.user = user;\n            this.authenticated = true;\n            this.translate.use(user.language);\n        }\n    }, {\n        key: 'logout',\n        value: function logout() {\n            var _this = this;\n\n            var deferred = this.q.defer();\n\n            this.oauthResource.logout().then(function () {\n                _this.user = undefined;\n                _this.authenticated = false;\n                _this.tokenStorage.removeItem();\n\n                deferred.resolve();\n            }, function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'getUser',\n        value: function getUser(force) {\n            var deferred = this.q.defer();\n\n            if (force) {\n                this.reloadUser();\n            }\n\n            if (this.user !== undefined) {\n                deferred.resolve(this.user);\n                this.authenticate(this.user);\n\n                return deferred.promise;\n            }\n\n            if (undefined !== this.tokenStorage.getItem()) {\n                if (!this.isAuthenticated()) {\n                    this.reloadUser();\n                }\n            } else {\n                this.checked = true;\n                deferred.reject();\n            }\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'reloadUser',\n        value: function reloadUser() {\n            var _this2 = this;\n\n            var deferred = this.q.defer();\n\n            this.userResource.getMe().then(function (resp) {\n                _this2.checked = true;\n\n                _this2.authenticate(resp);\n                deferred.resolve(_this2.user);\n            }, function () {\n                _this2.checked = true;\n            });\n        }\n    }]);\n\n    return Security;\n}();\n\nexports.default = Security;\n\n},{}],30:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar localStorage = void 0;\n\n/**\n * @name TokenStorage\n */\n\nvar TokenStorage = function () {\n    function TokenStorage($localStorage) {\n        _classCallCheck(this, TokenStorage);\n\n        localStorage = $localStorage;\n    }\n\n    _createClass(TokenStorage, [{\n        key: 'getItem',\n        value: function getItem() {\n            var accessToken = localStorage.accessToken;\n\n            if (undefined !== accessToken) {\n                accessToken = JSON.parse(accessToken);\n            }\n\n            return accessToken;\n        }\n    }, {\n        key: 'getToken',\n        value: function getToken() {\n            var authToken = this.getItem();\n\n            return TokenStorage.capitalizeFirstLetter(authToken.tokenType) + ' ' + authToken.accessToken;\n        }\n    }, {\n        key: 'addItem',\n        value: function addItem(authToken) {\n            localStorage.accessToken = JSON.stringify(authToken);\n\n            return authToken;\n        }\n    }, {\n        key: 'removeItem',\n        value: function removeItem() {\n            localStorage.removeItem('accessToken');\n        }\n    }], [{\n        key: 'capitalizeFirstLetter',\n        value: function capitalizeFirstLetter(string) {\n            return string.charAt(0).toUpperCase() + string.slice(1);\n        }\n    }]);\n\n    return TokenStorage;\n}();\n\nexports.default = TokenStorage;\n\n},{}],31:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name AuthToken\n */\nvar AuthToken = function AuthToken() {\n  _classCallCheck(this, AuthToken);\n\n  /**\n   * @type {string}\n   */\n  this.accessToken = undefined;\n\n  /**\n   * @type {number}\n   */\n  this.expiresIn = undefined;\n\n  /**\n   * @type {string}\n   */\n  this.tokenType = undefined;\n\n  /**\n   * @type {string}\n   */\n  this.scope = undefined;\n\n  /**\n   * @type {string}\n   */\n  this.refreshToken = undefined;\n};\n\nexports.default = AuthToken;\n\n},{}],32:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar BREADCRUMB_GLOBAL = 'Tags';\n\nvar TAG_TEMPLATE_TAB_ASYNC = 'async',\n    TAG_TEMPLATE_TAB_SYNC = 'sync',\n    PAGE_VIEW_TRIGGER_TYPE = 0,\n    DOM_READY_TRIGGER_TYPE = 4,\n    PAGE_LOAD_TRIGGER_TYPE = 5,\n    SYNCHRONOUS_TAGS_TRIGGER_TYPES = [PAGE_VIEW_TRIGGER_TYPE, DOM_READY_TRIGGER_TYPE, PAGE_LOAD_TRIGGER_TYPE];\n\n/**\n * @name BaseController\n */\n\nvar BaseController = function () {\n    function BaseController($tagResource, $triggerResource, $variableResource, $state, $stateParams, $alert, $scope, $timeout, $TableParams, $paramConverter, CurrentContainer, PageInfo, templatesStorage, $translate) {\n        var _this = this;\n\n        _classCallCheck(this, BaseController);\n\n        this.alert = $alert;\n        this.state = $state;\n        this.scope = $scope;\n        this.stateParams = $stateParams;\n        this.triggerResource = $triggerResource;\n        this.TableParams = $TableParams;\n        this.paramConverter = $paramConverter;\n        this.currentContainer = CurrentContainer;\n\n        this.tag = $tagResource.getEntityObject();\n\n        this.tagPromise = undefined;\n\n        this.triggers = [];\n        this.chosenTriggers = [];\n        this.triggerPromise = undefined;\n        this.displayStepsAfterFirst = false;\n        this.templatesStorage = templatesStorage;\n        this.synchronousTemplates = [];\n        this.asynchronousTemplates = [];\n        this.triggersWhenTagIsAsync = [];\n        this.scope.tagTemplateTab = TAG_TEMPLATE_TAB_ASYNC;\n        this.divideTemplatesBasedOnSynchronicity($timeout);\n\n        this.template = undefined;\n        this.translate = $translate;\n        this.variables = [];\n\n        this.textEditorConfig = {};\n        this.isCodeEditorFocused = false;\n\n        $variableResource.queryAllAvailable(this.stateParams.containerId).then(function (resp) {\n            _this.variables = resp.data;\n        });\n\n        this.textEditorConfig.onLoad = function (cm) {\n            cm.options.variables = _this.variables;\n\n            $scope.insertVariableIntoCode = function (variable) {\n                cm.doc.replaceSelection('{{ ' + variable.name + ' }}');\n                cm.focus();\n            };\n\n            cm.on('focus', function () {\n                _this.isCodeEditorFocused = true;\n            });\n\n            cm.on('blur', function () {\n                _this.isCodeEditorFocused = false;\n            });\n        };\n\n        $scope.$on('trigger.add', function (event, resp) {\n            _this.tag.addTrigger(resp);\n            _this.showTriggerForm = false;\n            _this.validateTriggers = false;\n        });\n\n        $scope.$on('trigger.edit', function (event, resp) {\n            _this.tag.editTrigger(resp);\n            _this.editTriggerForm = false;\n            _this.validateTriggers = false;\n        });\n\n        this.translate(['Place the code']).then(function (translations) {\n            _this.textEditorConfig.placeholder = translations['Place the code'];\n        });\n\n        this.currentContainer.getContainer().then(function () {\n            if (_this.currentContainer.$container.hasPermission('noaccess')) {\n                $state.go('container');\n            }\n\n            _this.translate([_this.getBreadcrumbText(), BREADCRUMB_GLOBAL]).then(function (translations) {\n                PageInfo.clear().add(_this.currentContainer.$container.name, 'tags', {\n                    containerId: _this.currentContainer.$container.id\n                }).add(translations[BREADCRUMB_GLOBAL], 'tags', {\n                    containerId: _this.currentContainer.$container.id\n                }).add(translations[_this.getBreadcrumbText()]).broadcast();\n            });\n        });\n\n        $scope.$on('pageInfo.reload', function (event, args) {\n            _this.translate([_this.getBreadcrumbText(), BREADCRUMB_GLOBAL]).then(function (translations) {\n                PageInfo.clear().add(args.name, 'tags', {\n                    containerId: args.id\n                }).add(translations[BREADCRUMB_GLOBAL], 'tags', {\n                    containerId: args.id\n                }).add(translations[_this.getBreadcrumbText()]).broadcast();\n            });\n        });\n    }\n\n    _createClass(BaseController, [{\n        key: 'divideTemplatesBasedOnSynchronicity',\n        value: function divideTemplatesBasedOnSynchronicity($timeout) {\n            var _this2 = this;\n\n            var alreadyLoadedTemplates = this.templatesStorage.getAll(),\n                classifyTemplate = function classifyTemplate(template) {\n                if (template.isSynchronous) {\n                    _this2.synchronousTemplates.push(template);\n                } else {\n                    _this2.asynchronousTemplates.push(template);\n                }\n            },\n                classifyAfterAllTemplateDataLoaded = function classifyAfterAllTemplateDataLoaded(template) {\n                $timeout(function () {\n                    return classifyTemplate(template);\n                }, 0);\n            };\n\n            for (var i = 0; i < alreadyLoadedTemplates.length; i++) {\n                classifyAfterAllTemplateDataLoaded(alreadyLoadedTemplates[i]);\n            }\n            this.templatesStorage.setListener(classifyAfterAllTemplateDataLoaded);\n        }\n    }, {\n        key: 'hasVariables',\n        value: function hasVariables() {\n            var variablesNotEmpty = angular.isArray(this.variables) && this.variables.length > 0;\n            return !this.isTagTemplateTabActive(TAG_TEMPLATE_TAB_SYNC) && variablesNotEmpty;\n        }\n    }, {\n        key: 'setTagTemplateTab',\n        value: function setTagTemplateTab(tab, keepCurrentTemplate) {\n            if (tab === this.scope.tagTemplateTab) {\n                return;\n            }\n\n            if (!keepCurrentTemplate) {\n                this.deselectCurrentTemplate();\n            }\n\n            this.scope.tagTemplateTab = tab;\n            this.tag.isSynchronous = this.isTagTemplateTabActive(TAG_TEMPLATE_TAB_SYNC);\n            this.rememeberCurrentTriggers();\n\n            if (this.isTagTemplateTabActive(TAG_TEMPLATE_TAB_SYNC)) {\n                this.documentWirteWhenTagIsAsync = this.tag.documentWrite;\n                this.tag.documentWrite = true;\n            } else {\n                this.tag.documentWrite = this.documentWirteWhenTagIsAsync;\n            }\n        }\n    }, {\n        key: 'rememeberCurrentTriggers',\n        value: function rememeberCurrentTriggers() {\n            if (this.isTagTemplateTabActive(TAG_TEMPLATE_TAB_SYNC)) {\n                this.triggersWhenTagIsAsync = this.tag.triggers || [];\n                this.tag.triggers = filterTriggersForSynchronousTags(this.triggersWhenTagIsAsync);\n            } else {\n                this.tag.triggers = this.triggersWhenTagIsAsync;\n            }\n        }\n    }, {\n        key: 'hasTriggersNotAssignableToSyncTags',\n        value: function hasTriggersNotAssignableToSyncTags() {\n            var allTags = this.triggersWhenTagIsAsync || [],\n                triggersAssignableToSyncTags = filterTriggersForSynchronousTags(allTags);\n            return triggersAssignableToSyncTags.length !== allTags.length;\n        }\n    }, {\n        key: 'isTagTemplateTabActive',\n        value: function isTagTemplateTabActive(tab) {\n            return tab === this.scope.tagTemplateTab;\n        }\n    }, {\n        key: 'currentTemplateAllowsToSetRVP',\n        value: function currentTemplateAllowsToSetRVP() {\n            var templateIsTracking = this.hasSelectedPluginTemplate() && this.template.isTracking;\n            return this.hasSelectedCustomTemplate() || templateIsTracking;\n        }\n    }, {\n        key: 'setTagTemplate',\n        value: function setTagTemplate(id) {\n            var selectedSameTemplateAsCurrent = this.tag.template === id;\n            if (selectedSameTemplateAsCurrent) {\n                this.deselectCurrentTemplate();\n                return false;\n            }\n\n            this.tag.template = id;\n\n            if (this.hasSelectedPluginTemplate()) {\n                this.template = this.templatesStorage.get(id);\n                this.tag.code = undefined;\n\n                var requiresAdditionalSelectTemplateType = this.template.types.length !== 0;\n                if (requiresAdditionalSelectTemplateType) {\n                    this.displayStepsAfterFirst = false;\n                } else {\n                    this.setTemplateType(id);\n                }\n\n                this.tag.respectVisitorsPrivacy = this.template.isTracking;\n            } else {\n                this.displayStepsAfterFirst = true;\n                this.tag.respectVisitorsPrivacy = this.isTagTemplateTabActive(TAG_TEMPLATE_TAB_ASYNC);\n            }\n        }\n    }, {\n        key: 'initTagTemplate',\n        value: function initTagTemplate(id, options) {\n            this.tag.template = id;\n            this.setTagTemplateTab(this.tag.isSynchronous ? TAG_TEMPLATE_TAB_SYNC : TAG_TEMPLATE_TAB_ASYNC, true);\n\n            if (this.hasSelectedPluginTemplate()) {\n                this.template = this.templatesStorage.get(id);\n                this.tag.code = undefined;\n\n                if (this.template.types.length === 0) {\n                    this.tag.templateOptions = options;\n                    this.templateFields = this.templatesStorage.getOptions(id);\n                    this.template.templateUrl = this.templatesStorage.getTemplateUrl(id);\n                } else {\n                    this.tag.templateOptions.type = options.type;\n                    this.templateFields = this.templatesStorage.getOptions(id, options.type);\n                    this.template.templateUrl = this.templatesStorage.getTemplateUrl(id, options.type);\n                }\n            }\n\n            this.displayStepsAfterFirst = true;\n        }\n    }, {\n        key: 'setTemplateType',\n        value: function setTemplateType(id, type) {\n            var selectedSameTypeAsCurrent = this.tag.templateOptions.type !== undefined && this.tag.templateOptions.type === type;\n            if (selectedSameTypeAsCurrent) {\n                return false;\n            }\n\n            this.templateFields = this.templatesStorage.getOptions(id, type);\n            this.setOptions();\n            this.tag.templateOptions.type = type;\n            this.template.templateUrl = this.templatesStorage.getTemplateUrl(id, type);\n            this.displayStepsAfterFirst = true;\n        }\n    }, {\n        key: 'setOptions',\n        value: function setOptions() {\n            var fieldsLength = this.templateFields.length;\n            this.tag.templateOptions = {};\n\n            while (fieldsLength--) {\n                this.tag.templateOptions[this.templateFields[fieldsLength].name] = this.templateFields[fieldsLength].value;\n            }\n        }\n    }, {\n        key: 'showExistingTriggers',\n        value: function showExistingTriggers() {\n            this.chosenTriggers = [];\n            this.prepareExistingTriggersList();\n            this.showListTriggersForm = true;\n        }\n    }, {\n        key: 'showAddNewTriggerForm',\n        value: function showAddNewTriggerForm() {\n            this.validateTriggers = false;\n            this.showTriggerForm = true;\n        }\n    }, {\n        key: 'prepareExistingTriggersList',\n        value: function prepareExistingTriggersList() {\n            var _this3 = this;\n\n            this.triggers = [];\n            this.types = ['Page View', 'Click', 'Event', 'Form submission'];\n\n            this.existingTable = new this.TableParams({\n                page: 1,\n                count: 10,\n                sorting: {\n                    name: 'asc'\n                }\n            }, {\n                total: 0,\n                getData: function getData($defer, params) {\n                    var parameters = _this3.paramConverter.list(params.url());\n                    parameters['exclude[]'] = _this3.tag.triggers.map(function (trigger) {\n                        return trigger.id;\n                    });\n                    parameters['types[]'] = _this3.isTagTemplateTabActive(TAG_TEMPLATE_TAB_SYNC) ? SYNCHRONOUS_TAGS_TRIGGER_TYPES : [];\n\n                    _this3.triggerResource.query(_this3.currentContainer.$container.id, parameters).then(function (resp) {\n                        params.total(resp.total);\n                        $defer.resolve(resp.data);\n                    });\n                }\n            });\n        }\n    }, {\n        key: 'addExistingTriggers',\n        value: function addExistingTriggers() {\n            var chosenLength = this.chosenTriggers.length;\n\n            while (chosenLength--) {\n                this.tag.triggers.push(this.chosenTriggers[chosenLength]);\n            }\n        }\n    }, {\n        key: 'submitForm',\n        value: function submitForm(tag) {\n            var _this4 = this;\n\n            this.tagPromise = tag.save(this.stateParams.containerId);\n\n            this.tagPromise.then(function () {\n                _this4.alert.success(_this4.getAlertType(_this4.stateParams.tagId));\n                _this4.currentContainer.makeChanges();\n                _this4.state.go('tags', { containerId: _this4.stateParams.containerId });\n            }, function () {\n                _this4.alert.error('error.invalid');\n            });\n        }\n    }, {\n        key: 'displayInvalidFormMessage',\n        value: function displayInvalidFormMessage() {\n            this.validateTag = true;\n            this.alert.error('error.invalid');\n        }\n    }, {\n        key: 'deselectCurrentTemplate',\n        value: function deselectCurrentTemplate() {\n            this.template = undefined;\n            this.tag.template = null;\n            this.displayStepsAfterFirst = false;\n\n            this.editTriggerForm = false;\n            this.showTriggerForm = false;\n            this.showListTriggersForm = false;\n        }\n    }, {\n        key: 'hasSelectedTemplate',\n        value: function hasSelectedTemplate() {\n            return this.tag.template !== null;\n        }\n    }, {\n        key: 'hasSelectedCustomTemplate',\n        value: function hasSelectedCustomTemplate() {\n            return this.hasSelectedTemplate() && this.tag.template === undefined;\n        }\n    }, {\n        key: 'hasSelectedPluginTemplate',\n        value: function hasSelectedPluginTemplate() {\n            return this.hasSelectedTemplate() && !this.hasSelectedCustomTemplate();\n        }\n    }]);\n\n    return BaseController;\n}();\n\nfunction filterTriggersForSynchronousTags(triggers) {\n    var result = [];\n    for (var i = 0; i < triggers.length; i++) {\n        if (SYNCHRONOUS_TAGS_TRIGGER_TYPES.indexOf(triggers[i].type) !== -1) {\n            result.push(triggers[i]);\n        }\n    }\n    return result;\n}\n\nexports.default = BaseController;\n\n},{}],33:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _BaseController2 = require('./BaseController.js');\n\nvar _BaseController3 = _interopRequireDefault(_BaseController2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n/**\n * @name CreateController\n */\nvar CreateController = function (_BaseController) {\n    _inherits(CreateController, _BaseController);\n\n    function CreateController($tagResource, $triggerResource, $variableResource, $state, $stateParams, $alert, $scope, $timeout, $TableParams, $paramConverter, CurrentContainer, PageInfo, TemplatesStorage, $translate) {\n        _classCallCheck(this, CreateController);\n\n        return _possibleConstructorReturn(this, (CreateController.__proto__ || Object.getPrototypeOf(CreateController)).call(this, $tagResource, $triggerResource, $variableResource, $state, $stateParams, $alert, $scope, $timeout, $TableParams, $paramConverter, CurrentContainer, PageInfo, TemplatesStorage, $translate));\n    }\n\n    _createClass(CreateController, [{\n        key: 'getBreadcrumbText',\n        value: function getBreadcrumbText() {\n            return 'Add a new tag';\n        }\n    }, {\n        key: 'getAlertType',\n        value: function getAlertType() {\n            return 'success.create';\n        }\n    }]);\n\n    return CreateController;\n}(_BaseController3.default);\n\nexports.default = CreateController;\n\n},{\"./BaseController.js\":32}],34:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _BaseController2 = require('./BaseController.js');\n\nvar _BaseController3 = _interopRequireDefault(_BaseController2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n/**\n * @name EditController\n */\nvar EditController = function (_BaseController) {\n    _inherits(EditController, _BaseController);\n\n    function EditController($tagResource, $triggerResource, $variableResource, $state, $stateParams, $alert, $scope, $timeout, $TableParams, $paramConverter, CurrentContainer, PageInfo, templatesStorage, $translate) {\n        _classCallCheck(this, EditController);\n\n        var _this = _possibleConstructorReturn(this, (EditController.__proto__ || Object.getPrototypeOf(EditController)).call(this, $tagResource, $triggerResource, $variableResource, $state, $stateParams, $alert, $scope, $timeout, $TableParams, $paramConverter, CurrentContainer, PageInfo, templatesStorage, $translate));\n\n        _this.tagPromise = $tagResource.get($stateParams.tagId);\n        _this.tagPromise.then(function (resp) {\n            _this.tag = resp;\n            _this.initTagTemplate(_this.tag.template, _this.tag.templateOptions);\n        });\n        return _this;\n    }\n\n    _createClass(EditController, [{\n        key: 'getBreadcrumbText',\n        value: function getBreadcrumbText() {\n            return 'Configure tag';\n        }\n    }, {\n        key: 'getAlertType',\n        value: function getAlertType() {\n            return 'success.edit';\n        }\n    }]);\n\n    return EditController;\n}(_BaseController3.default);\n\nexports.default = EditController;\n\n},{\"./BaseController.js\":32}],35:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar $alert = void 0;\nvar stateParams = void 0;\nvar scope = void 0;\n\nvar BREADCRUMB_TEXT = 'Tags';\n\n/**\n * @name ManageController\n */\n\nvar ManageController = function () {\n    function ManageController(TableParams, $stateParams, tagResource, publishedStatus, alert, paramConverter, CurrentContainer, PageInfo, $scope, state, $translate) {\n        var _this = this;\n\n        _classCallCheck(this, ManageController);\n\n        $alert = alert;\n        stateParams = $stateParams;\n        scope = $scope;\n        this.permissions = [];\n\n        this.containerId = stateParams.containerId;\n        this.translate = $translate;\n        this.currentContainer = CurrentContainer;\n        this.publishedStatus = publishedStatus;\n\n        this.currentContainer.getContainer().then(function (container) {\n            if (!_this.currentContainer.$container.hasPermission('view')) {\n                state.go('container');\n            } else {\n                _this.permissions = _this.currentContainer.$container.permissions;\n            }\n\n            _this.translate([BREADCRUMB_TEXT]).then(function (translations) {\n                PageInfo.clear().add(container.name, 'tags', {\n                    containerId: container.id\n                }).add(translations[BREADCRUMB_TEXT]).broadcast();\n            });\n        });\n\n        this.tableParams = new TableParams({\n            page: 1,\n            count: 10,\n            sorting: {\n                name: 'asc'\n            }\n        }, {\n            total: 0,\n            $scope: $scope,\n            getData: function getData($defer, params) {\n                tagResource.query(stateParams.containerId, paramConverter.list(params.url())).then(function (resp) {\n                    params.total(resp.total);\n                    $defer.resolve(resp.data);\n                });\n            }\n        });\n\n        this.tableParams.reload();\n        scope.params = this.tableParams;\n\n        this.addReloadOnPublishListener($scope);\n\n        // behaviour after page change\n        $scope.$on('ngTableAfterReloadData', function () {\n            _this.showTriggers = -1;\n            _this.showMenu = -1;\n        }, true);\n\n        $scope.$watch('params.$params', function (newParams, oldParams) {\n            if (newParams === oldParams) {\n                return;\n            }\n\n            $scope.params.settings().$scope = $scope;\n            $scope.params.reload();\n        }, true);\n\n        scope.$on('pageInfo.reload', function (event, args) {\n            _this.translate([BREADCRUMB_TEXT]).then(function (translations) {\n                PageInfo.clear().add(args.name, 'tags', {\n                    containerId: args.id\n                }).add(translations[BREADCRUMB_TEXT]).broadcast();\n            });\n        });\n    }\n\n    _createClass(ManageController, [{\n        key: 'addReloadOnPublishListener',\n        value: function addReloadOnPublishListener($scope) {\n            var deregisterPublishListener = $scope.$on('container-published', function () {\n                $scope.params.reload();\n            });\n            $scope.$on('$destroy', function () {\n                deregisterPublishListener();\n            });\n        }\n    }, {\n        key: 'removeTag',\n        value: function removeTag(tag) {\n            var _this2 = this;\n\n            tag.remove().then(function () {\n                $alert.success('success.remove');\n                _this2.currentContainer.makeChanges();\n\n                if (_this2.tableParams.data.length === 1 && _this2.tableParams.page() > 1) {\n                    _this2.tableParams.page(_this2.tableParams.page() - 1);\n                } else {\n                    _this2.tableParams.reload();\n                }\n            }, function () {\n                $alert.error('error.remove');\n                _this2.tableParams.reload();\n            });\n        }\n    }, {\n        key: 'changeStatus',\n        value: function changeStatus(tag) {\n            var _this3 = this;\n\n            tag.changeStatus(this.containerId).then(function () {\n                _this3.currentContainer.makeChanges();\n                $alert.success('status.change');\n            }, function () {\n                $alert.error('status.failed');\n            });\n        }\n    }, {\n        key: 'getPublishedStatus',\n        value: function getPublishedStatus(tag) {\n            return this.publishedStatus.getPublishedStatusForTag(tag);\n        }\n    }, {\n        key: 'toggleActionMenu',\n        value: function toggleActionMenu($index) {\n            if (this.permissions.indexOf('edit') !== -1) {\n                this.showMenu = this.showMenu === $index ? -1 : $index;\n\n                this.showTriggers = -1;\n            }\n        }\n    }, {\n        key: 'toggleTriggerList',\n        value: function toggleTriggerList($index) {\n            this.showMenu = -1;\n            this.showTriggers = this.isRowExpanded($index) ? -1 : $index;\n        }\n    }, {\n        key: 'isRowExpanded',\n        value: function isRowExpanded($index) {\n            return this.showTriggers === $index;\n        }\n    }]);\n\n    return ManageController;\n}();\n\nexports.default = ManageController;\n\n},{}],36:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar tagFactory = function tagFactory(resource) {\n    /**\n     * @name Variable\n     * @description Variable entity\n     */\n    var Tag = function () {\n        function Tag() {\n            _classCallCheck(this, Tag);\n\n            /**\n             * @type {number}\n             */\n            this.id = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.name = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.code = undefined;\n\n            /**\n             * @type {Array}\n             */\n            this.triggers = [];\n\n            /**\n             * @type {string}\n             */\n            this.updatedAt = undefined;\n\n            /**\n             * @type {number}\n             */\n            this.priority = 0;\n\n            /**\n             * @type {boolean}\n             */\n            this.documentWrite = false;\n\n            /**\n             * @type {boolean}\n             */\n            this.disableInDebugMode = false;\n\n            /**\n             * @type {boolean}\n             */\n            this.respectVisitorsPrivacy = false;\n\n            /**\n             * @type {boolean}\n             */\n            this.isSynchronous = false;\n\n            /**\n             * @type {boolean}\n             */\n            this.isActive = true;\n\n            /**\n             * @type {string}\n             */\n            this.template = null;\n\n            /**\n             * @type {Object}\n             */\n            this.templateOptions = {};\n\n            /**\n             * @type {boolean}\n             */\n            this.statusChangePending = false;\n        }\n\n        /**\n         * @param {Trigger} trigger\n         */\n\n\n        _createClass(Tag, [{\n            key: 'addTrigger',\n            value: function addTrigger(trigger) {\n                this.triggers.push(trigger);\n            }\n\n            /**\n             * @param {Trigger} trigger\n             */\n\n        }, {\n            key: 'editTrigger',\n            value: function editTrigger(trigger) {\n                var index = this.triggers.length;\n\n                while (index--) {\n                    if (this.triggers[index].id === trigger.id) {\n                        this.triggers[index] = trigger;\n\n                        return true;\n                    }\n                }\n\n                return false;\n            }\n\n            /**\n             * @param {Trigger} trigger\n             */\n\n        }, {\n            key: 'removeTrigger',\n            value: function removeTrigger(trigger) {\n                var index = this.triggers.indexOf(trigger);\n\n                if (index > -1) {\n                    this.triggers.splice(index, 1);\n\n                    return true;\n                }\n\n                return false;\n            }\n\n            /**\n             * @param {Number} id\n             */\n\n        }, {\n            key: 'removeTriggerById',\n            value: function removeTriggerById(id) {\n                var index = this.triggers.length;\n\n                while (index--) {\n                    if (this.triggers[index].id === id) {\n                        this.triggers.splice(index, 1);\n\n                        return true;\n                    }\n                }\n\n                return false;\n            }\n\n            /**\n             * @param {number} containerId\n             *\n             * @returns {deferred.promise}\n             */\n\n        }, {\n            key: 'save',\n            value: function save(containerId) {\n                var result = {},\n                    promise;\n                var excludedProperty = ['id', 'updatedAt', 'createdAt', 'statusChangePending'];\n\n                if (this.template === undefined) {\n                    excludedProperty.push('templateOptions');\n                } else {\n                    excludedProperty.push('code');\n                    excludedProperty.push('documentWrite');\n                }\n\n                for (var property in this) {\n                    if (!angular.isFunction(this[property]) && this.hasOwnProperty(property) && excludedProperty.indexOf(property) === -1) {\n                        if (property === 'triggers') {\n                            var collection = [];\n\n                            for (var index in this[property]) {\n                                if (this[property][index] instanceof Object) {\n                                    collection.push(this[property][index].id);\n                                }\n                            }\n\n                            result[property] = collection;\n                        } else {\n                            result[property] = this[property];\n                        }\n                    }\n                }\n\n                if (this.id === undefined) {\n                    promise = resource.post(containerId, result);\n                } else {\n                    promise = resource.put(this.id, result);\n                }\n\n                return promise;\n            }\n\n            /**\n             * @returns {deferred.promise|Boolean}\n             */\n\n        }, {\n            key: 'remove',\n            value: function remove() {\n                if (this.id === undefined) {\n                    return false;\n                }\n\n                return resource.delete(this.id);\n            }\n\n            /**\n             * @param containerId\n             * @returns {deferred.promise}\n             */\n\n        }, {\n            key: 'changeStatus',\n            value: function changeStatus(containerId) {\n                var _this = this;\n\n                var tag = angular.copy(this);\n                tag.isActive = !tag.isActive;\n                this.statusChangePending = true;\n\n                var promise = tag.save(containerId).then(function (tag) {\n                    _this.isActive = !_this.isActive;\n                    _this.updatedAt = tag.updatedAt;\n                }).finally(function () {\n                    _this.statusChangePending = false;\n                });\n\n                return promise;\n            }\n        }]);\n\n        return Tag;\n    }();\n\n    return Tag;\n};\n\nexports.default = tagFactory;\n\n},{}],37:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _TemplateType = require('../entity/TemplateType.js');\n\nvar _TemplateType2 = _interopRequireDefault(_TemplateType);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar templateFactory = function templateFactory() {\n    var TemplateType = (0, _TemplateType2.default)();\n\n    var Template = function () {\n        function Template(id, name) {\n            _classCallCheck(this, Template);\n\n            this.id = id;\n            this.name = name;\n            this.brandUrl = undefined;\n            this.templateUrl = undefined;\n            this.type = undefined;\n            this.types = [];\n            this.fields = [];\n            this.isSynchronous = false;\n            this.isTracking = true;\n        }\n\n        _createClass(Template, [{\n            key: 'addTextField',\n            value: function addTextField(params) {\n                var field = params ? params : {};\n                field.type = 'text';\n                this.fields.push(field);\n                return this;\n            }\n        }, {\n            key: 'addHiddenField',\n            value: function addHiddenField(name, value) {\n                var field = {};\n                field.name = name;\n                field.value = value;\n                field.type = 'hidden';\n                this.fields.push(field);\n                return this;\n            }\n        }, {\n            key: 'addSelectField',\n            value: function addSelectField(params) {\n                var field = params ? params : {};\n                field.type = 'select';\n                this.fields.push(field);\n                return this;\n            }\n        }, {\n            key: 'addType',\n            value: function addType(id, name) {\n                var type = new TemplateType(id, name);\n                this.types.push(type);\n                return type;\n            }\n        }, {\n            key: 'addBrand',\n            value: function addBrand(url) {\n                this.brandUrl = url;\n                return this;\n            }\n        }, {\n            key: 'addTemplateUrl',\n            value: function addTemplateUrl(url) {\n                this.templateUrl = url;\n                return this;\n            }\n        }, {\n            key: 'setSynchronous',\n            value: function setSynchronous(isSynchronous) {\n                this.isSynchronous = isSynchronous;\n                return this;\n            }\n        }, {\n            key: 'setTracking',\n            value: function setTracking(isTracking) {\n                this.isTracking = isTracking;\n                return this;\n            }\n        }]);\n\n        return Template;\n    }();\n\n    return Template;\n};\n\nexports.default = templateFactory;\n\n},{\"../entity/TemplateType.js\":38}],38:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nvar templateTypeFactory = function templateTypeFactory() {\n    var TemplateType = function () {\n        function TemplateType(id, name) {\n            _classCallCheck(this, TemplateType);\n\n            /**\n             * @type {string}\n             */\n            this.id = id;\n\n            /**\n             * @type {string}\n             */\n            this.name = name;\n\n            /**\n             * @type {string}\n             */\n            this.templateUrl = undefined;\n\n            /**\n             * @type {object}\n             */\n            this.fields = [];\n        }\n\n        _createClass(TemplateType, [{\n            key: 'addTextField',\n            value: function addTextField(params) {\n                var field = params ? params : {};\n\n                field.type = 'text';\n                this.fields.push(field);\n\n                return this;\n            }\n        }, {\n            key: 'addHiddenField',\n            value: function addHiddenField(name, value) {\n                var field = {};\n\n                field.name = name;\n                field.value = value;\n                field.type = 'hidden';\n\n                this.fields.push(field);\n\n                return this;\n            }\n        }, {\n            key: 'addTemplateUrl',\n            value: function addTemplateUrl(url) {\n                this.templateUrl = url;\n\n                return this;\n            }\n        }]);\n\n        return TemplateType;\n    }();\n\n    return TemplateType;\n};\n\nexports.default = templateTypeFactory;\n\n},{}],39:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _Template = require('../entity/Template.js');\n\nvar _Template2 = _interopRequireDefault(_Template);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Template = (0, _Template2.default)();\n\n/**\n * @name TemplatesProvider\n */\n\nvar TemplatesProvider = function () {\n    function TemplatesProvider() {\n        _classCallCheck(this, TemplatesProvider);\n\n        this.collection = [];\n        this.onAddListener;\n    }\n\n    _createClass(TemplatesProvider, [{\n        key: 'setListener',\n        value: function setListener(listener) {\n            this.onAddListener = listener;\n        }\n    }, {\n        key: 'add',\n        value: function add(id, name) {\n            var template = new Template(id, name);\n            this.collection.push(template);\n\n            if (this.onAddListener) {\n                this.onAddListener(template);\n            }\n\n            return template;\n        }\n    }, {\n        key: 'get',\n        value: function get(id) {\n            var templateLength = this.collection.length;\n\n            while (templateLength--) {\n                if (this.collection[templateLength].id === id) {\n                    return this.collection[templateLength];\n                }\n            }\n\n            return false;\n        }\n    }, {\n        key: 'getAll',\n        value: function getAll() {\n            return this.collection;\n        }\n    }, {\n        key: '$get',\n        value: function $get() {\n            return this;\n        }\n    }]);\n\n    return TemplatesProvider;\n}();\n\nexports.default = TemplatesProvider;\n\n},{\"../entity/Template.js\":37}],40:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _Tag = require('../entity/Tag.js');\n\nvar _Tag2 = _interopRequireDefault(_Tag);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar transformResponse = function transformResponse(resp) {\n    var Tag = (0, _Tag2.default)(this);\n    var tag = new Tag();\n\n    tag.id = resp.id;\n    tag.name = resp.name;\n    tag.code = resp.code;\n    tag.priority = resp.priority;\n    tag.updatedAt = resp.updated_at;\n    tag.createdAt = resp.created_at;\n    tag.documentWrite = resp.document_write;\n    tag.disableInDebugMode = resp.disable_in_debug_mode;\n    tag.isActive = resp.is_active;\n    tag.respectVisitorsPrivacy = resp.respect_visitors_privacy;\n    tag.isSynchronous = resp.is_synchronous;\n\n    if (resp.template !== null) {\n        tag.template = resp.template;\n        tag.templateOptions = resp.template_options;\n    } else {\n        tag.template = undefined;\n    }\n\n    for (var key in resp.triggers) {\n        if (resp.triggers[key] instanceof Object) {\n            tag.addTrigger(resp.triggers[key]);\n        }\n    }\n\n    return tag;\n};\n\nvar appendTransform = function appendTransform(defaults, transform) {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name TagResource\n */\n\nvar TagResource = function () {\n    function TagResource($http, $q) {\n        _classCallCheck(this, TagResource);\n\n        this.http = $http;\n        this.q = $q;\n    }\n\n    _createClass(TagResource, [{\n        key: 'getEntityObject',\n        value: function getEntityObject() {\n            var Tag = (0, _Tag2.default)(this);\n\n            return new Tag();\n        }\n    }, {\n        key: 'get',\n        value: function get(id) {\n            var _this = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: '/api/tags/' + id,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (status < 400) {\n                        return transformResponse.call(_this, resp.data);\n                    } else {\n                        return resp;\n                    }\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'query',\n        value: function query(containerId, params) {\n            var _this2 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: '/api/containers/' + containerId + '/tags',\n                params: params,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp) {\n                    for (var element in resp.data) {\n                        if (resp.data[element] instanceof Object) {\n                            resp.data[element] = transformResponse.call(_this2, resp.data[element]);\n                        }\n                    }\n\n                    return resp;\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'delete',\n        value: function _delete(id) {\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'DELETE',\n                url: '/api/tags/' + id\n            }).success(function (data) {\n                deferred.resolve(data);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'post',\n        value: function post(containerId, entity) {\n            var _this3 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'POST',\n                url: '/api/containers/' + containerId + '/tags',\n                data: entity,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (status < 400) {\n                        return transformResponse.call(_this3, resp.data);\n                    } else {\n                        return resp;\n                    }\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'put',\n        value: function put(id, entity) {\n            var _this4 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'PUT',\n                url: '/api/tags/' + id,\n                data: entity,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (status < 400) {\n                        return transformResponse.call(_this4, resp.data);\n                    } else {\n                        return resp;\n                    }\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }]);\n\n    return TagResource;\n}();\n\nexports.default = TagResource;\n\n},{\"../entity/Tag.js\":36}],41:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar findByKey = function findByKey(collection, key, value) {\n    var collectionLength = collection.length;\n\n    while (collectionLength--) {\n        if (collection[collectionLength][key] === value) {\n            return collection[collectionLength];\n        }\n    }\n\n    return false;\n};\n\n/**\n * @name Templates\n */\n\nvar Templates = function () {\n    function Templates($templates) {\n        _classCallCheck(this, Templates);\n\n        this.templatesService = $templates;\n        this.collection = this.templatesService.getAll();\n    }\n\n    _createClass(Templates, [{\n        key: 'setListener',\n        value: function setListener(listener) {\n            this.templatesService.setListener(listener);\n        }\n    }, {\n        key: 'getAll',\n        value: function getAll() {\n            return this.collection;\n        }\n    }, {\n        key: 'get',\n        value: function get(id) {\n            var collectionLength = this.collection.length;\n\n            while (collectionLength--) {\n                if (this.collection[collectionLength].id === id) {\n                    return this.collection[collectionLength];\n                }\n            }\n\n            return false;\n        }\n    }, {\n        key: 'getOptions',\n        value: function getOptions(id, typeId) {\n            var template = findByKey(this.collection, 'id', id);\n\n            if (template) {\n                if (typeId) {\n                    var type = findByKey(template.types, 'id', typeId);\n\n                    return type && type.hasOwnProperty('fields') ? type.fields : false;\n                }\n\n                return template.hasOwnProperty('fields') ? template.fields : false;\n            }\n\n            return false;\n        }\n    }, {\n        key: 'getTemplateUrl',\n        value: function getTemplateUrl(id, typeId) {\n            var template = findByKey(this.collection, 'id', id);\n\n            if (typeId) {\n                var type = findByKey(template.types, 'id', typeId);\n\n                return type ? type.templateUrl : false;\n            }\n\n            return template.templateUrl;\n        }\n    }]);\n\n    return Templates;\n}();\n\nexports.default = Templates;\n\n},{}],42:[function(require,module,exports){\n'use strict';\n\nvar _CreateController = require('./controllers/CreateController.js');\n\nvar _CreateController2 = _interopRequireDefault(_CreateController);\n\nvar _EditController = require('./controllers/EditController.js');\n\nvar _EditController2 = _interopRequireDefault(_EditController);\n\nvar _ManageController = require('./controllers/ManageController.js');\n\nvar _ManageController2 = _interopRequireDefault(_ManageController);\n\nvar _TagResource = require('./resource/TagResource.js');\n\nvar _TagResource2 = _interopRequireDefault(_TagResource);\n\nvar _Templates = require('./services/Templates.js');\n\nvar _Templates2 = _interopRequireDefault(_Templates);\n\nvar _TemplatesProvider = require('./providers/TemplatesProvider.js');\n\nvar _TemplatesProvider2 = _interopRequireDefault(_TemplatesProvider);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar MODULE_NAME = 'clearcode.tm.tag';\nvar MODULE_TRIGGER = 'clearcode.tm.trigger';\nvar MODULE_VARIABLE = 'clearcode.tm.variable';\nvar MODULE_TAG_CONTAINER = 'clearcode.tm.tagContainer';\nvar MODULE_DIR = 'app/modules/tag';\n\n_Templates2.default.$inject = [MODULE_NAME + '.$template'];\n\n_TagResource2.default.$inject = ['$http', '$q'];\n\n_ManageController2.default.$inject = ['ngTableParams', '$stateParams', MODULE_NAME + '.tagResource', MODULE_TAG_CONTAINER + '.publishedStatus', 'clearcode.tm.alert.alert', MODULE_TAG_CONTAINER + '.paramConverter', MODULE_TAG_CONTAINER + '.currentContainer', 'clearcode.tm.pageInfo.pageInfo', '$scope', '$state', '$translate'];\n\n_CreateController2.default.$inject = [MODULE_NAME + '.tagResource', MODULE_TRIGGER + '.triggerResource', MODULE_VARIABLE + '.variableResource', '$state', '$stateParams', 'clearcode.tm.alert.alert', '$scope', '$timeout', 'ngTableParams', MODULE_TAG_CONTAINER + '.paramConverter', MODULE_TAG_CONTAINER + '.currentContainer', 'clearcode.tm.pageInfo.pageInfo', MODULE_NAME + '.templatesStorage', '$translate'];\n\n_EditController2.default.$inject = [MODULE_NAME + '.tagResource', MODULE_TRIGGER + '.triggerResource', MODULE_VARIABLE + '.variableResource', '$state', '$stateParams', 'clearcode.tm.alert.alert', '$scope', '$timeout', 'ngTableParams', MODULE_TAG_CONTAINER + '.paramConverter', MODULE_TAG_CONTAINER + '.currentContainer', 'clearcode.tm.pageInfo.pageInfo', MODULE_NAME + '.templatesStorage', '$translate'];\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\nangular.module(MODULE_NAME, ['pascalprecht.translate', 'ui.router', 'ngTable', 'clearcode.tm.alert', 'clearcode.tm.pageInfo', 'clearcode.tm.tagContainer', 'clearcode.tm.trigger', 'ui.codemirror']).config(['$stateProvider', function ($stateProvider) {\n    $stateProvider.state('tags', {\n        url: '/containers/{containerId}/tags',\n        controller: MODULE_NAME + '.ManageController as view',\n        templateUrl: MODULE_DIR + '/views/manage.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: true\n        }\n    }).state('tagCreate', {\n        url: '/containers/{containerId}/tag-create',\n        controller: MODULE_NAME + '.CreateController as view',\n        templateUrl: MODULE_DIR + '/views/create.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: true\n        }\n    }).state('tagEdit', {\n        url: '/containers/{containerId}/tag/edit/{tagId}',\n        controller: MODULE_NAME + '.EditController as view',\n        templateUrl: MODULE_DIR + '/views/edit.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: true\n        }\n    });\n}]).run(['clearcode.tm.alert.$alert', function ($alertProvider) {\n    $alertProvider.addMessagePattern('trigger.close', 'You are trying to close unsaved trigger.');\n\n    $alertProvider.addMessagePattern('status.change', 'Tag status was changed successfully');\n\n    $alertProvider.addMessagePattern('status.failed', 'Sorry, something went wrong.');\n}]).provider(MODULE_NAME + '.$template', _TemplatesProvider2.default).controller(MODULE_NAME + '.ManageController', _ManageController2.default).controller(MODULE_NAME + '.CreateController', _CreateController2.default).controller(MODULE_NAME + '.EditController', _EditController2.default).service(MODULE_NAME + '.tagResource', _TagResource2.default).service(MODULE_NAME + '.templatesStorage', _Templates2.default);\n\n},{\"./controllers/CreateController.js\":33,\"./controllers/EditController.js\":34,\"./controllers/ManageController.js\":35,\"./providers/TemplatesProvider.js\":39,\"./resource/TagResource.js\":40,\"./services/Templates.js\":41}],43:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar state = void 0;\nvar $alert = void 0;\n\nvar BREADCRUMB_TEXT = 'Add a container';\n\n/**\n * @name CreateController\n */\n\nvar CreateController = function () {\n    function CreateController(containerResource, $state, alert, PageInfo, $translate) {\n        _classCallCheck(this, CreateController);\n\n        state = $state;\n        $alert = alert;\n        this.container = containerResource.getEntityObject();\n        this.translate = $translate;\n\n        this.translate([BREADCRUMB_TEXT]).then(function (translations) {\n            PageInfo.clear().add(translations[BREADCRUMB_TEXT]).broadcast();\n        });\n    }\n\n    _createClass(CreateController, [{\n        key: 'submitForm',\n        value: function submitForm(container) {\n            this.containerPromise = container.save();\n            this.containerPromise.then(function (resp) {\n                $alert.success('container.create');\n                state.go('containerExplanation', { containerId: resp.id });\n            }, function () {\n                $alert.error('error.invalid');\n            });\n        }\n    }, {\n        key: 'displayInvalidFormMessage',\n        value: function displayInvalidFormMessage() {\n            this.validateContainer = true;\n            $alert.error('error.invalid');\n        }\n    }]);\n\n    return CreateController;\n}();\n\nexports.default = CreateController;\n\n},{}],44:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar state = void 0;\nvar stateParams = void 0;\nvar alert = void 0;\nvar currentContainer = void 0;\nvar scope = void 0;\n\nvar BREADCRUMB_TEXT = 'Options';\n\n/**\n * @name EditController\n */\n\nvar EditController = function () {\n    function EditController(containerResource, $state, $stateParams, $alert, CurrentContainer, PageInfo, $scope, $translate) {\n        var _this = this;\n\n        _classCallCheck(this, EditController);\n\n        state = $state;\n        stateParams = $stateParams;\n        alert = $alert;\n        currentContainer = CurrentContainer;\n        scope = $scope;\n\n        this.pageInfo = PageInfo;\n        this.container = containerResource.getEntityObject();\n        this.containerPromise = containerResource.get(stateParams.containerId);\n        this.containerPromise.then(function (resp) {\n            _this.container = resp;\n        });\n\n        this.translate = $translate;\n        currentContainer.getContainer().then(function () {\n            if (currentContainer.$container.hasPermission('noaccess')) {\n                state.go('container');\n            }\n\n            _this.refreshBreadcrumb(BREADCRUMB_TEXT, currentContainer.$container);\n        });\n\n        scope.$on('pageInfo.reload', function (event, container) {\n            _this.refreshBreadcrumb(BREADCRUMB_TEXT, container);\n        });\n    }\n\n    _createClass(EditController, [{\n        key: 'removeContainer',\n        value: function removeContainer() {\n            this.container.remove().then(function () {\n                alert.success('success.remove');\n                state.go('container');\n            }, function () {\n                alert.error('error.remove');\n            });\n        }\n    }, {\n        key: 'submitForm',\n        value: function submitForm(container) {\n            var _this2 = this;\n\n            this.containerPromise = container.save();\n\n            this.containerPromise.then(function (container) {\n                _this2.refreshBreadcrumb(BREADCRUMB_TEXT, container);\n                currentContainer.get(stateParams.containerId);\n                alert.success('success.edit');\n                state.go('containerEdit', { containerId: stateParams.containerId });\n            }, function () {\n                alert.error('error.invalid');\n            });\n        }\n    }, {\n        key: 'displayInvalidFormMessage',\n        value: function displayInvalidFormMessage() {\n            this.validateContainer = true;\n            alert.error('error.invalid');\n        }\n    }, {\n        key: 'refreshBreadcrumb',\n        value: function refreshBreadcrumb(breadcrumbText, container) {\n            var pageInfo = this.pageInfo;\n\n            this.translate([breadcrumbText]).then(function (translations) {\n                pageInfo.clear().add(container.name, 'tags', {\n                    containerId: container.id\n                }).add(translations[breadcrumbText]).broadcast();\n            });\n        }\n    }]);\n\n    return EditController;\n}();\n\nexports.default = EditController;\n\n},{}],45:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar stateParams = void 0;\n\nvar PAGE_TITLE = 'Container created successfully';\n\n/**\n * @name ExplanationController\n */\n\nvar ExplanationController = function ExplanationController(containerResource, $stateParams, PageInfo, CurrentContainer, $translate) {\n    var _this = this;\n\n    _classCallCheck(this, ExplanationController);\n\n    stateParams = $stateParams;\n    this.translate = $translate;\n\n    CurrentContainer.makeChanges();\n\n    this.translate([PAGE_TITLE]).then(function (translations) {\n        PageInfo.clear().add(translations[PAGE_TITLE]).broadcast();\n    });\n\n    this.container = containerResource.getEntityObject();\n    this.containerPromise = containerResource.get(stateParams.containerId);\n\n    this.containerPromise.then(function (resp) {\n        _this.container = resp;\n    });\n};\n\nexports.default = ExplanationController;\n\n},{}],46:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar DEBOUNCE_TIMEOUT = 500;\n\nvar $alert = void 0,\n    $timeout = void 0;\n\n/**\n * @name ManageController\n */\n\nvar ManageController = function () {\n    function ManageController(TableParams, scope, timeout, containerResource, publishedStatus, alert, paramConverter, currentContainer) {\n        var _this = this;\n\n        _classCallCheck(this, ManageController);\n\n        $alert = alert;\n        $timeout = timeout;\n        this.publishedStatus = publishedStatus;\n        currentContainer.disableDebugMode();\n        this.currentFilterQuery = '';\n        this.filterQuery = '';\n\n        this.tableParams = new TableParams({\n            page: 1,\n            count: 10,\n            sorting: {\n                name: 'asc'\n            }\n        }, {\n            total: 0,\n            getData: function getData($defer, params) {\n                var queryParam = paramConverter.list(params.url());\n                if (_this.useSearchByName()) {\n                    queryParam.name = _this.currentFilterQuery;\n                }\n\n                containerResource.query(queryParam).then(function (resp) {\n                    params.total(resp.total);\n                    $defer.resolve(resp.data);\n                    _this.filterQuery = _this.currentFilterQuery;\n                });\n            }\n        });\n\n        scope.$on('$destroy', function () {\n            $timeout.cancel(_this.debounce);\n        });\n    }\n\n    _createClass(ManageController, [{\n        key: 'removeContainer',\n        value: function removeContainer(container) {\n            var _this2 = this;\n\n            container.remove().then(function () {\n                $alert.success('success.remove');\n                if (_this2.tableParams.data.length === 1) {\n                    _this2.tableParams.page(_this2.tableParams.page() - 1);\n                }\n                _this2.tableParams.reload();\n            }, function () {\n                $alert.error('error.remove');\n                _this2.tableParams.reload();\n            });\n        }\n    }, {\n        key: 'getPublishedStatus',\n        value: function getPublishedStatus(container) {\n            return this.publishedStatus.getPublishedStatusForContainer(container);\n        }\n    }, {\n        key: 'search',\n        value: function search() {\n            this.tableParams.page(1);\n            this.tableParams.reload();\n        }\n    }, {\n        key: 'searchDebounced',\n        value: function searchDebounced() {\n            var _this3 = this;\n\n            $timeout.cancel(this.debounce);\n\n            var searchCallback = function searchCallback() {\n                _this3.search();\n            };\n\n            if (this.currentFilterQuery !== this.filterQuery) {\n                this.debounce = $timeout(searchCallback, DEBOUNCE_TIMEOUT);\n            }\n        }\n    }, {\n        key: 'resetSearchQuery',\n        value: function resetSearchQuery() {\n            this.currentFilterQuery = '';\n            this.search();\n        }\n    }, {\n        key: 'showSearchLoader',\n        value: function showSearchLoader() {\n            return this.currentFilterQuery !== this.filterQuery;\n        }\n    }, {\n        key: 'useSearchByName',\n        value: function useSearchByName() {\n            return this.currentFilterQuery !== undefined && this.currentFilterQuery.length > 0;\n        }\n    }]);\n\n    return ManageController;\n}();\n\nexports.default = ManageController;\n\n},{}],47:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar permissionsResource = void 0;\nvar currentContainer = void 0;\nvar alert = void 0;\n\n/**\n * @name PermissionsController\n */\n\nvar PermissionsController = function () {\n    function PermissionsController(TableParams, paramConverter, $currentContainer, $alert, $permissionsResource) {\n        _classCallCheck(this, PermissionsController);\n\n        this.permissionsPromise = undefined;\n        permissionsResource = $permissionsResource;\n        currentContainer = $currentContainer;\n        alert = $alert;\n\n        this.usersTable = new TableParams({\n            page: 1,\n            count: 10,\n            sorting: {\n                name: 'asc'\n            }\n        }, {\n            total: 0,\n            getData: function getData($defer, params) {\n                permissionsResource.query(currentContainer.$container.id, paramConverter.list(params.url())).then(function (resp) {\n                    params.total(resp.total);\n                    $defer.resolve(resp.data);\n                });\n            }\n        });\n    }\n\n    _createClass(PermissionsController, [{\n        key: 'setPermission',\n        value: function setPermission(permission, value) {\n            var tempRequest = angular.copy(permission);\n            tempRequest.permissions = value;\n            this.permissionsPromise = tempRequest.save(currentContainer.$container.id);\n\n            this.permissionsPromise.then(function (resp) {\n                permission.permissions = resp.permissions;\n            }, function () {\n                alert.error('permissions.error');\n            });\n        }\n    }, {\n        key: 'isValid',\n        value: function isValid(permission, value) {\n            if (permission.permissions === value || permission.user.roles.indexOf('ROLE_SUPER_ADMIN') !== -1) {\n                return false;\n            }\n\n            return true;\n        }\n    }]);\n\n    return PermissionsController;\n}();\n\nexports.default = PermissionsController;\n\n},{}],48:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name PrivacyController\n */\nvar PrivacyController = function PrivacyController(stateParams, containerResource) {\n    var _this = this;\n\n    _classCallCheck(this, PrivacyController);\n\n    this.privacyPromise = containerResource.getPrivacyOptOut(stateParams.containerId).then(function (resp) {\n        _this.code = resp.code;\n    });\n};\n\nexports.default = PrivacyController;\n\n},{}],49:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar containerFactory = function containerFactory(resource) {\n    /**\n     * @name Container\n     * @description Container entity\n     */\n    var Container = function () {\n        function Container() {\n            _classCallCheck(this, Container);\n\n            this.id;\n            this.name;\n            this.code;\n            this.codeSynchronous;\n            this.version;\n            this.hasUnpublishedChanges;\n            this.publishedAt;\n            this.permissions;\n            this.delay;\n            this.websites;\n        }\n\n        /**\n         * @returns {deferred.promise}\n         */\n\n\n        _createClass(Container, [{\n            key: 'save',\n            value: function save() {\n                var result = {},\n                    promise;\n                var excludedProperty = ['id', 'code', 'codeSynchronous', 'version', 'hasUnpublishedChanges', 'publishedAt', 'permissions', 'websites'];\n\n                for (var property in this) {\n                    if (!angular.isFunction(this[property]) && this.hasOwnProperty(property) && excludedProperty.indexOf(property) === -1) {\n                        result[property] = this[property];\n                    }\n                }\n\n                if (this.id === undefined) {\n                    delete result.delay;\n                    promise = resource.post(result);\n                } else {\n                    promise = resource.put(this.id, result);\n                }\n\n                return promise;\n            }\n\n            /**\n             * @returns {deferred.promise|Boolean}\n             */\n\n        }, {\n            key: 'remove',\n            value: function remove() {\n                if (this.id === undefined) {\n                    return false;\n                }\n\n                return resource.delete(this.id);\n            }\n        }, {\n            key: 'hasPermission',\n            value: function hasPermission(permission) {\n                return this.permissions.indexOf(permission) !== -1;\n            }\n\n            /**\n             * Get permission\n             */\n\n        }, {\n            key: 'getPermission',\n            value: function getPermission() {\n                var permissionsPrioritiedArray = [{\n                    value: 'operator',\n                    text: 'Owner'\n                }, {\n                    value: 'publish',\n                    text: 'Publish'\n                }, {\n                    value: 'edit',\n                    text: 'Edit'\n                }, {\n                    value: 'view',\n                    text: 'View'\n                }];\n\n                for (var permissionIndex in permissionsPrioritiedArray) {\n                    if (this.permissions.indexOf(permissionsPrioritiedArray[permissionIndex].value) !== -1) {\n                        return permissionsPrioritiedArray[permissionIndex].text;\n                    }\n                }\n            }\n        }]);\n\n        return Container;\n    }();\n\n    return Container;\n};\n\nexports.default = containerFactory;\n\n},{}],50:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar permissionFactory = function permissionFactory(resource) {\n    /**\n     * @name Permission\n     * @description Permission entity\n     */\n    var Permission = function () {\n        function Permission() {\n            _classCallCheck(this, Permission);\n\n            this.user;\n            this.permissions;\n        }\n\n        _createClass(Permission, [{\n            key: \"save\",\n            value: function save(containerId) {\n                var result = void 0,\n                    promise = void 0;\n                result = angular.copy(this);\n                result.user = result.user.id;\n                promise = resource.put(containerId, result);\n\n                return promise;\n            }\n        }]);\n\n        return Permission;\n    }();\n\n    return Permission;\n};\n\nexports.default = permissionFactory;\n\n},{}],51:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _Container = require('../entity/Container.js');\n\nvar _Container2 = _interopRequireDefault(_Container);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar transformResponse = function transformResponse(resp) {\n    var Container = (0, _Container2.default)(this);\n\n    var container = new Container();\n\n    if (resp !== undefined) {\n        container.id = resp.id;\n        container.name = resp.name;\n        container.description = resp.description;\n        container.code = resp.code;\n        container.codeSynchronous = resp.code_synchronous;\n        container.version = resp.version;\n        container.hasUnpublishedChanges = resp.has_unpublished_changes;\n        container.publishedAt = resp.published_at;\n        container.permissions = resp.permissions;\n        container.delay = resp.delay;\n        container.websites = [];\n\n        for (var i = 0; i < resp.websites.length; i++) {\n            var website = this.WebsiteResource.getEntityObject();\n\n            website.url = resp.websites[i].url;\n            website.parameterType = resp.websites[i].parameter_type;\n\n            container.websites.push(website);\n        }\n    }\n\n    return container;\n};\n\nvar appendTransform = function appendTransform(defaults, transform) {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name ContainerResource\n */\n\nvar ContainerResource = function () {\n    function ContainerResource($http, $q, WebsiteResource) {\n        _classCallCheck(this, ContainerResource);\n\n        this.http = $http;\n        this.q = $q;\n        this.WebsiteResource = WebsiteResource;\n    }\n\n    _createClass(ContainerResource, [{\n        key: 'getEntityObject',\n        value: function getEntityObject() {\n            var Container = (0, _Container2.default)(this);\n\n            return new Container();\n        }\n    }, {\n        key: 'get',\n        value: function get(id) {\n            var _this = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: '/api/containers/' + id,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp) {\n                    return transformResponse.call(_this, resp.data);\n                })\n            }).success(function (data) {\n                deferred.resolve(data);\n            }).error(function () {\n                deferred.reject();\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'query',\n        value: function query(params) {\n            var _this2 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: '/api/containers',\n                params: params,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp) {\n                    for (var element in resp.data) {\n                        if (resp.data[element] instanceof Object) {\n                            resp.data[element] = transformResponse.call(_this2, resp.data[element]);\n                        }\n                    }\n\n                    return resp;\n                })\n            }).success(function (data) {\n                deferred.resolve(data);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'delete',\n        value: function _delete(id) {\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'DELETE',\n                url: '/api/containers/' + id\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'post',\n        value: function post(entity) {\n            var _this3 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'POST',\n                url: '/api/containers',\n                data: entity,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp) {\n                    return transformResponse.call(_this3, resp.data);\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'put',\n        value: function put(id, entity) {\n            var _this4 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'PUT',\n                url: '/api/containers/' + id,\n                data: entity,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp) {\n                    return transformResponse.call(_this4, resp.data);\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'publishVersion',\n        value: function publishVersion(id) {\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'POST',\n                url: '/api/containers/' + id + '/version-publish'\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'restoreVersion',\n        value: function restoreVersion(id) {\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'POST',\n                url: '/api/containers/' + id + '/version-restore'\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'getPrivacyOptOut',\n        value: function getPrivacyOptOut(id) {\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: 'containers/' + id + '/privacy'\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }]);\n\n    return ContainerResource;\n}();\n\nexports.default = ContainerResource;\n\n},{\"../entity/Container.js\":49}],52:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _Permission = require('../entity/Permission.js');\n\nvar _Permission2 = _interopRequireDefault(_Permission);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar transformResponse = function transformResponse(resp) {\n    var permissionList = ['operator', 'publish', 'edit', 'view', 'noaccess'];\n\n    var Permission = (0, _Permission2.default)(this);\n\n    var permission = new Permission();\n\n    permission.user = resp.user;\n\n    if (resp.permissions instanceof Object) {\n        for (var permissionIndex in permissionList) {\n            if (resp.permissions.indexOf(permissionList[permissionIndex]) !== -1) {\n                permission.permissions = permissionList[permissionIndex];\n                break;\n            }\n        }\n    } else {\n        permission.permissions = resp.permissions;\n    }\n\n    return permission;\n};\n\nvar appendTransform = function appendTransform(defaults, transform) {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name PermissionResource\n */\n\nvar PermissionResource = function () {\n    function PermissionResource($http, $q) {\n        _classCallCheck(this, PermissionResource);\n\n        this.http = $http;\n        this.q = $q;\n    }\n\n    _createClass(PermissionResource, [{\n        key: 'getEntityObject',\n        value: function getEntityObject() {\n            var Permission = (0, _Permission2.default)(this);\n\n            return new Permission();\n        }\n    }, {\n        key: 'query',\n        value: function query(id, params) {\n            var _this = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: '/api/containers/' + id + '/permissions',\n                params: params,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp) {\n                    for (var element in resp.data) {\n                        if (resp.data[element] instanceof Object) {\n                            resp.data[element] = transformResponse.call(_this, resp.data[element]);\n                        }\n                    }\n\n                    return resp;\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'put',\n        value: function put(id, entity) {\n            var _this2 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'PUT',\n                data: entity,\n                url: 'api/containers/' + id + '/permissions',\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (status < 400) {\n                        return transformResponse.call(_this2, resp.data);\n                    }\n\n                    return resp;\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }]);\n\n    return PermissionResource;\n}();\n\nexports.default = PermissionResource;\n\n},{\"../entity/Permission.js\":50}],53:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar stateParams = void 0;\nvar $containerResource = void 0;\nvar alert = void 0;\nvar state = void 0;\nvar rootScope = void 0;\nvar cookies = void 0;\nvar conditionResource = void 0;\n\nvar PREVIEW_KEY = 'preview';\nvar DEBUG_KEY = 'debug';\n\n/**\n * Convert params for request\n *\n * @name CurrentContainer\n */\n\nvar CurrentContainer = function () {\n    function CurrentContainer($stateParams, containerResource, $alert, $state, $rootScope, $cookies, $conditionResource, $translate) {\n        _classCallCheck(this, CurrentContainer);\n\n        stateParams = $stateParams;\n        $containerResource = containerResource;\n        alert = $alert;\n        state = $state;\n        rootScope = $rootScope;\n        this.$container = undefined;\n        cookies = $cookies;\n\n        this.types = undefined;\n        this.debugMode = false;\n        this.previewedContainer = undefined;\n        this.translate = $translate;\n        conditionResource = $conditionResource;\n    }\n\n    _createClass(CurrentContainer, [{\n        key: 'get',\n        value: function get(containerId) {\n            var _this = this;\n\n            containerId = this.getId(containerId);\n            rootScope.currentContainerLoading = true;\n\n            this.containerPromise = $containerResource.get(containerId).then(function (resp) {\n                _this.$container = resp;\n                rootScope.currentContainerLoading = false;\n                _this.verifyDebugMode();\n\n                if (_this.types === undefined) {\n                    _this.types = _this.setTypes();\n                }\n\n                return _this.$container;\n            });\n\n            return this.containerPromise;\n        }\n    }, {\n        key: 'getId',\n        value: function getId(containerId) {\n            return containerId !== undefined ? containerId : stateParams.containerId;\n        }\n    }, {\n        key: 'getContainer',\n        value: function getContainer() {\n            var response = void 0;\n\n            if (this.containerPromise === undefined) {\n                response = this.get();\n            } else {\n                response = this.containerPromise;\n            }\n\n            return response;\n        }\n    }, {\n        key: 'publish',\n        value: function publish() {\n            var _this2 = this;\n\n            var publishPromise = $containerResource.publishVersion(this.getId());\n\n            rootScope.currentContainerLoading = true;\n\n            return publishPromise.then(function () {\n                alert.success('success.publish');\n                rootScope.currentContainerLoading = false;\n                _this2.get().then(function () {\n                    rootScope.$broadcast('container-published', _this2);\n                });\n            }, function () {\n                alert.error('container.error');\n                rootScope.currentContainerLoading = false;\n            });\n        }\n    }, {\n        key: 'canRestore',\n        value: function canRestore() {\n            if (!this.$container) {\n                return false;\n            }\n\n            return this.$container.publishedAt && this.$container.hasUnpublishedChanges;\n        }\n    }, {\n        key: 'isDirty',\n        value: function isDirty() {\n            return this.$container && this.$container.hasUnpublishedChanges;\n        }\n    }, {\n        key: 'isPublished',\n        value: function isPublished() {\n            if (!this.$container) {\n                return false;\n            }\n\n            return this.$container.publishedAt && !this.$container.hasUnpublishedChanges;\n        }\n    }, {\n        key: 'makeChanges',\n        value: function makeChanges() {\n            if (!this.$container) {\n                return false;\n            }\n\n            return this.$container.hasUnpublishedChanges = true;\n        }\n\n        /**\n         * Dischard draft changes to latest published version\n         */\n\n    }, {\n        key: 'restore',\n        value: function restore() {\n            var _this3 = this;\n\n            var restorePromise = $containerResource.restoreVersion(this.getId());\n            rootScope.currentContainerLoading = true;\n\n            restorePromise.then(function () {\n                alert.success('success.restore');\n                _this3.get();\n\n                var isTagView = state.includes('tags') || state.includes('tagEdit') || state.includes('tagCreate'),\n                    isTriggerView = state.includes('triggers') || state.includes('triggerCreate') || state.includes('triggerEdit');\n                if (isTagView) {\n                    state.go('tags', { containerId: _this3.getId() }, { reload: true });\n                } else if (isTriggerView) {\n                    state.go('triggers', { containerId: _this3.getId() }, { reload: true });\n                } else {\n                    state.go('containerEdit', { containerId: _this3.getId() }, { reload: true });\n                }\n\n                rootScope.currentContainerLoading = false;\n            }, function () {\n                alert.error('container.error');\n            });\n        }\n    }, {\n        key: 'verifyDebugMode',\n        value: function verifyDebugMode() {\n            var _this4 = this;\n\n            if (this.isDebugModeEnabled()) {\n                var cookiesDebug = cookies.get(DEBUG_KEY);\n                if (cookiesDebug === this.$container.id) {\n                    this.debugMode = true;\n                    this.previewedContainer = this.$container;\n\n                    this.translate(['Now Previewing']).then(function (translations) {\n                        _this4.previewedContainerText = translations['Now Previewing'];\n                    });\n                } else {\n                    this.disableDebugMode();\n                }\n            }\n        }\n    }, {\n        key: 'isDebugModeEnabled',\n        value: function isDebugModeEnabled() {\n            var cookiesDebug = cookies.get(DEBUG_KEY);\n            var cookiesPreview = cookies.get(PREVIEW_KEY);\n\n            return cookiesDebug !== undefined && cookiesPreview !== undefined && cookiesDebug === cookiesPreview;\n        }\n    }, {\n        key: 'enableDebugMode',\n        value: function enableDebugMode() {\n            var _this5 = this;\n\n            this.debugMode = true;\n            this.previewedContainer = this.$container;\n\n            this.translate(['Now Previewing']).then(function (translations) {\n                _this5.previewedContainerText = translations['Now Previewing'];\n            });\n\n            cookies.put(PREVIEW_KEY, this.$container.id);\n            cookies.put(DEBUG_KEY, this.$container.id);\n        }\n    }, {\n        key: 'disableDebugMode',\n        value: function disableDebugMode() {\n            this.debugMode = false;\n            this.previewedContainer = undefined;\n\n            cookies.remove(PREVIEW_KEY);\n            cookies.remove(DEBUG_KEY);\n        }\n    }, {\n        key: 'setTypes',\n        value: function setTypes() {\n            return conditionResource.query(this.getId()).then(function (resp) {\n                var respIndex = resp.length,\n                    mapped = [];\n\n                while (respIndex--) {\n                    mapped[respIndex] = {\n                        name: resp[respIndex].name,\n                        type: resp[respIndex].type\n                    };\n                }\n\n                return mapped;\n            });\n        }\n    }, {\n        key: 'hasPermission',\n        value: function hasPermission(permission) {\n            return this.getContainer().then(function (container) {\n                return container.hasPermission(permission);\n            });\n        }\n    }]);\n\n    return CurrentContainer;\n}();\n\nexports.default = CurrentContainer;\n\n},{}],54:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * Convert params for request\n *\n * @name ParamConverter\n */\nvar ParamConverter = function () {\n    function ParamConverter() {\n        _classCallCheck(this, ParamConverter);\n    }\n\n    _createClass(ParamConverter, [{\n        key: \"list\",\n        value: function list(params) {\n            return {\n                limit: params.count,\n                offset: (params.page - 1) * params.count\n            };\n        }\n    }]);\n\n    return ParamConverter;\n}();\n\nexports.default = ParamConverter;\n\n},{}],55:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar STATE_DRAFT = 0,\n    STATE_NEVER_PUBLISHED = 1,\n    STATE_PUBLISHED = 2,\n    STATE_WAITING_FOR_CONTAINER_DATA = 3;\nvar PUBLISHED_STATE = [{\n    name: 'Draft',\n    class: 'stg-status-badge-draft'\n}, {\n    name: 'Draft - never published',\n    class: 'stg-status-badge-never-published'\n}, {\n    name: 'Published',\n    class: 'stg-status-badge-published'\n}, {\n    name: '',\n    class: ''\n}];\n\nvar currentContainer = void 0;\n\n/**\n * @name PublishedStatus\n */\n\nvar PublishedStatus = function () {\n    function PublishedStatus($currentContainer) {\n        _classCallCheck(this, PublishedStatus);\n\n        currentContainer = $currentContainer;\n    }\n\n    _createClass(PublishedStatus, [{\n        key: 'getPublishedStatusForContainer',\n        value: function getPublishedStatusForContainer(container) {\n            return getPublishedState(container, container.hasUnpublishedChanges);\n        }\n    }, {\n        key: 'getPublishedStatusForTag',\n        value: function getPublishedStatusForTag(tag) {\n            var $container = currentContainer.$container;\n            if (!$container) {\n                return PUBLISHED_STATE[STATE_WAITING_FOR_CONTAINER_DATA];\n            }\n\n            var dateTagChanged = new Date(tag.updatedAt),\n                dateTagCreated = new Date(tag.createdAt),\n                dateContainerPublished = new Date($container.publishedAt),\n                tagIsDirty = dateTagChanged > dateContainerPublished,\n                tagCreatedAfterLastPublish = dateTagCreated > dateContainerPublished;\n            return getPublishedState($container, tagIsDirty, tagCreatedAfterLastPublish);\n        }\n    }]);\n\n    return PublishedStatus;\n}();\n\nfunction getPublishedState(container, hasUnpublishedChanges, wasNeverPublished) {\n    if (!containerHasBeenPublished(container) || wasNeverPublished) {\n        return PUBLISHED_STATE[STATE_NEVER_PUBLISHED];\n    } else if (hasUnpublishedChanges) {\n        return PUBLISHED_STATE[STATE_DRAFT];\n    } else {\n        return PUBLISHED_STATE[STATE_PUBLISHED];\n    }\n}\n\nfunction containerHasBeenPublished(container) {\n    return !!container.publishedAt;\n}\n\nexports.default = PublishedStatus;\n\n},{}],56:[function(require,module,exports){\n'use strict';\n\nvar _ManageController = require('./controllers/ManageController.js');\n\nvar _ManageController2 = _interopRequireDefault(_ManageController);\n\nvar _CreateController = require('./controllers/CreateController.js');\n\nvar _CreateController2 = _interopRequireDefault(_CreateController);\n\nvar _EditController = require('./controllers/EditController.js');\n\nvar _EditController2 = _interopRequireDefault(_EditController);\n\nvar _ExplanationController = require('./controllers/ExplanationController.js');\n\nvar _ExplanationController2 = _interopRequireDefault(_ExplanationController);\n\nvar _PermissionsController = require('./controllers/PermissionsController.js');\n\nvar _PermissionsController2 = _interopRequireDefault(_PermissionsController);\n\nvar _PrivacyController = require('./controllers/PrivacyController.js');\n\nvar _PrivacyController2 = _interopRequireDefault(_PrivacyController);\n\nvar _ContainerResource = require('./resource/ContainerResource.js');\n\nvar _ContainerResource2 = _interopRequireDefault(_ContainerResource);\n\nvar _PermissionResource = require('./resource/PermissionResource.js');\n\nvar _PermissionResource2 = _interopRequireDefault(_PermissionResource);\n\nvar _ParamConverter = require('./service/ParamConverter.js');\n\nvar _ParamConverter2 = _interopRequireDefault(_ParamConverter);\n\nvar _CurrentContainer = require('./service/CurrentContainer.js');\n\nvar _CurrentContainer2 = _interopRequireDefault(_CurrentContainer);\n\nvar _PublishedStatus = require('./service/PublishedStatus.js');\n\nvar _PublishedStatus2 = _interopRequireDefault(_PublishedStatus);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar MODULE_NAME = 'clearcode.tm.tagContainer'; /**\n                                                * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                *\n                                                * This program is free software: you can redistribute it and/or modify it under\n                                                * the terms of the GNU Affero General Public License as published by the Free\n                                                * Software Foundation, either version 3 of the License, or (at your option) any\n                                                * later version.\n                                                *\n                                                * This program is distributed in the hope that it will be useful,\n                                                * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                * GNU Affero General Public License for more details.\n                                                *\n                                                * You should have received a copy of the GNU Affero General Public License\n                                                * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                */\n\nvar DEBUG_MODULE_NAME = 'clearcode.tm.debug';\nvar MODULE_DIR = 'app/modules/tagContainer';\n\n_ContainerResource2.default.$inject = ['$http', '$q', DEBUG_MODULE_NAME + '.websiteResource'];\n\n_PermissionResource2.default.$inject = ['$http', '$q'];\n\n_CurrentContainer2.default.$inject = ['$stateParams', MODULE_NAME + '.containerResource', 'clearcode.tm.alert.alert', '$state', '$rootScope', '$cookieStore', 'clearcode.tm.condition.conditionResource', '$translate'];\n\n_PublishedStatus2.default.$inject = [MODULE_NAME + '.currentContainer'];\n\n_ManageController2.default.$inject = ['ngTableParams', '$scope', '$timeout', MODULE_NAME + '.containerResource', MODULE_NAME + '.publishedStatus', 'clearcode.tm.alert.alert', MODULE_NAME + '.paramConverter', MODULE_NAME + '.currentContainer'];\n\n_CreateController2.default.$inject = [MODULE_NAME + '.containerResource', '$state', 'clearcode.tm.alert.alert', 'clearcode.tm.pageInfo.pageInfo', '$translate'];\n\n_EditController2.default.$inject = [MODULE_NAME + '.containerResource', '$state', '$stateParams', 'clearcode.tm.alert.alert', 'clearcode.tm.tagContainer.currentContainer', 'clearcode.tm.pageInfo.pageInfo', '$scope', '$translate'];\n\n_ExplanationController2.default.$inject = [MODULE_NAME + '.containerResource', '$stateParams', 'clearcode.tm.pageInfo.pageInfo', 'clearcode.tm.tagContainer.currentContainer', '$translate'];\n\n_PermissionsController2.default.$inject = ['ngTableParams', MODULE_NAME + '.paramConverter', MODULE_NAME + '.currentContainer', 'clearcode.tm.alert.alert', MODULE_NAME + '.permissionResource'];\n\n_PrivacyController2.default.$inject = ['$stateParams', MODULE_NAME + '.containerResource'];\n\nangular.module(MODULE_NAME, ['pascalprecht.translate', 'ui.router', 'ngTable', 'ngCookies', 'clearcode.tm.condition', 'clearcode.tm.alert', 'clearcode.tm.pageInfo', 'clearcode.tm.user', DEBUG_MODULE_NAME]).run(['$rootScope', MODULE_NAME + '.currentContainer', '$stateParams', 'clearcode.tm.alert.$alert', function ($rootScope, currentContainer, $stateParams, $alertProvider) {\n    $rootScope.currentContainerLoading = true;\n    $rootScope.currentContainer = currentContainer;\n\n    var loadContainer = function loadContainer(containerId) {\n        if (containerId !== $stateParams.containerId) {\n            var currentContainerPromise = currentContainer.get(containerId);\n\n            currentContainerPromise.then(function (container) {\n                $rootScope.$broadcast('pageInfo.reload', container);\n            });\n        }\n    };\n\n    $rootScope.$on('$stateChangeStart', function (event, toState, toParams) {\n        loadContainer(toParams.containerId);\n    });\n\n    $alertProvider.addMessagePattern('success.restore', 'Well done! Action completed successfully.');\n\n    $alertProvider.addMessagePattern('container.create', 'Container has been created successfully.');\n\n    $alertProvider.addMessagePattern('container.error', 'Sorry, something went wrong.');\n\n    $alertProvider.addMessagePattern('success.publish', 'Container has been published! Changes are now live!');\n\n    $alertProvider.addMessagePattern('permissions.error', 'Permissions can not be changed.');\n}]).config(['$stateProvider', function ($stateProvider) {\n    $stateProvider.state('container', {\n        url: '/containers',\n        controller: MODULE_NAME + '.ManageController as view',\n        templateUrl: MODULE_DIR + '/views/manage.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: false,\n            permission: ['view']\n        }\n    }).state('containerCreate', {\n        url: '/containers-create',\n        controller: MODULE_NAME + '.CreateController as view',\n        templateUrl: MODULE_DIR + '/views/create.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: false,\n            permission: ['edit']\n        }\n    }).state('containerExplanation', {\n        url: '/containers-explanation/{containerId}',\n        controller: MODULE_NAME + '.ExplanationController as view',\n        templateUrl: MODULE_DIR + '/views/explanation.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: true,\n            permission: ['owner']\n        }\n    }).state('containerEdit', {\n        url: '/containers-edit/{containerId}',\n        controller: MODULE_NAME + '.EditController as view',\n        templateUrl: MODULE_DIR + '/views/options.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: true,\n            permission: ['edit']\n        }\n    });\n}]).controller(MODULE_NAME + '.ManageController', _ManageController2.default).controller(MODULE_NAME + '.CreateController', _CreateController2.default).controller(MODULE_NAME + '.EditController', _EditController2.default).controller(MODULE_NAME + '.ExplanationController', _ExplanationController2.default).controller(MODULE_NAME + '.PermissionsController', _PermissionsController2.default).controller(MODULE_NAME + '.PrivacyController', _PrivacyController2.default).service(MODULE_NAME + '.containerResource', _ContainerResource2.default).service(MODULE_NAME + '.permissionResource', _PermissionResource2.default).service(MODULE_NAME + '.paramConverter', _ParamConverter2.default).service(MODULE_NAME + '.currentContainer', _CurrentContainer2.default).service(MODULE_NAME + '.publishedStatus', _PublishedStatus2.default);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./controllers/CreateController.js\":43,\"./controllers/EditController.js\":44,\"./controllers/ExplanationController.js\":45,\"./controllers/ManageController.js\":46,\"./controllers/PermissionsController.js\":47,\"./controllers/PrivacyController.js\":48,\"./resource/ContainerResource.js\":51,\"./resource/PermissionResource.js\":52,\"./service/CurrentContainer.js\":53,\"./service/ParamConverter.js\":54,\"./service/PublishedStatus.js\":55}],57:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar PAGE_VIEW_TYPES = [{\n    value: 0,\n    name: 'Page view'\n}, {\n    value: 1,\n    name: 'DOM ready'\n}, {\n    value: 2,\n    name: 'Page load'\n}],\n    NOT_VISIBLE_TRIGGER_TYPES = ['Page Load', 'DOM Ready'];\n\n/**\n * @name BaseController\n */\n\nvar BaseController = function () {\n    function BaseController($scope, $triggerResource, $conditionResource, $stateParams, $state, $alert, CurrentContainer, $condition, $PageInfo, $translate) {\n        var _this = this;\n\n        _classCallCheck(this, BaseController);\n\n        var BREADCRUMB_GLOBAL = 'Triggers';\n\n        this.required = undefined;\n        this.variables = undefined;\n        this.actions = undefined;\n\n        this.triggerPromise = undefined;\n\n        this.triggerResource = $triggerResource;\n        this.conditionResource = $conditionResource;\n\n        this.scope = $scope;\n        this.stateParams = $stateParams;\n        this.state = $state;\n        this.alert = $alert;\n        this.currentContainer = CurrentContainer;\n        this.Condition = $condition;\n        this.PageInfo = $PageInfo;\n\n        this.typesArrayPromise = $condition.getArrayOfTypes().then(filterVisibleTriggerTypes);\n\n        this.trigger = $triggerResource.getEntityObject();\n        this.condition = $conditionResource.getEntityObject();\n        this.translate = $translate;\n\n        $scope.$on('pageInfo.reload', function (event, args) {\n            _this.translate([_this.getBreadcrumbText(), BREADCRUMB_GLOBAL]).then(function (translations) {\n                $PageInfo.clear().add(args.name, 'tags', {\n                    containerId: args.id\n                }).add(translations[BREADCRUMB_GLOBAL], 'triggers', {\n                    containerId: args.id\n                }).add(translations[_this.getBreadcrumbText()]).broadcast();\n            });\n        });\n\n        this.pageViewTriggerTypes = PAGE_VIEW_TYPES;\n\n        function filterVisibleTriggerTypes(types) {\n            return types.filter(function (type) {\n                return NOT_VISIBLE_TRIGGER_TYPES.indexOf(type) === -1;\n            });\n        }\n    }\n\n    _createClass(BaseController, [{\n        key: 'setType',\n        value: function setType(type) {\n            var _this2 = this;\n\n            if (this.typesArray[type] !== undefined) {\n                this.trigger.type = type;\n                this.trigger.conditions = [];\n\n                this.Condition.getVariables(type).then(function (resp) {\n                    _this2.variables = resp;\n                });\n                this.Condition.getActions(type).then(function (resp) {\n                    _this2.actions = resp;\n                });\n                this.Condition.getRequired(type).then(function (resp) {\n                    _this2.required = resp;\n                    var requiredIndex = _this2.required.length;\n\n                    while (requiredIndex--) {\n                        _this2.trigger.conditions.push({\n                            variable: _this2.required[requiredIndex].name,\n                            condition: _this2.actions[0].type,\n                            value: ''\n                        });\n                    }\n                });\n            } else {\n                throw new Error('Invalid type');\n            }\n        }\n    }, {\n        key: 'addCondition',\n        value: function addCondition() {\n            this.condition = this.conditionResource.getEntityObject();\n\n            this.condition.variable = this.variables[0].name;\n            this.condition.condition = this.actions[0].type;\n\n            this.trigger.addCondition(this.condition);\n        }\n    }, {\n        key: 'validateTrigger',\n        value: function validateTrigger(form) {\n            this.scope[form.$name].$setPristine();\n\n            var conditionLength = this.trigger.conditions.length;\n\n            if (this.scope[form.$name].name.$valid) {\n                if (conditionLength !== 0) {\n                    while (conditionLength--) {\n                        /* eslint-disable */\n                        if (this.scope[form.$name]['conditionValue[' + conditionLength + ']'].$invalid) {\n                            return false;\n                        }\n                        /* eslint-enable */\n                    }\n                }\n\n                return true;\n            } else {\n                return false;\n            }\n        }\n    }, {\n        key: 'isTypeRequired',\n        value: function isTypeRequired(variable) {\n            return this.required !== undefined && this.required.map(function (element) {\n                return element.name;\n            }).indexOf(variable) !== -1;\n        }\n    }, {\n        key: 'getVariableName',\n        value: function getVariableName(variable) {\n            var variablesIndex = this.variables.map(function (element) {\n                return element.name;\n            }).indexOf(variable);\n\n            if (variablesIndex === -1) {\n                variablesIndex = this.required.map(function (element) {\n                    return element.name;\n                }).indexOf(variable);\n\n                return variablesIndex !== -1 ? this.required[variablesIndex].name : false;\n            }\n\n            return this.variables[variablesIndex].name;\n        }\n    }, {\n        key: 'getConditionName',\n        value: function getConditionName(conditionName) {\n            var conditionsIndex = this.actions.map(function (element) {\n                return element.name;\n            }).indexOf(conditionName);\n\n            return conditionsIndex !== -1 ? this.actions[conditionsIndex].name : false;\n        }\n    }, {\n        key: 'leaveFormInsideTag',\n        value: function leaveFormInsideTag() {\n            var _this3 = this;\n\n            this.translate([this.getBreadcrumbText()]).then(function (translations) {\n                _this3.PageInfo.clear().add(_this3.currentContainer.$container.name, 'tags', {\n                    containerId: _this3.currentContainer.$container.id\n                }).add(translations[_this3.getBreadcrumbText()]).broadcast();\n            });\n\n            return false;\n        }\n    }, {\n        key: 'showFormForSynchronousTrigger',\n        value: function showFormForSynchronousTrigger() {\n            var isEmbededInsideSynchronousTagForm = this.scope.tagTemplateTab === 'sync';\n            return this.trigger.isAddedToSynchronousTag || isEmbededInsideSynchronousTagForm;\n        }\n    }, {\n        key: 'submitForm',\n        value: function submitForm(trigger) {\n            var _this4 = this;\n\n            this.triggerPromise = trigger.save(this.stateParams.containerId);\n\n            this.triggerPromise.then(function () {\n                _this4.currentContainer.makeChanges();\n                _this4.alert.success(_this4.getAlertType());\n\n                _this4.state.go('triggers', {\n                    containerId: _this4.stateParams.containerId\n                });\n            }, function () {\n                _this4.alert.error('error.invalid');\n            });\n        }\n    }, {\n        key: 'displayInvalidFormMessage',\n        value: function displayInvalidFormMessage(view) {\n            view.validateTriggers = true;\n            this.alert.error('error.invalid');\n        }\n    }]);\n\n    return BaseController;\n}();\n\nexports.default = BaseController;\n\n},{}],58:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _BaseController2 = require('./BaseController.js');\n\nvar _BaseController3 = _interopRequireDefault(_BaseController2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar BREADCRUMB_GLOBAL = 'Triggers';\n\n/**\n * @name CreateController\n */\n\nvar CreateController = function (_BaseController) {\n    _inherits(CreateController, _BaseController);\n\n    function CreateController($scope, $triggerResource, $conditionResource, $stateParams, $state, $alert, CurrentContainer, $condition, PageInfo, $translate) {\n        _classCallCheck(this, CreateController);\n\n        var _this = _possibleConstructorReturn(this, (CreateController.__proto__ || Object.getPrototypeOf(CreateController)).call(this, $scope, $triggerResource, $conditionResource, $stateParams, $state, $alert, CurrentContainer, $condition, PageInfo, $translate));\n\n        _this.typesArrayPromise.then(function (resp) {\n            _this.typesArray = resp;\n            _this.setType(0);\n        });\n\n        CurrentContainer.getContainer().then(function () {\n            if (!CurrentContainer.$container.hasPermission('edit')) {\n                $state.go('triggers', { containerId: $stateParams.containerId });\n            }\n\n            _this.translate([_this.getBreadcrumbText(), BREADCRUMB_GLOBAL]).then(function (translations) {\n                PageInfo.clear().add(CurrentContainer.$container.name, 'tags', {\n                    containerId: CurrentContainer.$container.id\n                }).add(translations[BREADCRUMB_GLOBAL], 'triggers', {\n                    containerId: CurrentContainer.$container.id\n                }).add(translations[_this.getBreadcrumbText()]).broadcast();\n            });\n        });\n        return _this;\n    }\n\n    _createClass(CreateController, [{\n        key: 'getBreadcrumbText',\n        value: function getBreadcrumbText() {\n            return 'Add a new trigger';\n        }\n    }, {\n        key: 'getAlertType',\n        value: function getAlertType() {\n            return 'success.create';\n        }\n    }, {\n        key: 'addTrigger',\n        value: function addTrigger(form, trigger) {\n            var _this2 = this;\n\n            this.triggerPromise = trigger.save(this.stateParams.containerId);\n\n            this.triggerPromise.then(function (resp) {\n                _this2.scope[form.$name].$setPristine();\n                _this2.trigger = _this2.triggerResource.getEntityObject();\n                _this2.scope.$emit('trigger.add', resp);\n            }, function () {});\n        }\n    }]);\n\n    return CreateController;\n}(_BaseController3.default);\n\nexports.default = CreateController;\n\n},{\"./BaseController.js\":57}],59:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _BaseController2 = require('./BaseController.js');\n\nvar _BaseController3 = _interopRequireDefault(_BaseController2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar BREADCRUMB_GLOBAL = 'Triggers';\n\n/**\n * @name EditController\n */\n\nvar EditController = function (_BaseController) {\n    _inherits(EditController, _BaseController);\n\n    function EditController($scope, $triggerResource, $conditionResource, $stateParams, $state, $alert, CurrentContainer, $condition, PageInfo, $translate) {\n        _classCallCheck(this, EditController);\n\n        var _this = _possibleConstructorReturn(this, (EditController.__proto__ || Object.getPrototypeOf(EditController)).call(this, $scope, $triggerResource, $conditionResource, $stateParams, $state, $alert, CurrentContainer, $condition, PageInfo, $translate));\n\n        _this.triggerPromise = $triggerResource.get($stateParams.triggerId);\n\n        _this.triggerPromise.then(function (triggerResp) {\n            _this.trigger = triggerResp;\n\n            _this.typesArrayPromise.then(function (typesResp) {\n                _this.typesArray = typesResp;\n\n                _this.Condition.getVariables(_this.trigger.type).then(function (resp) {\n                    _this.variables = resp;\n                });\n                _this.Condition.getActions(_this.trigger.type).then(function (resp) {\n                    _this.actions = resp;\n                });\n                _this.Condition.getRequired(_this.trigger.type).then(function (resp) {\n                    _this.required = resp;\n                });\n            });\n        });\n\n        _this.currentContainer.getContainer().then(function () {\n            if (_this.currentContainer.$container.hasPermission('noaccess')) {\n                _this.state.go('container');\n            }\n\n            _this.translate([_this.getBreadcrumbText(), BREADCRUMB_GLOBAL]).then(function (translations) {\n                PageInfo.clear().add(_this.currentContainer.$container.name, 'tags', {\n                    containerId: _this.currentContainer.$container.id\n                }).add(translations[BREADCRUMB_GLOBAL], 'triggers', {\n                    containerId: _this.currentContainer.$container.id\n                }).add(translations[_this.getBreadcrumbText()]).broadcast();\n            });\n        });\n        return _this;\n    }\n\n    _createClass(EditController, [{\n        key: 'getBreadcrumbText',\n        value: function getBreadcrumbText() {\n            return 'Configure trigger';\n        }\n    }, {\n        key: 'getAlertType',\n        value: function getAlertType() {\n            return 'success.edit';\n        }\n    }]);\n\n    return EditController;\n}(_BaseController3.default);\n\nexports.default = EditController;\n\n},{\"./BaseController.js\":57}],60:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _BaseController2 = require('./BaseController.js');\n\nvar _BaseController3 = _interopRequireDefault(_BaseController2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n/**\n * @name EditController\n */\nvar EditController = function (_BaseController) {\n    _inherits(EditController, _BaseController);\n\n    function EditController($scope, $triggerResource, $conditionResource, $stateParams, $alert, CurrentContainer, $condition, PageInfo, $translate) {\n        _classCallCheck(this, EditController);\n\n        return _possibleConstructorReturn(this, (EditController.__proto__ || Object.getPrototypeOf(EditController)).call(this, $scope, $triggerResource, $conditionResource, $stateParams, null, $alert, CurrentContainer, $condition, PageInfo, $translate));\n    }\n\n    /**\n     * @desc Init trigger\n     * @param {number} triggerId\n     */\n\n\n    _createClass(EditController, [{\n        key: 'initTrigger',\n        value: function initTrigger(triggerId) {\n            var _this2 = this;\n\n            this.triggerPromise = this.triggerResource.get(triggerId);\n\n            this.triggerPromise.then(function (triggerResp) {\n                _this2.trigger = triggerResp;\n\n                _this2.typesArrayPromise.then(function (typesResp) {\n                    _this2.typesArray = typesResp;\n                    _this2.Condition.getVariables(_this2.trigger.type).then(function (resp) {\n                        _this2.variables = resp;\n                    });\n\n                    _this2.Condition.getActions(_this2.trigger.type).then(function (resp) {\n                        _this2.actions = resp;\n                    });\n\n                    _this2.Condition.getRequired(_this2.trigger.type).then(function (resp) {\n                        _this2.required = resp;\n                    });\n                });\n            });\n        }\n    }, {\n        key: 'getBreadcrumbText',\n        value: function getBreadcrumbText() {\n            return 'Configure trigger';\n        }\n    }, {\n        key: 'getAlertType',\n        value: function getAlertType() {\n            return 'success.edit';\n        }\n    }, {\n        key: 'submitForm',\n        value: function submitForm(trigger) {\n            var _this3 = this;\n\n            this.triggerPromise = trigger.save(this.stateParams.containerId);\n\n            this.triggerPromise.then(function (resp) {\n                _this3.currentContainer.makeChanges();\n                _this3.alert.success('trigger.edit');\n                _this3.scope.$emit('trigger.edit', resp);\n            }, function () {\n                _this3.alert.error('error.invalid');\n            });\n        }\n    }]);\n\n    return EditController;\n}(_BaseController3.default);\n\nexports.default = EditController;\n\n},{\"./BaseController.js\":57}],61:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar alert = void 0,\n    triggerResource = void 0,\n    stateParams = void 0,\n    currentContainer = void 0,\n    scope = void 0,\n    condition = void 0;\n\nvar BREADCRUMB_TEXT = 'Triggers';\n\n/**\n * @name ManageController\n */\n\nvar ManageController = function () {\n    function ManageController(TableParams, $stateParams, $triggerResource, $alert, $paramConverter, CurrentContainer, PageInfo, $scope, $condition, state, $translate) {\n        var _this = this;\n\n        _classCallCheck(this, ManageController);\n\n        alert = $alert;\n        stateParams = $stateParams;\n        triggerResource = $triggerResource;\n        currentContainer = CurrentContainer;\n        scope = $scope;\n        condition = $condition;\n\n        this.typesArrayPromise = condition.getArrayOfTypes();\n\n        this.typesArrayPromise.then(function (resp) {\n            _this.typesArray = resp;\n        });\n\n        this.translate = $translate;\n        this.containerId = stateParams.containerId;\n        this.tableParams = new TableParams({\n            page: 1,\n            count: 10,\n            sorting: {\n                name: 'asc'\n            }\n        }, {\n            total: 0,\n            getData: function getData($defer, params) {\n                triggerResource.query(stateParams.containerId, $paramConverter.list(params.url())).then(function (resp) {\n                    params.total(resp.total);\n                    $defer.resolve(resp.data);\n                });\n            }\n        });\n\n        currentContainer.getContainer().then(function () {\n            if (!currentContainer.$container.hasPermission('view')) {\n                state.go('container');\n            }\n\n            _this.translate([BREADCRUMB_TEXT]).then(function (translations) {\n                PageInfo.clear().add(currentContainer.$container.name, 'tags', {\n                    containerId: currentContainer.$container.id\n                }).add(translations[BREADCRUMB_TEXT]).broadcast();\n            });\n        });\n\n        scope.$on('pageInfo.reload', function (event, args) {\n            _this.translate([BREADCRUMB_TEXT]).then(function (translations) {\n                PageInfo.clear().add(args.name, 'tags', {\n                    containerId: args.id\n                }).add(translations[BREADCRUMB_TEXT]).broadcast();\n            });\n        });\n    }\n\n    _createClass(ManageController, [{\n        key: 'removeTrigger',\n        value: function removeTrigger(trigger) {\n            var _this2 = this;\n\n            trigger.remove().then(function () {\n                alert.success('success.remove');\n                currentContainer.makeChanges();\n\n                if (_this2.tableParams.data.length === 1 && _this2.tableParams.page() > 1) {\n                    _this2.tableParams.page(_this2.tableParams.page() - 1);\n                } else {\n                    _this2.tableParams.reload();\n                }\n            }, function () {\n                alert.error('error.remove');\n                _this2.tableParams.reload();\n            });\n        }\n    }]);\n\n    return ManageController;\n}();\n\nexports.default = ManageController;\n\n},{}],62:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar triggerFactory = function triggerFactory(resource) {\n    /**\n     * @name Trigger\n     * @description Trigger entity\n     */\n    var Trigger = function () {\n        function Trigger() {\n            _classCallCheck(this, Trigger);\n\n            /**\n             * @type {number}\n             */\n            this.id = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.name = undefined;\n\n            /**\n             * @type {Number}\n             */\n            this.type = 0;\n\n            /**\n             * @type {Number}\n             */\n            this.subtype = 0;\n\n            /**\n            * @type {Array}\n            */\n            this.conditions = [];\n\n            /**\n             * @type {number}\n             */\n            this.tagsCount = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.updatedAt = undefined;\n\n            /**\n             * @type {boolean}\n             */\n            this.isAddedToSynchronousTag = false;\n        }\n\n        _createClass(Trigger, [{\n            key: 'addCondition',\n            value: function addCondition(condition) {\n                this.conditions.push(condition);\n            }\n        }, {\n            key: 'removeCondition',\n            value: function removeCondition(index) {\n                this.conditions.splice(index, 1);\n            }\n        }, {\n            key: 'save',\n            value: function save(containerId) {\n                var result = {},\n                    promise = void 0,\n                    excludedProperty = ['id', 'updatedAt', 'createdAt', 'tagsCount', 'isAddedToSynchronousTag'];\n\n                for (var property in this) {\n                    if (!angular.isFunction(this[property]) && this.hasOwnProperty(property) && excludedProperty.indexOf(property) === -1) {\n                        if (property === 'conditions') {\n                            var collection = [];\n\n                            for (var index in this[property]) {\n                                if (this[property][index] instanceof Object) {\n                                    collection.push({\n                                        variable: this[property][index].variable,\n                                        condition: this[property][index].condition,\n                                        value: this[property][index].value\n                                    });\n                                }\n                            }\n\n                            result[property] = collection;\n                        } else {\n                            result[property] = this[property];\n                        }\n                    }\n                }\n\n                if (this.id === undefined) {\n                    promise = resource.post(containerId, result);\n                } else {\n                    promise = resource.put(this.id, result);\n                }\n\n                return promise;\n            }\n        }, {\n            key: 'remove',\n            value: function remove() {\n                if (this.id === undefined) {\n                    return false;\n                }\n\n                return resource.delete(this.id);\n            }\n        }]);\n\n        return Trigger;\n    }();\n\n    return Trigger;\n};\n\nexports.default = triggerFactory;\n\n},{}],63:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _Trigger = require('../entity/Trigger.js');\n\nvar _Trigger2 = _interopRequireDefault(_Trigger);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar PAGE_VIEW_TRIGGER_TYPE = 0,\n    DOM_READY_TRIGGER_TYPE = 4,\n    PAGE_LOAD_TRIGGER_TYPE = 5,\n    DOM_READY_SUBTYPE = 1,\n    PAGE_LOAD_SUBTYPE = 2;\n\nvar transformResponse = function transformResponse(resp) {\n    var Trigger = (0, _Trigger2.default)(this);\n\n    var trigger = new Trigger();\n\n    if (resp !== undefined) {\n        trigger.id = resp.id;\n        trigger.name = resp.name;\n        trigger.type = resp.type;\n        trigger.conditions = resp.conditions;\n        trigger.tagsCount = resp.tags_count;\n        trigger.updatedAt = resp.updated_at;\n        trigger.isAddedToSynchronousTag = resp.is_added_to_synchronous_tag;\n        addTriggerSubtypesInfo(trigger);\n    }\n\n    return trigger;\n};\n\nfunction addTriggerSubtypesInfo(trigger) {\n    if (trigger.type === DOM_READY_TRIGGER_TYPE) {\n        trigger.type = PAGE_VIEW_TRIGGER_TYPE;\n        trigger.subtype = DOM_READY_SUBTYPE;\n    }\n\n    if (trigger.type === PAGE_LOAD_TRIGGER_TYPE) {\n        trigger.type = PAGE_VIEW_TRIGGER_TYPE;\n        trigger.subtype = PAGE_LOAD_SUBTYPE;\n    }\n}\n\nvar transformRequest = function transformRequest(request) {\n    var Trigger = (0, _Trigger2.default)(this),\n        trigger = new Trigger();\n\n    if (request !== undefined) {\n        trigger.id = request.id;\n        trigger.name = request.name;\n        trigger.type = request.type;\n        trigger.conditions = request.conditions;\n        trigger.tagsCount = request.tags_count;\n        trigger.updatedAt = request.updated_at;\n\n        delete trigger.isAddedToSynchronousTag;\n        removeTriggerSubtypesInfo(trigger, request);\n    }\n\n    return trigger;\n};\n\nfunction removeTriggerSubtypesInfo(trigger, request) {\n    if (request.type === PAGE_VIEW_TRIGGER_TYPE && request.subtype === DOM_READY_SUBTYPE) {\n        trigger.type = DOM_READY_TRIGGER_TYPE;\n    }\n\n    if (request.type === PAGE_VIEW_TRIGGER_TYPE && request.subtype === PAGE_LOAD_SUBTYPE) {\n        trigger.type = PAGE_LOAD_TRIGGER_TYPE;\n    }\n\n    delete trigger.subtype;\n}\n\nvar appendTransform = function appendTransform(defaults, transform) {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name TriggerResource\n */\n\nvar TriggerResource = function () {\n    function TriggerResource($http, $q) {\n        _classCallCheck(this, TriggerResource);\n\n        this.http = $http;\n        this.q = $q;\n    }\n\n    _createClass(TriggerResource, [{\n        key: 'getEntityObject',\n        value: function getEntityObject() {\n            var Trigger = (0, _Trigger2.default)(this);\n\n            return new Trigger();\n        }\n    }, {\n        key: 'get',\n        value: function get(id) {\n            var _this = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: '/api/triggers/' + id,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (status < 400) {\n                        return transformResponse.call(_this, resp.data);\n                    } else {\n                        return resp;\n                    }\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'query',\n        value: function query(containerId, params) {\n            var _this2 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: '/api/containers/' + containerId + '/triggers',\n                params: params,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp) {\n                    for (var element in resp.data) {\n                        if (resp.data[element] instanceof Object) {\n                            resp.data[element] = transformResponse.call(_this2, resp.data[element]);\n                        }\n                    }\n\n                    return resp;\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'delete',\n        value: function _delete(id) {\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'DELETE',\n                url: '/api/triggers/' + id\n            }).success(function (data) {\n                deferred.resolve(data);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'post',\n        value: function post(containerId, entity) {\n            var _this3 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'POST',\n                url: '/api/containers/' + containerId + '/triggers',\n                data: entity,\n                transformRequest: appendTransform(transformRequest, this.http.defaults.transformRequest),\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (status < 400) {\n                        return transformResponse.call(_this3, resp.data);\n                    } else {\n                        return resp;\n                    }\n                })\n            }).success(function (data) {\n                deferred.resolve(data);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'put',\n        value: function put(id, entity) {\n            var _this4 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'PUT',\n                url: '/api/triggers/' + id,\n                data: entity,\n                transformRequest: appendTransform(transformRequest, this.http.defaults.transformRequest),\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (status < 400) {\n                        return transformResponse.call(_this4, resp.data);\n                    } else {\n                        return resp;\n                    }\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }]);\n\n    return TriggerResource;\n}();\n\nexports.default = TriggerResource;\n\n},{\"../entity/Trigger.js\":62}],64:[function(require,module,exports){\n'use strict';\n\nvar _CreateController = require('./controllers/CreateController.js');\n\nvar _CreateController2 = _interopRequireDefault(_CreateController);\n\nvar _EditController = require('./controllers/EditController.js');\n\nvar _EditController2 = _interopRequireDefault(_EditController);\n\nvar _ManageController = require('./controllers/ManageController.js');\n\nvar _ManageController2 = _interopRequireDefault(_ManageController);\n\nvar _EditInsideTagController = require('./controllers/EditInsideTagController.js');\n\nvar _EditInsideTagController2 = _interopRequireDefault(_EditInsideTagController);\n\nvar _TriggerResource = require('./resource/TriggerResource.js');\n\nvar _TriggerResource2 = _interopRequireDefault(_TriggerResource);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar MODULE_NAME = 'clearcode.tm.trigger'; /**\n                                           * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                           *\n                                           * This program is free software: you can redistribute it and/or modify it under\n                                           * the terms of the GNU Affero General Public License as published by the Free\n                                           * Software Foundation, either version 3 of the License, or (at your option) any\n                                           * later version.\n                                           *\n                                           * This program is distributed in the hope that it will be useful,\n                                           * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                           * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                           * GNU Affero General Public License for more details.\n                                           *\n                                           * You should have received a copy of the GNU Affero General Public License\n                                           * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                           */\n\nvar CONDITION_MODULE_NAME = 'clearcode.tm.condition';\nvar MODULE_DIR = '/app/modules/trigger';\n\n_ManageController2.default.$inject = ['ngTableParams', '$stateParams', MODULE_NAME + '.triggerResource', 'clearcode.tm.alert.alert', 'clearcode.tm.tagContainer.paramConverter', 'clearcode.tm.tagContainer.currentContainer', 'clearcode.tm.pageInfo.pageInfo', '$scope', 'clearcode.tm.condition.condition', '$state', '$translate'];\n\n_CreateController2.default.$inject = ['$scope', MODULE_NAME + '.triggerResource', CONDITION_MODULE_NAME + '.conditionResource', '$stateParams', '$state', 'clearcode.tm.alert.alert', 'clearcode.tm.tagContainer.currentContainer', 'clearcode.tm.condition.condition', 'clearcode.tm.pageInfo.pageInfo', '$translate'];\n\n_EditController2.default.$inject = ['$scope', MODULE_NAME + '.triggerResource', CONDITION_MODULE_NAME + '.conditionResource', '$stateParams', '$state', 'clearcode.tm.alert.alert', 'clearcode.tm.tagContainer.currentContainer', 'clearcode.tm.condition.condition', 'clearcode.tm.pageInfo.pageInfo', '$translate'];\n\n_EditInsideTagController2.default.$inject = ['$scope', MODULE_NAME + '.triggerResource', CONDITION_MODULE_NAME + '.conditionResource', '$stateParams', 'clearcode.tm.alert.alert', 'clearcode.tm.tagContainer.currentContainer', 'clearcode.tm.condition.condition', 'clearcode.tm.pageInfo.pageInfo', '$translate'];\n\n_TriggerResource2.default.$inject = ['$http', '$q'];\n\nangular.module(MODULE_NAME, ['pascalprecht.translate', 'ui.router', 'ngTable', 'clearcode.tm.alert', 'clearcode.tm.pageInfo', 'clearcode.tm.tagContainer', 'clearcode.tm.condition']).config(['$stateProvider', function ($stateProvider) {\n    $stateProvider.state('triggers', {\n        url: '/containers/{containerId}/triggers',\n        controller: MODULE_NAME + '.ManageController as view',\n        templateUrl: MODULE_DIR + '/views/manage.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: true\n        }\n    }).state('triggerCreate', {\n        url: '/containers/{containerId}/trigger-create',\n        controller: MODULE_NAME + '.CreateController as triggerForm',\n        templateUrl: MODULE_DIR + '/views/create.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: true\n        }\n    }).state('triggerEdit', {\n        url: '/containers/{containerId}/trigger/edit/{triggerId}',\n        controller: MODULE_NAME + '.EditController as triggerForm',\n        templateUrl: MODULE_DIR + '/views/edit.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: true\n        }\n    });\n}]).run(['clearcode.tm.alert.$alert', function ($alertProvider) {\n    $alertProvider.addMessagePattern('trigger.create', 'Trigger has been created successfully.');\n    $alertProvider.addMessagePattern('trigger.edit', 'Trigger has been updated successfully.');\n}]).controller(MODULE_NAME + '.CreateController', _CreateController2.default).controller(MODULE_NAME + '.EditController', _EditController2.default).controller(MODULE_NAME + '.ManageController', _ManageController2.default).controller(MODULE_NAME + '.EditInsideTagController', _EditInsideTagController2.default).service(MODULE_NAME + '.triggerResource', _TriggerResource2.default);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./controllers/CreateController.js\":58,\"./controllers/EditController.js\":59,\"./controllers/EditInsideTagController.js\":60,\"./controllers/ManageController.js\":61,\"./resource/TriggerResource.js\":63}],65:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar updateResource = void 0,\n    window = void 0;\n\n/**\n * @name update#VersionController\n */\n\nvar VersionController = function () {\n    function VersionController($updateResource, $window, version) {\n        _classCallCheck(this, VersionController);\n\n        updateResource = $updateResource;\n        window = $window;\n        this.version = version;\n    }\n\n    _createClass(VersionController, [{\n        key: \"updateAvailable\",\n        value: function updateAvailable() {\n            return this.version.latest !== undefined && !this.version.isUpToDate();\n        }\n    }, {\n        key: \"startUpdate\",\n        value: function startUpdate() {\n            updateResource.setSession().then(function (resp) {\n                window.location.href = resp.url;\n            });\n        }\n    }]);\n\n    return VersionController;\n}();\n\nexports.default = VersionController;\n\n},{}],66:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name SetVersionDirective\n */\n\nvar setVersionDirective = function setVersionDirective(version, updateResource) {\n    return {\n        restrict: 'A',\n        scope: {\n            stgVersion: '@'\n        },\n        link: function link(scope) {\n            version.current = scope.stgVersion;\n\n            if (version.latest === undefined) {\n                updateResource.getLatest(version.current).then(function (resp) {\n                    version.latest = resp.version;\n                });\n            }\n        }\n    };\n};\n\nexports.default = setVersionDirective;\n\n},{}],67:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name UpdateResource\n */\nvar UpdateResource = function () {\n    function UpdateResource($http, $q, $location) {\n        _classCallCheck(this, UpdateResource);\n\n        this.http = $http;\n        this.q = $q;\n        this.location = $location;\n    }\n\n    _createClass(UpdateResource, [{\n        key: 'setSession',\n        value: function setSession() {\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: 'admin-tools/update'\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'getLatest',\n        value: function getLatest(version) {\n            var deferred = this.q.defer();\n            var domain = this.location.host();\n\n            this.http({\n                method: 'GET',\n                url: '//download.impono.org/version.json',\n                params: {\n                    version: version,\n                    domain: domain\n                },\n                headers: {\n                    'Access-Control-Request-Headers': undefined\n                }\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }]);\n\n    return UpdateResource;\n}();\n\nexports.default = UpdateResource;\n\n},{}],68:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name update#Version\n */\n\nvar Version = function () {\n    function Version() {\n        _classCallCheck(this, Version);\n\n        this.current = undefined;\n        this.latest = undefined;\n    }\n\n    _createClass(Version, [{\n        key: \"isUpToDate\",\n        value: function isUpToDate() {\n            return this.current !== undefined && this.current === this.latest;\n        }\n    }]);\n\n    return Version;\n}();\n\nexports.default = Version;\n\n},{}],69:[function(require,module,exports){\n'use strict';\n\nvar _VersionController = require('./controllers/VersionController.js');\n\nvar _VersionController2 = _interopRequireDefault(_VersionController);\n\nvar _UpdateResource = require('./resources/UpdateResource.js');\n\nvar _UpdateResource2 = _interopRequireDefault(_UpdateResource);\n\nvar _Version = require('./services/Version.js');\n\nvar _Version2 = _interopRequireDefault(_Version);\n\nvar _setVersionDirective = require('./directives/setVersionDirective.js');\n\nvar _setVersionDirective2 = _interopRequireDefault(_setVersionDirective);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar MODULE_NAME = 'clearcode.tm.update';\n\n_VersionController2.default.$inject = [MODULE_NAME + '.updateResource', '$window', MODULE_NAME + '.version'];\n\n_UpdateResource2.default.$inject = ['$http', '$q', '$location'];\n\n_setVersionDirective2.default.$inject = [MODULE_NAME + '.version', 'clearcode.tm.update.updateResource'];\n\n_Version2.default.$inject = ['$rootScope'];\n\nangular.module(MODULE_NAME, []).controller(MODULE_NAME + '.VersionController', _VersionController2.default).service(MODULE_NAME + '.updateResource', _UpdateResource2.default).service(MODULE_NAME + '.version', _Version2.default).directive('stgSetVersion', _setVersionDirective2.default);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./controllers/VersionController.js\":65,\"./directives/setVersionDirective.js\":66,\"./resources/UpdateResource.js\":67,\"./services/Version.js\":68}],70:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar BREADCRUMB_SECTION = 'My account';\n\n/**\n * @name BaseController\n */\n\nvar BaseController = function () {\n    function BaseController(userResource, alert, PageInfo, state, $translate, refreshAlert) {\n        _classCallCheck(this, BaseController);\n\n        this.ACTIVATION_SET_PASSWORD = 'ACTIVATION_SET_PASSWORD';\n        this.ROLE_API = 'ROLE_API';\n        this.ROLE_USER = 'ROLE_USER';\n        this.ROLE_SUPER_ADMIN = 'ROLE_SUPER_ADMIN';\n        this.ROLE_CONTAINERS_CREATE = 'ROLE_CONTAINERS_CREATE';\n\n        this.alert = alert;\n        this.state = state;\n        this.userResource = userResource;\n        this.userPromise = undefined;\n        this.user = userResource.getEntity();\n\n        $translate([BREADCRUMB_SECTION]).then(function (translations) {\n            PageInfo.clear().add(translations[BREADCRUMB_SECTION]).broadcast();\n        });\n\n        refreshAlert.success('LANGUAGE_CHANGE_MESSAGE', 'user.change_language');\n    }\n\n    _createClass(BaseController, [{\n        key: 'displayRoleSectionForUser',\n        value: function displayRoleSectionForUser() {\n            return !this.state.includes('editProfile');\n        }\n    }, {\n        key: 'displayPasswordSection',\n        value: function displayPasswordSection() {\n            if (!this.activation) {\n                return false;\n            }\n\n            return this.activation === this.ACTIVATION_SET_PASSWORD;\n        }\n    }, {\n        key: 'setUser',\n        value: function setUser(id) {\n            var _this = this;\n\n            if (this.state.includes('editProfile')) {\n                this.userPromise = this.userResource.getMe();\n            } else {\n                this.role = undefined;\n                this.createContainerRole = undefined;\n                this.userPromise = this.userResource.get(id);\n            }\n\n            this.userPromise.then(function (resp) {\n                _this.user = resp;\n                _this.role = _this.getUserRole();\n                _this.createContainerRole = _this.user.roles.indexOf(_this.ROLE_CONTAINERS_CREATE) !== -1;\n            });\n        }\n    }, {\n        key: 'getUserRole',\n        value: function getUserRole() {\n            if (this.user.hasRole(this.ROLE_SUPER_ADMIN)) {\n                return this.ROLE_SUPER_ADMIN;\n            }\n\n            if (this.user.hasRole(this.ROLE_API)) {\n                return this.ROLE_API;\n            }\n\n            return this.ROLE_USER;\n        }\n    }, {\n        key: 'setRole',\n        value: function setRole(role) {\n            var roleIndex = this.user.roles.indexOf(role);\n\n            if (roleIndex !== -1) {\n                this.user.roles.splice(roleIndex, 1);\n\n                return false;\n            } else {\n                this.user.roles.push(role);\n\n                return true;\n            }\n        }\n    }, {\n        key: 'submitForm',\n        value: function submitForm(user) {\n            var _this2 = this;\n\n            if (this.state.includes('editProfile')) {\n                this.userPromise = user.saveMe();\n            } else {\n                user.roles = [this.role];\n\n                if (this.role === this.ROLE_USER && this.createContainerRole) {\n                    user.roles.push(this.ROLE_CONTAINERS_CREATE);\n                }\n\n                this.userPromise = user.save();\n            }\n\n            this.userPromise.then(function () {\n                _this2.alert.success('user.save');\n\n                if (!_this2.state.includes('editProfile')) {\n                    _this2.state.go('users');\n                }\n            }, function () {\n                _this2.alert.error('user.invalid');\n            });\n        }\n    }, {\n        key: 'displayInvalidFormMessage',\n        value: function displayInvalidFormMessage() {\n            this.alert.error('error.invalid');\n        }\n    }]);\n\n    return BaseController;\n}();\n\nexports.default = BaseController;\n\n},{}],71:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar BREADCRUMB_SECTION = 'My account';\n\nvar userResource = void 0;\nvar alert = void 0;\nvar state = void 0;\nvar scope = void 0;\nvar translate = void 0;\n\nvar ChangePasswordController = function () {\n    function ChangePasswordController($userResource, $alert, $state, PageInfo, $scope, $translate) {\n        _classCallCheck(this, ChangePasswordController);\n\n        userResource = $userResource;\n        alert = $alert;\n        state = $state;\n        scope = $scope;\n        translate = $translate;\n        this.validationForce = false;\n        this.changePasswordPromise = undefined;\n        this.translate = $translate;\n        this.currentPassword = '';\n        this.plainPassword = {\n            first: '',\n            second: ''\n        };\n\n        translate([BREADCRUMB_SECTION]).then(function (translations) {\n            PageInfo.clear().add(translations[BREADCRUMB_SECTION]).broadcast();\n        });\n    }\n\n    _createClass(ChangePasswordController, [{\n        key: 'submitForm',\n        value: function submitForm(currentPassword, newPassword) {\n            var data = {\n                /* eslint-disable */\n                current_password: currentPassword,\n                /* eslint-enable */\n                plainPassword: newPassword\n            };\n\n            this.changePasswordPromise = userResource.changePassword(data);\n\n            this.changePasswordPromise.then(function () {\n                alert.success('password.change');\n                state.go('container');\n            }, function () {\n                alert.error('error.invalid');\n            });\n        }\n    }, {\n        key: 'displayInvalidFormMessage',\n        value: function displayInvalidFormMessage(newPassword) {\n            this.validationForce = true;\n\n            if (newPassword.first !== newPassword.second) {\n                scope.changePasswordForm.first.$invalid = true;\n                scope.changePasswordForm.second.$invalid = true;\n\n                translate(['Passwords have to be identical']).then(function (translations) {\n                    scope.changePasswordForm.first.$error.first = [translations['Passwords have to be identical']];\n                });\n\n                scope.changePasswordForm.second.$error.second = [];\n                alert.error('error.invalid');\n            } else if (newPassword.first === undefined || newPassword.second === undefined) {\n                alert.error('password.both');\n            } else {\n                alert.error('error.invalid');\n            }\n        }\n    }]);\n\n    return ChangePasswordController;\n}();\n\nexports.default = ChangePasswordController;\n\n},{}],72:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _BaseController2 = require('./BaseController.js');\n\nvar _BaseController3 = _interopRequireDefault(_BaseController2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n/**\n * @type {String}\n */\nvar BREADCRUMB_TEXT = 'Add a user';\n\n/**\n * @type {String}\n */\nvar BREADCRUMB_GLOBAL = 'Users';\n/**\n * @type {String}\n */\nvar ACTIVATION_EMAIL = 'ACTIVATION_EMAIL';\n\n/**\n * @type {String}\n */\nvar ACTIVATION_SET_PASSWORD = 'ACTIVATION_SET_PASSWORD';\n\n/**\n * @type {String}\n */\nvar ROLE_USER = 'ROLE_USER';\n\nvar scope = void 0;\nvar translate = void 0;\n\n/**\n * @name CreateController\n */\n\nvar CreateController = function (_BaseController) {\n    _inherits(CreateController, _BaseController);\n\n    /**\n     * @param {UserResource} userResource\n     * @param {Alert} alert\n     * @param {PageInfo} PageInfo\n     * @param {$state} state\n     * @param {$scope} $scope\n     * @param {$translate} $translate\n     * @param {RefreshAlert} RefreshAlert\n     */\n    function CreateController(userResource, alert, PageInfo, state, $scope, $translate, RefreshAlert) {\n        _classCallCheck(this, CreateController);\n\n        var _this = _possibleConstructorReturn(this, (CreateController.__proto__ || Object.getPrototypeOf(CreateController)).call(this, userResource, alert, PageInfo, state, $translate, RefreshAlert));\n\n        scope = $scope;\n        translate = $translate;\n\n        _this.activation = ACTIVATION_EMAIL;\n        _this.role = ROLE_USER;\n\n        _this.password = {\n            first: '',\n            second: ''\n        };\n\n        translate([BREADCRUMB_TEXT, BREADCRUMB_GLOBAL]).then(function (translations) {\n            PageInfo.clear().add(translations[BREADCRUMB_GLOBAL], 'users').add(translations[BREADCRUMB_TEXT]).broadcast();\n        });\n        return _this;\n    }\n\n    /**\n     * Display error if form is invalid\n     */\n\n\n    _createClass(CreateController, [{\n        key: 'createUserFormValidation',\n        value: function createUserFormValidation() {\n            var isValid = false;\n\n            scope.createUserForm.first.$dirty = true;\n            scope.createUserForm.second.$dirty = true;\n\n            if (this.password.first !== this.password.second) {\n                scope.createUserForm.first.$invalid = true;\n                scope.createUserForm.second.$invalid = true;\n\n                translate(['Passwords have to be identical']).then(function (translations) {\n                    scope.createUserForm.first.$error.first = [translations['Passwords have to be identical']];\n                });\n\n                scope.createUserForm.second.$error.second = [];\n                isValid = false;\n            } else if (this.password.first.length < 8 || this.password.second.length < 8) {\n                scope.createUserForm.first.$invalid = true;\n                scope.createUserForm.second.$invalid = true;\n\n                translate(['Password needs to have minimum 8 characters']).then(function (translations) {\n                    scope.createUserForm.first.$error.first = [translations['Password needs to have minimum 8 characters']];\n                });\n\n                scope.createUserForm.second.$error.second = [];\n\n                isValid = false;\n            } else if (this.activation === ACTIVATION_SET_PASSWORD) {\n                isValid = true;\n            }\n\n            if (!scope.createUserForm.$valid) {\n                isValid = false;\n            }\n\n            if (scope.createUserForm.$valid && this.activation === ACTIVATION_EMAIL) {\n                isValid = true;\n            }\n\n            if (!isValid) {\n                this.alert.error('user.invalid');\n            }\n\n            return isValid;\n        }\n    }, {\n        key: 'submitForm',\n        value: function submitForm(user) {\n            var _this2 = this;\n\n            user.roles = [this.role];\n\n            if (this.role === this.ROLE_USER && this.createContainerRole) {\n                user.roles.push(this.ROLE_CONTAINERS_CREATE);\n            }\n\n            if (this.activation === ACTIVATION_SET_PASSWORD) {\n                user.plainPassword = this.password;\n            }\n\n            this.userPromise = user.save();\n\n            this.userPromise.then(function () {\n                _this2.alert.success('user.save');\n                _this2.state.go('users');\n            }, function () {\n                _this2.alert.error('user.invalid');\n            });\n        }\n    }]);\n\n    return CreateController;\n}(_BaseController3.default);\n\nexports.default = CreateController;\n\n},{\"./BaseController.js\":70}],73:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _BaseController2 = require('./BaseController.js');\n\nvar _BaseController3 = _interopRequireDefault(_BaseController2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n/**\n * @type {String}\n */\nvar BREADCRUMB_TEXT = 'Edit user';\n\n/**\n * @type {String}\n */\nvar BREADCRUMB_GLOBAL = 'Users';\n\nvar scope = void 0;\nvar state = void 0;\nvar translate = void 0;\n\n/**\n * @name EditController\n */\n\nvar EditController = function (_BaseController) {\n    _inherits(EditController, _BaseController);\n\n    /**\n     * @param {UserResource} userResource\n     * @param {stateParams} stateParams\n     * @param {Alert} alert\n     * @param {PageInfo} PageInfo\n     * @param {$state} $state\n     * @param {$scope} $scope\n     * @param {$translate} $translate\n     * @param {refreshAlert} refreshAlert\n     * @param {security} security\n     */\n    function EditController(userResource, stateParams, alert, PageInfo, $state, $scope, $translate, refreshAlert, security) {\n        _classCallCheck(this, EditController);\n\n        var _this = _possibleConstructorReturn(this, (EditController.__proto__ || Object.getPrototypeOf(EditController)).call(this, userResource, alert, PageInfo, $state, $translate, refreshAlert));\n\n        scope = $scope;\n        state = $state;\n        translate = $translate;\n        _this.security = security;\n\n        if (state.includes('editProfile')) {\n            _this.setUser();\n        } else {\n            _this.activation = _this.ACTIVATION_SET_PASSWORD;\n\n            _this.password = {\n                first: '',\n                second: ''\n            };\n\n            _this.setUser(stateParams.userId);\n\n            translate([BREADCRUMB_TEXT, BREADCRUMB_GLOBAL]).then(function (translations) {\n                PageInfo.clear().add(translations[BREADCRUMB_GLOBAL], 'users').add(translations[BREADCRUMB_TEXT]).broadcast();\n            });\n        }\n        return _this;\n    }\n\n    /**\n     * Display error if form is invalid\n     */\n\n\n    _createClass(EditController, [{\n        key: 'editUserFormValidation',\n        value: function editUserFormValidation() {\n            scope.editUserForm.first.$dirty = true;\n            scope.editUserForm.second.$dirty = true;\n\n            if (this.password.first === '' && this.password.second === '') {\n                return true;\n            }\n\n            if (this.password.first !== this.password.second) {\n                scope.editUserForm.first.$invalid = true;\n                scope.editUserForm.second.$invalid = true;\n\n                translate(['Passwords have to be identical']).then(function (translations) {\n                    scope.editUserForm.first.$error.first = [translations['Passwords have to be identical']];\n                });\n\n                scope.editUserForm.second.$error.second = [];\n\n                return false;\n            } else if (this.password.first.length < 8 || this.password.second.length < 8) {\n                scope.editUserForm.first.$invalid = true;\n                scope.editUserForm.second.$invalid = true;\n\n                translate(['Password needs to have minimum 8 characters']).then(function (translations) {\n                    scope.editUserForm.first.$error.first = [translations['Password needs to have minimum 8 characters']];\n                });\n\n                scope.editUserForm.second.$error.second = [];\n\n                return false;\n            }\n\n            return scope.editUserForm.$valid;\n        }\n    }, {\n        key: 'submitForm',\n        value: function submitForm(user) {\n            var _this2 = this;\n\n            user.roles = [this.role];\n\n            if (this.role === this.ROLE_USER && this.createContainerRole) {\n                user.roles.push(this.ROLE_CONTAINERS_CREATE);\n            }\n\n            if (this.hasOwnProperty('password')) {\n                if (this.password.first !== '') {\n                    user.plainPassword = this.password;\n                }\n            }\n\n            if (state.includes('editProfile')) {\n                this.userPromise = user.saveMe();\n            } else {\n                this.userPromise = user.save();\n            }\n\n            this.userPromise.then(function () {\n                _this2.security.getUser(true);\n                _this2.alert.success('user.save');\n\n                if (!state.includes('editProfile')) {\n                    state.go('users');\n                }\n            }, function () {\n                _this2.alert.error('user.invalid');\n            });\n        }\n    }]);\n\n    return EditController;\n}(_BaseController3.default);\n\nexports.default = EditController;\n\n},{\"./BaseController.js\":70}],74:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar $alert = void 0,\n    $userResource = void 0;\n\nvar BREADCRUMB_TEXT = 'Users';\n\n/**\n * @name ManageController\n */\n\nvar ManageController = function () {\n    function ManageController(TableParams, userResource, alert, paramConverter, currentContainer, PageInfo, $translate) {\n        _classCallCheck(this, ManageController);\n\n        this.translate = $translate;\n        $alert = alert;\n        $userResource = userResource;\n\n        currentContainer.disableDebugMode();\n\n        this.tableParams = new TableParams({\n            page: 1,\n            count: 10,\n            sorting: {\n                name: 'asc'\n            }\n        }, {\n            total: 0,\n            getData: function getData($defer, params) {\n                userResource.query(paramConverter.list(params.url())).then(function (resp) {\n                    params.total(resp.total);\n                    $defer.resolve(resp.data);\n                });\n            }\n        });\n\n        this.translate([BREADCRUMB_TEXT]).then(function (translations) {\n            PageInfo.clear().add(translations[BREADCRUMB_TEXT]).broadcast();\n        });\n    }\n\n    _createClass(ManageController, [{\n        key: 'removeUser',\n        value: function removeUser(user) {\n            var _this = this;\n\n            user.remove().then(function () {\n                $alert.success('success.remove');\n\n                if (_this.tableParams.data.length === 1) {\n                    _this.tableParams.page(_this.tableParams.page() - 1);\n                }\n\n                _this.tableParams.reload();\n            }, function () {\n                $alert.error('error.remove');\n                _this.tableParams.reload();\n            });\n        }\n    }, {\n        key: 'resetPassword',\n        value: function resetPassword(user) {\n            var _this2 = this;\n\n            var data = {\n                username: user.email\n            };\n\n            this.resetPromise = $userResource.resetPassword(data);\n\n            this.resetPromise.then(function () {\n                $alert.success('user.reset');\n                _this2.tableParams.reload();\n            });\n        }\n    }]);\n\n    return ManageController;\n}();\n\nexports.default = ManageController;\n\n},{}],75:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @type {Alert}\n */\nvar alert;\n\n/**\n * @type {string}\n */\nvar BREADCRUMB_SECTION = 'My account';\n\n/**\n * @type {Translation}\n */\nvar translation;\n\nvar OthersSettingsController = function () {\n    function OthersSettingsController($alert, $scope, $translate, $translation, $window, PageInfo) {\n        var _this = this;\n\n        _classCallCheck(this, OthersSettingsController);\n\n        alert = $alert;\n        this.scope = $scope;\n        translation = $translation;\n        this.validationForce = false;\n        this.translate = $translate;\n        this.window = $window;\n        this.languages = translation.getLanguages();\n\n        if (!this.languages.length) {\n            this.loadTranslationsPromise = translation.loadAvailableTranslations();\n\n            this.loadTranslationsPromise.then(function () {\n                _this.languages = translation.languages;\n            });\n        }\n\n        $translate([BREADCRUMB_SECTION]).then(function (translations) {\n            PageInfo.clear().add(translations[BREADCRUMB_SECTION]).broadcast();\n        });\n    }\n\n    /**\n     * @param {Object} user\n     */\n\n\n    _createClass(OthersSettingsController, [{\n        key: 'submitForm',\n        value: function submitForm(user) {\n            var _this2 = this;\n\n            var localStorageLang = this.window.localStorage['NG_TRANSLATE_LANG_KEY'];\n            var storedLanguage = localStorageLang ? localStorageLang : 'en';\n            this.othersSettingsPromise = user.saveOthersSettings();\n\n            this.othersSettingsPromise.then(function (User) {\n                _this2.translate.use(User.language).then(function () {\n                    if (User.language !== storedLanguage) {\n                        _this2.window.localStorage['LANGUAGE_CHANGE_MESSAGE'] = true;\n                        _this2.window.location.reload();\n                    } else {\n                        alert.success('user.save');\n                    }\n                });\n            }, function () {\n                alert.error('error.invalid');\n            });\n        }\n    }]);\n\n    return OthersSettingsController;\n}();\n\nexports.default = OthersSettingsController;\n\n},{}],76:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @type {UserResource}\n */\nvar userResource;\n\n/**\n * @type {AlertForm}\n */\nvar alertForm;\n\n/**\n * @type {String}\n */\nvar BREADCRUMB_TEXT = 'Forgot your password?';\n\n/**\n * @name security#ResetRequestController\n * @description Controller for sending request for new password\n */\n\nvar ResetRequestController = function () {\n    /**\n     * @param {UserResource} $userResource\n     * @param {AlertForm} $alertForm\n     * @param {Alert} $alert\n     * @param {PageInfo} PageInfo\n     * @param {$translate} $translate\n     */\n    function ResetRequestController($userResource, $alertForm, $alert, PageInfo, $translate) {\n        _classCallCheck(this, ResetRequestController);\n\n        this.email = '';\n        this.translate = $translate;\n        this.alert = $alert;\n        userResource = $userResource;\n\n        alertForm = $alertForm;\n        alertForm.getStorage().clean();\n\n        this.validationForce = false;\n\n        this.resetPromise = undefined;\n\n        this.success = false;\n\n        this.translate([BREADCRUMB_TEXT]).then(function (translations) {\n            PageInfo.clear().add(translations[BREADCRUMB_TEXT]).broadcast();\n        });\n    }\n\n    /**\n     *\n     * @param {String} email\n     */\n\n\n    _createClass(ResetRequestController, [{\n        key: 'submitForm',\n        value: function submitForm(email) {\n            var _this = this;\n\n            var data = {\n                username: email\n            };\n\n            this.resetPromise = userResource.resetPassword(data);\n\n            this.resetPromise.then(function () {\n                alertForm.getStorage().clean();\n                _this.success = true;\n\n                _this.translate(['The email with the activation link has been sent successfully.']).then(function (translations) {\n                    _this.formTitle = translations['The email with the activation link has been sent successfully.'];\n                });\n            }, function () {\n                alertForm.getStorage().clean();\n                alertForm.error('request.error');\n                _this.alert.error('error.invalid');\n            });\n        }\n\n        /**\n         * Display error if form is invalid\n         */\n\n    }, {\n        key: 'displayInvalidFormMessage',\n        value: function displayInvalidFormMessage() {\n            this.validationForce = true;\n            this.alert.error('error.invalid');\n            alertForm.getStorage().clean();\n            alertForm.error('invalid.email');\n        }\n    }]);\n\n    return ResetRequestController;\n}();\n\nexports.default = ResetRequestController;\n\n},{}],77:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @type {UserResource}\n */\nvar userResource;\n\n/**\n * @type {$state}\n */\nvar state;\n\n/**\n * @type {$stateParams}\n */\nvar stateParams;\n\n/**\n * @type {Alert}\n */\nvar alert;\n\n/**\n * @type {String}\n */\nvar BREADCRUMB_TEXT = 'Change your password';\n\n/**\n * @type {$scope}\n */\nvar scope;\n\n/**\n * @name security#ChangePasswordController\n * @description Controller for change password view\n */\n\nvar ChangePasswordController = function () {\n    /**\n     * @param {UserResource} $userResource\n     * @param {$state} $state\n     * @param {$stateParams} $stateParams\n     * @param {Alert} $alert\n     * @param {PageInfo} PageInfo\n     * @param {$scope} $scope\n     * @param {$translate} $translate\n     */\n    function ChangePasswordController($userResource, $state, $stateParams, $alert, PageInfo, $scope, $translate) {\n        _classCallCheck(this, ChangePasswordController);\n\n        this.new = {\n            first: undefined,\n            second: undefined\n        };\n\n        this.validationForce = false;\n        this.changePasswordPromise = undefined;\n        this.translate = $translate;\n\n        userResource = $userResource;\n        state = $state;\n        stateParams = $stateParams;\n        alert = $alert;\n        scope = $scope;\n\n        if (stateParams.token === '') {\n            state.go('signIn');\n            alert.error('changePassword.token');\n        }\n\n        this.translate([BREADCRUMB_TEXT]).then(function (translations) {\n            PageInfo.clear().add(translations[BREADCRUMB_TEXT]).broadcast();\n        });\n    }\n\n    /**\n     * @param {Object} newPassword\n     */\n\n\n    _createClass(ChangePasswordController, [{\n        key: 'submitForm',\n        value: function submitForm(newPassword) {\n            var password = {\n                plainPassword: newPassword\n            };\n\n            this.changePasswordPromise = userResource.setPassword(password, stateParams.token);\n\n            this.changePasswordPromise.then(function () {\n                state.go('signIn');\n                alert.success('changePassword.success');\n            }, function () {\n                alert.error('changePassword.error');\n            });\n        }\n\n        /**\n         * Display error if form is invalid\n         * @param {Object} newPassword\n         */\n\n    }, {\n        key: 'displayInvalidFormMessage',\n        value: function displayInvalidFormMessage(newPassword) {\n            this.validationForce = true;\n\n            if (newPassword.first !== newPassword.second) {\n                scope.resetPasswordForm.first.$invalid = true;\n                scope.resetPasswordForm.second.$invalid = true;\n\n                this.translate(['Passwords have to be identical']).then(function (translations) {\n                    scope.resetPasswordForm.first.$error.first = [translations['Passwords have to be identical']];\n                });\n\n                scope.resetPasswordForm.second.$error.second = [];\n            } else if (newPassword.first === undefined || newPassword.second === undefined) {\n                alert.error('password.both');\n            }\n        }\n    }]);\n\n    return ChangePasswordController;\n}();\n\nexports.default = ChangePasswordController;\n\n},{}],78:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar userFactory = function userFactory(resource) {\n    /**\n     * @name User\n     * @description User entity\n     */\n    var User = function () {\n        function User() {\n            _classCallCheck(this, User);\n\n            /**\n             * @type {number}\n             */\n            this.id = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.email = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.firstName = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.lastName = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.displayName = undefined;\n\n            /**\n             * @type {Array}\n             */\n            this.roles = [];\n\n            /**\n             * @type {Boolean}\n             */\n            this.status = false;\n\n            /**\n             * @type {Date}\n             */\n            this.createdAt = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.language = undefined;\n        }\n\n        _createClass(User, [{\n            key: 'hasRole',\n            value: function hasRole(role) {\n                return this.roles.indexOf(role) !== -1;\n            }\n        }, {\n            key: 'save',\n            value: function save() {\n                var result = {},\n                    promise = void 0,\n                    excludedProperty = ['id', 'displayName', 'status', 'createdAt', 'language'],\n                    excludedInEdit = ['email'];\n\n                for (var property in this) {\n                    if (!angular.isFunction(this[property]) && this.hasOwnProperty(property) && excludedProperty.indexOf(property) === -1) {\n                        if (this.id === undefined || excludedInEdit.indexOf(property) === -1) {\n                            result[property] = this[property];\n                        }\n                    }\n                }\n\n                if (this.id === undefined) {\n                    promise = resource.post(result);\n                } else {\n                    promise = resource.put(this.id, result);\n                }\n\n                return promise;\n            }\n        }, {\n            key: 'saveMe',\n            value: function saveMe() {\n                var result = {},\n                    promise = void 0,\n                    excludedProperty = ['id', 'displayName', 'roles', 'status', 'createdAt', 'email', 'language'];\n\n                for (var property in this) {\n                    if (!angular.isFunction(this[property]) && this.hasOwnProperty(property) && excludedProperty.indexOf(property) === -1) {\n                        result[property] = this[property];\n                    }\n                }\n\n                promise = resource.putMe(result);\n\n                return promise;\n            }\n        }, {\n            key: 'saveOthersSettings',\n            value: function saveOthersSettings() {\n                var result = {},\n                    promise = void 0,\n                    excludedProperty = ['id', 'displayName', 'roles', 'status', 'createdAt', 'email', 'firstName', 'lastName'];\n\n                for (var property in this) {\n                    if (!angular.isFunction(this[property]) && this.hasOwnProperty(property) && excludedProperty.indexOf(property) === -1) {\n                        result[property] = this[property];\n                    }\n                }\n\n                promise = resource.othersSettingsMe(result);\n\n                return promise;\n            }\n        }, {\n            key: 'remove',\n            value: function remove() {\n                if (this.id === undefined) {\n                    return false;\n                }\n\n                return resource.delete(this.id);\n            }\n        }]);\n\n        return User;\n    }();\n\n    return User;\n};\n\nexports.default = userFactory;\n\n},{}],79:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _User = require('../entities/User.js');\n\nvar _User2 = _interopRequireDefault(_User);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar CHANGE_PASSWORD_ROUTE = '/api/users/me/change-password';\nvar RESET_REQUEST_ROUTE = '/api/reset-password/request';\nvar RESET_PASSWORD_ROUTE = '/api/reset-password/token/';\nvar DEFAULT_LANGUAGE = 'en';\n\nvar transformResponse = function transformResponse(resp) {\n    var user = this.getEntity();\n\n    if (resp !== undefined) {\n        user.id = resp.id;\n        user.email = resp.email;\n        user.firstName = resp.first_name;\n        user.lastName = resp.last_name;\n        user.displayName = resp.display_name;\n        user.roles = resp.roles;\n        user.status = resp.status;\n        user.createdAt = resp.created_at;\n\n        if (resp.language === null) {\n            user.language = DEFAULT_LANGUAGE;\n        } else {\n            user.language = resp.language;\n        }\n    }\n\n    return user;\n};\n\nvar appendTransform = function appendTransform(defaults, transform) {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name UserResource\n */\n\nvar UserResource = function () {\n    /**\n     * @param {$http} $http\n     * @param {$q} $q\n     */\n    function UserResource($http, $q) {\n        _classCallCheck(this, UserResource);\n\n        this.http = $http;\n        this.q = $q;\n    }\n\n    /**\n     * @returns {User}\n     */\n\n\n    _createClass(UserResource, [{\n        key: 'getEntity',\n        value: function getEntity() {\n            var User = (0, _User2.default)(this);\n\n            return new User();\n        }\n\n        /**\n         * @description Send request to get specific entity\n         *\n         * @param {number} id\n         * @returns {deferred.promise}\n         */\n\n    }, {\n        key: 'get',\n        value: function get(id) {\n            var _this = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: '/api/users/' + id,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (status < 400) {\n                        return transformResponse.call(_this, resp.data);\n                    } else {\n                        return resp;\n                    }\n                })\n            }).success(function (data) {\n                deferred.resolve(data);\n            }).error(function () {\n                deferred.reject();\n            });\n\n            return deferred.promise;\n        }\n\n        /**\n         * @description Send request to get specific entity\n         *\n         * @returns {deferred.promise}\n         */\n\n    }, {\n        key: 'getMe',\n        value: function getMe() {\n            var _this2 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: '/api/users/me',\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (status < 400) {\n                        return transformResponse.call(_this2, resp.data);\n                    } else {\n                        return resp;\n                    }\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n\n        /**\n         * @description Send request to get list of entity\n         *\n         * @param {Object} params\n         *\n         * @returns {deferred.promise}\n         */\n\n    }, {\n        key: 'query',\n        value: function query(params) {\n            var _this3 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: '/api/users',\n                params: params,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp) {\n                    if (status < 400) {\n                        for (var element in resp.data) {\n                            if (resp.data[element] instanceof Object) {\n                                resp.data[element] = transformResponse.call(_this3, resp.data[element]);\n                            }\n                        }\n                    }\n\n                    return resp;\n                })\n            }).success(function (data) {\n                deferred.resolve(data);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n\n        /**\n         * @description Send request to delete entity\n         *\n         * @param {number} id\n         *\n         * @returns {deferred.promise}\n         */\n\n    }, {\n        key: 'delete',\n        value: function _delete(id) {\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'DELETE',\n                url: '/api/users/' + id\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n\n        /**\n         * @description Send request to create entity\n         *\n         * @param {object} entity\n         */\n\n    }, {\n        key: 'post',\n        value: function post(entity) {\n            var _this4 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'POST',\n                url: '/api/users',\n                data: entity,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (status < 400) {\n                        return transformResponse.call(_this4, resp.data);\n                    } else {\n                        return resp;\n                    }\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n\n        /**\n         * Send request to update entity\n         *\n         * @param {number} id\n         * @param {object} entity\n         *\n         * @returns {deferred.promise}\n         */\n\n    }, {\n        key: 'put',\n        value: function put(id, entity) {\n            var _this5 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'PUT',\n                url: '/api/users/' + id,\n                data: entity,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (status < 400) {\n                        return transformResponse.call(_this5, resp.data);\n                    } else {\n                        return resp;\n                    }\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n\n        /**\n         * Send request to update entity\n         *\n         * @param {number} id\n         * @param {object} entity\n         *\n         * @returns {deferred.promise}\n         */\n\n    }, {\n        key: 'putMe',\n        value: function putMe(entity) {\n            var _this6 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'PUT',\n                url: '/api/users/me',\n                data: entity,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (status < 400) {\n                        return transformResponse.call(_this6, resp.data);\n                    } else {\n                        return resp;\n                    }\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n\n        /**\n         * Send request to update entity\n         *\n         * @param {object} entity\n         *\n         * @returns {deferred.promise}\n         */\n\n    }, {\n        key: 'othersSettingsMe',\n        value: function othersSettingsMe(entity) {\n            var _this7 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'PUT',\n                url: '/api/users/me/others-settings',\n                data: entity,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (status < 400) {\n                        return transformResponse.call(_this7, resp.data);\n                    } else {\n                        return resp;\n                    }\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n\n        /**\n         * @description Send request to change password\n         *\n         * @param {Object} data\n         * @returns {deferred.promise|*}\n         */\n\n    }, {\n        key: 'changePassword',\n        value: function changePassword(data) {\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'POST',\n                data: data,\n                url: CHANGE_PASSWORD_ROUTE\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n\n        /**\n         * @description Send request to reset password\n         *\n         * @param {Object} data\n         * @returns {deferred.promise|*}\n         */\n\n    }, {\n        key: 'resetPassword',\n        value: function resetPassword(data) {\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'POST',\n                data: data,\n                url: RESET_REQUEST_ROUTE\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n\n        /**\n         * @description Send request to confirm password with the new one\n         *\n         * @param {Object} data\n         * @param {String} token\n         * @returns {deferred.promise|*}\n         */\n\n    }, {\n        key: 'setPassword',\n        value: function setPassword(data, token) {\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'POST',\n                data: data,\n                url: RESET_PASSWORD_ROUTE + token\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }]);\n\n    return UserResource;\n}();\n\nexports.default = UserResource;\n\n},{\"../entities/User.js\":78}],80:[function(require,module,exports){\n'use strict';\n\nvar _CreateController = require('./controllers/CreateController.js');\n\nvar _CreateController2 = _interopRequireDefault(_CreateController);\n\nvar _EditController = require('./controllers/EditController.js');\n\nvar _EditController2 = _interopRequireDefault(_EditController);\n\nvar _ManageController = require('./controllers/ManageController.js');\n\nvar _ManageController2 = _interopRequireDefault(_ManageController);\n\nvar _OthersSettingsController = require('./controllers/OthersSettingsController.js');\n\nvar _OthersSettingsController2 = _interopRequireDefault(_OthersSettingsController);\n\nvar _ChangePasswordController = require('./controllers/ChangePasswordController.js');\n\nvar _ChangePasswordController2 = _interopRequireDefault(_ChangePasswordController);\n\nvar _ResetRequestController = require('./controllers/ResetRequestController.js');\n\nvar _ResetRequestController2 = _interopRequireDefault(_ResetRequestController);\n\nvar _SetPasswordController = require('./controllers/SetPasswordController.js');\n\nvar _SetPasswordController2 = _interopRequireDefault(_SetPasswordController);\n\nvar _UserResource = require('./resources/UserResource.js');\n\nvar _UserResource2 = _interopRequireDefault(_UserResource);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar MODULE_NAME = 'clearcode.tm.user';\nvar MODULE_DIR = 'app/modules/user';\n\n_CreateController2.default.$inject = [MODULE_NAME + '.userResource', 'clearcode.tm.alert.alert', 'clearcode.tm.pageInfo.pageInfo', '$state', '$scope', '$translate', 'clearcode.tm.alert.refreshAlert'];\n\n_EditController2.default.$inject = [MODULE_NAME + '.userResource', '$stateParams', 'clearcode.tm.alert.alert', 'clearcode.tm.pageInfo.pageInfo', '$state', '$scope', '$translate', 'clearcode.tm.alert.refreshAlert', 'clearcode.tm.security.security'];\n\n_ManageController2.default.$inject = ['ngTableParams', MODULE_NAME + '.userResource', 'clearcode.tm.alert.alert', 'clearcode.tm.tagContainer.paramConverter', 'clearcode.tm.tagContainer.currentContainer', 'clearcode.tm.pageInfo.pageInfo', '$translate'];\n\n_ChangePasswordController2.default.$inject = ['clearcode.tm.user.userResource', 'clearcode.tm.alert.alert', '$state', 'clearcode.tm.pageInfo.pageInfo', '$scope', '$translate'];\n\n_OthersSettingsController2.default.$inject = ['clearcode.tm.alert.alert', '$scope', '$translate', 'clearcode.tm.translation.translation', '$window', 'clearcode.tm.pageInfo.pageInfo'];\n\n_ResetRequestController2.default.$inject = [MODULE_NAME + '.userResource', 'clearcode.tm.form.alertForm', 'clearcode.tm.alert.alert', 'clearcode.tm.pageInfo.pageInfo', '$translate'];\n\n_SetPasswordController2.default.$inject = [MODULE_NAME + '.userResource', '$state', '$stateParams', 'clearcode.tm.alert.alert', 'clearcode.tm.pageInfo.pageInfo', '$scope', '$translate'];\n\n_UserResource2.default.$inject = ['$http', '$q'];\n\nangular.module(MODULE_NAME, ['pascalprecht.translate', 'ui.router', 'ngTable', 'clearcode.tm.alert', 'clearcode.tm.pageInfo', 'clearcode.tm.form', 'clearcode.tm.tagContainer', 'clearcode.tm.security']).run(['clearcode.tm.alert.$alert', function ($alertProvider) {\n    $alertProvider.addMessagePattern('user.save', 'User account has been saved successfully.');\n\n    $alertProvider.addMessagePattern('user.change_language', 'The language has been changed');\n\n    $alertProvider.addMessagePattern('password.change', 'Your password has been changed successfully.');\n\n    $alertProvider.addMessagePattern('user.invalid', 'Sorry, something went wrong.');\n\n    $alertProvider.addMessagePattern('user.reset', 'Email with activation link has been sent.');\n\n    $alertProvider.addMessagePattern('user.others', 'Other settings has been saved successfully.');\n}]).config(['$stateProvider', function ($stateProvider) {\n    $stateProvider.state('users', {\n        url: '/users',\n        controller: MODULE_NAME + '.ManageController as view',\n        templateUrl: MODULE_DIR + '/views/manage.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: false\n        }\n    }).state('userCreate', {\n        url: '/users-create',\n        controller: MODULE_NAME + '.CreateController as view',\n        templateUrl: MODULE_DIR + '/views/create.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: false\n        }\n    }).state('userEdit', {\n        url: '/users-edit/{userId}',\n        controller: MODULE_NAME + '.EditController as view',\n        templateUrl: MODULE_DIR + '/views/edit.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: false\n        }\n    }).state('editProfile', {\n        url: '/profile',\n        controller: MODULE_NAME + '.EditController as view',\n        controllerAs: 'view',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            secure: true\n        },\n        templateUrl: '/app/modules/user/views/profile.html'\n    }).state('resetPassword', {\n        url: '/reset-password',\n        controller: MODULE_NAME + '.ResetRequestController',\n        controllerAs: 'view',\n        data: {\n            roles: [],\n            secure: false\n        },\n        templateUrl: '/app/modules/user/views/resetPassword.html'\n    }).state('resetConfirm', {\n        url: '/reset-password/token/{token}',\n        controller: MODULE_NAME + '.SetPasswordController',\n        controllerAs: 'view',\n        data: {\n            roles: [],\n            secure: false\n        },\n        templateUrl: '/app/modules/user/views/setPassword.html'\n    });\n}]).controller(MODULE_NAME + '.CreateController', _CreateController2.default).controller(MODULE_NAME + '.EditController', _EditController2.default).controller(MODULE_NAME + '.ManageController', _ManageController2.default).controller(MODULE_NAME + '.OthersSettingsController', _OthersSettingsController2.default).controller(MODULE_NAME + '.ChangePasswordController', _ChangePasswordController2.default).controller(MODULE_NAME + '.ResetRequestController', _ResetRequestController2.default).controller(MODULE_NAME + '.SetPasswordController', _SetPasswordController2.default).service(MODULE_NAME + '.userResource', _UserResource2.default);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./controllers/ChangePasswordController.js\":71,\"./controllers/CreateController.js\":72,\"./controllers/EditController.js\":73,\"./controllers/ManageController.js\":74,\"./controllers/OthersSettingsController.js\":75,\"./controllers/ResetRequestController.js\":76,\"./controllers/SetPasswordController.js\":77,\"./resources/UserResource.js\":79}],81:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name BaseController\n */\nvar BaseController = function () {\n    function BaseController($variableResource, $typeResource, $PageInfo, $scope, $variableFormProvider, currentContainer, $stateParams, $alert, $state, $translate, $condition) {\n        var _this = this;\n\n        _classCallCheck(this, BaseController);\n\n        this.typeResource = $typeResource;\n        this.variableFormProvider = $variableFormProvider;\n        this.currentContainer = currentContainer;\n        this.condition = $condition;\n        this.stateParams = $stateParams;\n        this.alert = $alert;\n        this.state = $state;\n        this.translate = $translate;\n\n        this.variable = $variableResource.getEntityObject();\n        this.formTouched = false;\n\n        $scope.$on('pageInfo.reload', function (event, args) {\n            $translate([_this.getBreadcrumbText()]).then(function (translations) {\n                $PageInfo.clear().add(args.name, 'tags', {\n                    containerId: args.id\n                }).add(translations[_this.getBreadcrumbText()], 'variables', {\n                    containerId: args.id\n                }).broadcast();\n            });\n        });\n    }\n\n    _createClass(BaseController, [{\n        key: 'getVariableTypes',\n        value: function getVariableTypes() {\n            var _this2 = this;\n\n            this.typesPromise = this.typeResource.query();\n\n            this.typesPromise.then(function (resp) {\n                _this2.types = resp.data;\n                if (_this2.variable.type && _this2.variable.type.id === undefined) {\n                    for (var i = 0; i < _this2.types.length; i++) {\n                        if (_this2.variable.type === _this2.types[i].id) {\n                            _this2.variable.type = _this2.types[i];\n                            _this2.formTouched = true;\n                            break;\n                        }\n                    }\n                }\n            });\n        }\n    }, {\n        key: 'setVariableType',\n        value: function setVariableType(type) {\n            this.variable.type = type;\n            this.variable.value = '';\n            this.formTouched = true;\n        }\n    }, {\n        key: 'getConfigurationTemplate',\n        value: function getConfigurationTemplate() {\n            var typeId = this.variable.type.id !== undefined ? this.variable.type.id : this.variable.type;\n\n            return this.variableFormProvider.getType(typeId).templateUrl;\n        }\n    }, {\n        key: 'submitForm',\n        value: function submitForm(variable) {\n            var _this3 = this;\n\n            this.variablePromise = variable.save(this.stateParams.containerId);\n\n            this.variablePromise.then(function () {\n                _this3.currentContainer.makeChanges();\n                _this3.condition.refresh();\n                _this3.alert.success(_this3.getAlertType());\n\n                _this3.state.go('variables', {\n                    containerId: _this3.stateParams.containerId\n                });\n            }, function () {\n                _this3.alert.error('error.invalid');\n            });\n        }\n    }, {\n        key: 'displayInvalidFormMessage',\n        value: function displayInvalidFormMessage() {\n            this.validateVariable = true;\n            this.alert.error('error.invalid');\n        }\n    }]);\n\n    return BaseController;\n}();\n\nexports.default = BaseController;\n\n},{}],82:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _BaseController2 = require('./BaseController.js');\n\nvar _BaseController3 = _interopRequireDefault(_BaseController2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar BREADCRUMB_GLOBAL = 'Variables';\n\n/**\n * @name CreateController\n */\n\nvar CreateController = function (_BaseController) {\n    _inherits(CreateController, _BaseController);\n\n    function CreateController($variableResource, $typeResource, $PageInfo, $scope, $variableFormProvider, currentContainer, $stateParams, $alert, $state, $translate, $condition) {\n        _classCallCheck(this, CreateController);\n\n        var _this = _possibleConstructorReturn(this, (CreateController.__proto__ || Object.getPrototypeOf(CreateController)).call(this, $variableResource, $typeResource, $PageInfo, $scope, $variableFormProvider, currentContainer, $stateParams, $alert, $state, $translate, $condition));\n\n        _this.variable = $variableResource.getEntityObject();\n\n        _this.getVariableTypes();\n\n        currentContainer.getContainer().then(function () {\n            if (!currentContainer.$container.hasPermission('edit')) {\n                $state.go('triggers', { containerId: $stateParams.containerId });\n            }\n\n            _this.translate([_this.getBreadcrumbText(), BREADCRUMB_GLOBAL]).then(function (translations) {\n                $PageInfo.clear().add(currentContainer.$container.name, 'tags', {\n                    containerId: currentContainer.$container.id\n                }).add(translations[BREADCRUMB_GLOBAL], 'variables', {\n                    containerId: currentContainer.$container.id\n                }).add(translations[_this.getBreadcrumbText()]).broadcast();\n            });\n        });\n        return _this;\n    }\n\n    _createClass(CreateController, [{\n        key: 'getBreadcrumbText',\n        value: function getBreadcrumbText() {\n            return 'Add a new variable';\n        }\n    }, {\n        key: 'getAlertType',\n        value: function getAlertType() {\n            return 'success.create';\n        }\n    }]);\n\n    return CreateController;\n}(_BaseController3.default);\n\nexports.default = CreateController;\n\n},{\"./BaseController.js\":81}],83:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _BaseController2 = require('./BaseController.js');\n\nvar _BaseController3 = _interopRequireDefault(_BaseController2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar BREADCRUMB_GLOBAL = 'Variables';\n\n/**\n * @name EditController\n */\n\nvar EditController = function (_BaseController) {\n    _inherits(EditController, _BaseController);\n\n    function EditController($variableResource, $typeResource, $PageInfo, $scope, $variableFormProvider, currentContainer, $stateParams, $alert, $state, $translate, $condition) {\n        _classCallCheck(this, EditController);\n\n        var _this = _possibleConstructorReturn(this, (EditController.__proto__ || Object.getPrototypeOf(EditController)).call(this, $variableResource, $typeResource, $PageInfo, $scope, $variableFormProvider, currentContainer, $stateParams, $alert, $state, $translate, $condition));\n\n        _this.variablePromise = $variableResource.get($stateParams.variableId);\n\n        _this.variablePromise.then(function (resp) {\n            _this.variable = resp;\n            _this.getVariableTypes();\n        });\n\n        _this.currentContainer.getContainer().then(function () {\n            if (_this.currentContainer.$container.hasPermission('noaccess')) {\n                _this.state.go('container');\n            }\n\n            _this.translate([_this.getBreadcrumbText(), BREADCRUMB_GLOBAL]).then(function (translations) {\n                $PageInfo.clear().add(_this.currentContainer.$container.name, 'tags', {\n                    containerId: _this.currentContainer.$container.id\n                }).add(translations[BREADCRUMB_GLOBAL], 'variables', {\n                    containerId: _this.currentContainer.$container.id\n                }).add(translations[_this.getBreadcrumbText()]).broadcast();\n            });\n        });\n\n        _this.formTouched = true;\n        return _this;\n    }\n\n    _createClass(EditController, [{\n        key: 'getBreadcrumbText',\n        value: function getBreadcrumbText() {\n            return 'Configure variable';\n        }\n    }, {\n        key: 'getAlertType',\n        value: function getAlertType() {\n            return 'success.edit';\n        }\n    }]);\n\n    return EditController;\n}(_BaseController3.default);\n\nexports.default = EditController;\n\n},{\"./BaseController.js\":81}],84:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar $alert = void 0,\n    stateParams = void 0,\n    currentContainer = void 0,\n    scope = void 0;\n\nvar BREADCRUMB_TEXT = 'Variables';\n\n/**\n * @name ManageController\n */\n\nvar ManageController = function () {\n    function ManageController(TableParams, $stateParams, variableResource, alert, paramConverter, CurrentContainer, PageInfo, $scope, state, $translate) {\n        var _this = this;\n\n        _classCallCheck(this, ManageController);\n\n        $alert = alert;\n        stateParams = $stateParams;\n        currentContainer = CurrentContainer;\n        scope = $scope;\n\n        this.permissions = [];\n        this.containerId = stateParams.containerId;\n\n        currentContainer.getContainer().then(function (container) {\n            if (!currentContainer.$container.hasPermission('view')) {\n                state.go('container');\n            } else {\n                _this.permissions = currentContainer.$container.permissions;\n            }\n\n            $translate([BREADCRUMB_TEXT]).then(function (translations) {\n                PageInfo.clear().add(container.name, 'variable', {\n                    containerId: container.id\n                }).add(translations[BREADCRUMB_TEXT]).broadcast();\n            });\n        });\n\n        this.tableParams = new TableParams({\n            page: 1,\n            count: 10,\n            sorting: {\n                name: 'asc'\n            }\n        }, {\n            total: 0,\n            getData: function getData($defer, params) {\n                variableResource.query(stateParams.containerId, paramConverter.list(params.url())).then(function (resp) {\n                    params.total(resp.total);\n                    $defer.resolve(resp.data);\n                });\n            }\n        });\n\n        scope.$on('pageInfo.reload', function (event, args) {\n            $translate([BREADCRUMB_TEXT]).then(function (translations) {\n                PageInfo.clear().add(args.name, 'variables', {\n                    containerId: args.id\n                }).add(translations[BREADCRUMB_TEXT]).broadcast();\n            });\n        });\n    }\n\n    _createClass(ManageController, [{\n        key: 'removeVariable',\n        value: function removeVariable(variable) {\n            var _this2 = this;\n\n            variable.remove().then(function () {\n                $alert.success('success.remove');\n                currentContainer.makeChanges();\n\n                if (_this2.tableParams.data.length === 1 && _this2.tableParams.page() > 1) {\n                    _this2.tableParams.page(_this2.tableParams.page() - 1);\n                } else {\n                    _this2.tableParams.reload();\n                }\n            }, function () {\n                $alert.error('error.remove');\n                _this2.tableParams.reload();\n            });\n        }\n    }]);\n\n    return ManageController;\n}();\n\nexports.default = ManageController;\n\n},{}],85:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar variableSelector = void 0,\n    scope = void 0,\n    compile = void 0;\n\nvar SelectorController = function () {\n    function SelectorController($compile, $scope, $variableSelector, condition) {\n        var _this = this;\n\n        _classCallCheck(this, SelectorController);\n\n        compile = $compile;\n        scope = $scope;\n        variableSelector = $variableSelector;\n\n        condition.allVariables().then(function (resp) {\n            _this.variables = resp;\n        });\n    }\n\n    _createClass(SelectorController, [{\n        key: 'init',\n        value: function init($element, $ngModel) {\n            this.element = $element;\n            this.ngModel = $ngModel;\n\n            var listElement = compileListView();\n            this.ulElement = listElement.children();\n\n            createWrapper(this.element, listElement);\n        }\n    }, {\n        key: 'toggleVariablesList',\n        value: function toggleVariablesList(event) {\n            var elementValue = this.element.val().trim();\n\n            this.isVariablesListVisible() ? this.element.val(variableSelector.removeVariablePrompt(elementValue)) : this.element.val(variableSelector.addVariablePrompt(elementValue));\n\n            this.ulElement.toggleClass('show');\n            stopBubblingEvent(event);\n        }\n    }, {\n        key: 'addVariable',\n        value: function addVariable(variable) {\n            var elementValue = this.element.val().trim();\n            this.ulElement.removeClass('show');\n\n            this.ngModel.$setViewValue(variableSelector.selectVariable(elementValue, variable));\n            this.ngModel.$render();\n            this.element[0].focus();\n        }\n    }, {\n        key: 'closeVariablePrompt',\n        value: function closeVariablePrompt(event) {\n            var elementValue = this.element.val().trim();\n\n            if (!this.isVariablesListVisible()) {\n                return;\n            }\n\n            this.ulElement.removeClass('show');\n            this.element.val(variableSelector.removeVariablePrompt(elementValue));\n            stopBubblingEvent(event);\n        }\n    }, {\n        key: 'isVariablesListVisible',\n        value: function isVariablesListVisible() {\n            return this.ulElement.hasClass('show');\n        }\n    }]);\n\n    return SelectorController;\n}();\n\nfunction stopBubblingEvent(event) {\n    event.stopPropagation();\n    event.cancelBubble = true;\n}\n\nfunction compileListView() {\n    var listTemplate = angular.element(document.getElementById('variables-list.html')).html();\n\n    return compile(listTemplate)(scope);\n}\n\nfunction createWrapper(element, listElement) {\n    var btnElement = compile(variableSelector.getTemplate())(scope),\n        inputGroupWrapper = void 0;\n\n    element.wrap(variableSelector.getElementWrapper());\n\n    inputGroupWrapper = element.parent();\n    inputGroupWrapper.append(btnElement);\n    inputGroupWrapper.append(listElement);\n}\n\nexports.default = SelectorController;\n\n},{}],86:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar variableClickOutside = function variableClickOutside($document) {\n    return {\n        restrict: 'A',\n        require: 'variableSelector',\n        link: function link(scope, element, attrs, selectorCtrl) {\n            $document.on('click', documentOnClick);\n            scope.$on('$destroy', function () {\n                $document.off('click', documentOnClick);\n            });\n\n            function documentOnClick(event) {\n                var outside = !element[0].contains(event.target),\n                    listVisible = selectorCtrl.isVariablesListVisible();\n\n                if (outside && listVisible) {\n                    element.val(selectorCtrl.closeVariablePrompt(event));\n                }\n            }\n        }\n    };\n};\n\nexports.default = variableClickOutside;\n\n},{}],87:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _SelectorController = require('../controllers/SelectorController.js');\n\nvar _SelectorController2 = _interopRequireDefault(_SelectorController);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar variableSelectorDirective = function variableSelectorDirective() {\n    return {\n        restrict: 'A',\n        require: ['variableSelector', 'ngModel'],\n        scope: {},\n        link: function link(scope, element, attrs, controllers) {\n            var selectorController = controllers[0];\n            var ngModel = controllers[1];\n\n            selectorController.init(element, ngModel);\n        },\n        controller: _SelectorController2.default,\n        controllerAs: 'selectorCtrl',\n        bindToController: true\n    };\n}; /**\n    * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n    *\n    * This program is free software: you can redistribute it and/or modify it under\n    * the terms of the GNU Affero General Public License as published by the Free\n    * Software Foundation, either version 3 of the License, or (at your option) any\n    * later version.\n    *\n    * This program is distributed in the hope that it will be useful,\n    * but WITHOUT ANY WARRANTY; without even the implied warranty of\n    * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n    * GNU Affero General Public License for more details.\n    *\n    * You should have received a copy of the GNU Affero General Public License\n    * along with this program. If not, see <http://www.gnu.org/licenses/>.\n    */\n\nexports.default = variableSelectorDirective;\n\n},{\"../controllers/SelectorController.js\":85}],88:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar variableFactory = function variableFactory(resource) {\n    /**\n     * @name Variable\n     * @description Variable entity\n     */\n    var Variable = function () {\n        function Variable() {\n            _classCallCheck(this, Variable);\n\n            /**\n             * @type {number}\n             */\n            this.id = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.name = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.description = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.type = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.value = undefined;\n\n            /**\n             * @type {Object}\n             */\n            this.options = [];\n\n            /**\n             * @type {string}\n             */\n            this.updatedAt = undefined;\n        }\n\n        _createClass(Variable, [{\n            key: 'save',\n            value: function save(containerId) {\n                var result = {},\n                    promise = void 0,\n                    excludedProperty = ['id', 'updatedAt'];\n\n                for (var property in this) {\n                    if (!angular.isFunction(this[property]) && this.hasOwnProperty(property) && excludedProperty.indexOf(property) === -1) {\n                        if (property === 'type') {\n                            result[property] = this[property].id;\n                        } else {\n                            result[property] = this[property];\n                        }\n                    }\n                }\n\n                if (this.id === undefined) {\n                    promise = resource.post(containerId, result);\n                } else {\n                    promise = resource.put(this.id, result);\n                }\n\n                return promise;\n            }\n        }, {\n            key: 'remove',\n            value: function remove() {\n                if (this.id === undefined) {\n                    return false;\n                }\n\n                return resource.delete(this.id);\n            }\n        }]);\n\n        return Variable;\n    }();\n\n    return Variable;\n};\n\nexports.default = variableFactory;\n\n},{}],89:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar variableTypeFactory = function variableTypeFactory() {\n  /**\n   * @name Variable\n   * @description Variable entity\n   */\n  var VariableType = function VariableType() {\n    _classCallCheck(this, VariableType);\n\n    /**\n     * @type {number}\n     */\n    this.id = undefined;\n\n    /**\n     * @type {string}\n     */\n    this.name = undefined;\n\n    /**\n     * @type {string}\n     */\n    this.helper = undefined;\n  };\n\n  return VariableType;\n};\n\nexports.default = variableTypeFactory;\n\n},{}],90:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name variable#VariableFormProvider\n * @namespace clearcode.tm.variable\n */\n/* eslint-disable */\nvar VariableFormProvider = function () {\n    function VariableFormProvider() {\n        _classCallCheck(this, VariableFormProvider);\n\n        this.collection = {};\n    }\n\n    _createClass(VariableFormProvider, [{\n        key: 'addType',\n        value: function addType(name, settings) {\n            if (this.collection[name] !== undefined) {\n                throw new Error('Form type with provided name already exist');\n            }\n\n            this.collection[name] = settings;\n\n            return this;\n        }\n    }, {\n        key: 'getType',\n        value: function getType(name) {\n            if (this.collection[name] === undefined) {\n                return false;\n            }\n\n            return this.collection[name];\n        }\n    }, {\n        key: '$get',\n        value: function $get() {\n            return this;\n        }\n    }]);\n\n    return VariableFormProvider;\n}();\n/* eslint-enable */\n\n\nexports.default = VariableFormProvider;\n\n},{}],91:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _Variable = require('../entity/Variable.js');\n\nvar _Variable2 = _interopRequireDefault(_Variable);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar transformResponse = function transformResponse(resp) {\n    var Variable = (0, _Variable2.default)(this);\n\n    var variable = new Variable();\n\n    variable.id = resp.id;\n    variable.name = resp.name;\n    variable.description = resp.description;\n    variable.type = resp.type;\n    variable.value = resp.value;\n    variable.options = resp.options;\n    variable.updatedAt = resp.updated_at;\n\n    return variable;\n};\n\nvar appendTransform = function appendTransform(defaults, transform) {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name VariableResource\n */\n\nvar VariableResource = function () {\n    function VariableResource($http, $q) {\n        _classCallCheck(this, VariableResource);\n\n        this.http = $http;\n        this.q = $q;\n    }\n\n    _createClass(VariableResource, [{\n        key: 'getEntityObject',\n        value: function getEntityObject() {\n            var Variable = (0, _Variable2.default)(this);\n\n            return new Variable();\n        }\n    }, {\n        key: 'get',\n        value: function get(id) {\n            var _this = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: '/api/variables/' + id,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (status < 400) {\n                        return transformResponse.call(_this, resp.data);\n                    } else {\n                        return resp;\n                    }\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'query',\n        value: function query(containerId, params) {\n            var _this2 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: '/api/containers/' + containerId + '/variables',\n                params: params,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp) {\n                    for (var element in resp.data) {\n                        if (resp.data[element] instanceof Object) {\n                            resp.data[element] = transformResponse.call(_this2, resp.data[element]);\n                        }\n                    }\n\n                    return resp;\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'queryAllAvailable',\n        value: function queryAllAvailable(containerId, params) {\n            var _this3 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: '/api/containers/' + containerId + '/available-variables',\n                params: params,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp) {\n                    for (var element in resp.data) {\n                        if (resp.data[element] instanceof Object) {\n                            resp.data[element] = transformResponse.call(_this3, resp.data[element]);\n                        }\n                    }\n\n                    return resp;\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'delete',\n        value: function _delete(id) {\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'DELETE',\n                url: '/api/variables/' + id\n            }).success(function (data) {\n                deferred.resolve(data);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'post',\n        value: function post(containerId, entity) {\n            var _this4 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'POST',\n                url: '/api/containers/' + containerId + '/variables',\n                data: entity,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (status < 400) {\n                        return transformResponse.call(_this4, resp.data);\n                    } else {\n                        return resp;\n                    }\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }, {\n        key: 'put',\n        value: function put(id, entity) {\n            var _this5 = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'PUT',\n                url: '/api/variables/' + id,\n                data: entity,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp, header, status) {\n                    if (status < 400) {\n                        return transformResponse.call(_this5, resp.data);\n                    } else {\n                        return resp;\n                    }\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }]);\n\n    return VariableResource;\n}();\n\nexports.default = VariableResource;\n\n},{\"../entity/Variable.js\":88}],92:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _VariableType = require('../entity/VariableType.js');\n\nvar _VariableType2 = _interopRequireDefault(_VariableType);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar transformResponse = function transformResponse(resp) {\n    var VariableType = (0, _VariableType2.default)(this);\n\n    var type = new VariableType();\n\n    type.id = resp.id;\n    type.name = resp.name;\n    type.helper = resp.helper;\n\n    return type;\n};\n\nvar appendTransform = function appendTransform(defaults, transform) {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name VariableResource\n */\n\nvar VariableTypeResource = function () {\n    function VariableTypeResource($http, $q) {\n        _classCallCheck(this, VariableTypeResource);\n\n        this.http = $http;\n        this.q = $q;\n    }\n\n    _createClass(VariableTypeResource, [{\n        key: 'getEntityObject',\n        value: function getEntityObject() {\n            var VariableType = (0, _VariableType2.default)(this);\n\n            return new VariableType();\n        }\n    }, {\n        key: 'query',\n        value: function query(params) {\n            var _this = this;\n\n            var deferred = this.q.defer();\n\n            this.http({\n                method: 'GET',\n                url: '/api/variable-types',\n                params: params,\n                transformResponse: appendTransform(this.http.defaults.transformResponse, function (resp) {\n                    for (var element in resp.data) {\n                        if (resp.data[element] instanceof Object) {\n                            resp.data[element] = transformResponse.call(_this, resp.data[element]);\n                        }\n                    }\n\n                    return resp;\n                })\n            }).success(function (resp) {\n                deferred.resolve(resp);\n            }).error(function (err) {\n                deferred.reject(err);\n            });\n\n            return deferred.promise;\n        }\n    }]);\n\n    return VariableTypeResource;\n}();\n\nexports.default = VariableTypeResource;\n\n},{\"../entity/VariableType.js\":89}],93:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar template = '\\n    <span class=\"input-group-addon\" ng-click=\"selectorCtrl.toggleVariablesList($event)\" style=\"cursor: pointer;\">\\n        <i class=\"icon-variable-insert\"></i>\\n    </span>';\n\nvar elementWrapper = '<div class=\"input-group cc-select\"></div>';\n\n/**\n * @name VariableSelector\n */\n\nvar VariableSelector = function () {\n    function VariableSelector() {\n        _classCallCheck(this, VariableSelector);\n    }\n\n    _createClass(VariableSelector, [{\n        key: 'getTemplate',\n        value: function getTemplate() {\n            return template;\n        }\n    }, {\n        key: 'getElementWrapper',\n        value: function getElementWrapper() {\n            return elementWrapper;\n        }\n    }, {\n        key: 'addVariablePrompt',\n        value: function addVariablePrompt(elementValue) {\n            var text = !isVariablePromptOpen(elementValue) ? openVariablePrompt(elementValue) : elementValue;\n\n            return text;\n        }\n    }, {\n        key: 'selectVariable',\n        value: function selectVariable(elementValue, variable) {\n            return (elementValue + ' ' + variable.name + ' }}').trim();\n        }\n    }, {\n        key: 'removeVariablePrompt',\n        value: function removeVariablePrompt(elementValue) {\n            return isVariablePromptOpen(elementValue) ? _removeVariablePrompt(elementValue) : elementValue;\n        }\n    }], [{\n        key: 'selectorFactory',\n        value: function selectorFactory() {\n            return new VariableSelector();\n        }\n    }]);\n\n    return VariableSelector;\n}();\n\nfunction isVariablePromptOpen(elementValue) {\n    return elementValue.slice(-2) === '{{';\n}\n\nfunction openVariablePrompt(elementValue) {\n    return (elementValue + ' {{').trim();\n}\n\nfunction _removeVariablePrompt(elementValue) {\n    return elementValue.substring(0, elementValue.length - 2).trim();\n}\nexports.default = VariableSelector;\n\n},{}],94:[function(require,module,exports){\n'use strict';\n\nvar _ManageController = require('./controllers/ManageController.js');\n\nvar _ManageController2 = _interopRequireDefault(_ManageController);\n\nvar _CreateController = require('./controllers/CreateController.js');\n\nvar _CreateController2 = _interopRequireDefault(_CreateController);\n\nvar _EditController = require('./controllers/EditController.js');\n\nvar _EditController2 = _interopRequireDefault(_EditController);\n\nvar _SelectorController = require('./controllers/SelectorController');\n\nvar _SelectorController2 = _interopRequireDefault(_SelectorController);\n\nvar _VariableResource = require('./resource/VariableResource.js');\n\nvar _VariableResource2 = _interopRequireDefault(_VariableResource);\n\nvar _VariableTypeResource = require('./resource/VariableTypeResource.js');\n\nvar _VariableTypeResource2 = _interopRequireDefault(_VariableTypeResource);\n\nvar _VariableFormProvider = require('./providers/VariableFormProvider.js');\n\nvar _VariableFormProvider2 = _interopRequireDefault(_VariableFormProvider);\n\nvar _VariableSelector = require('./services/VariableSelector.js');\n\nvar _VariableSelector2 = _interopRequireDefault(_VariableSelector);\n\nvar _variableSelector = require('./directives/variableSelector.js');\n\nvar _variableSelector2 = _interopRequireDefault(_variableSelector);\n\nvar _variableClickOutside = require('./directives/variableClickOutside.js');\n\nvar _variableClickOutside2 = _interopRequireDefault(_variableClickOutside);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar MODULE_NAME = 'clearcode.tm.variable';\nvar MODULE_DIR = 'app/modules/variable';\n\nvar CONDITION_MODULE_NAME = 'clearcode.tm.condition';\n\n_ManageController2.default.$inject = ['ngTableParams', '$stateParams', MODULE_NAME + '.variableResource', 'clearcode.tm.alert.alert', 'clearcode.tm.tagContainer.paramConverter', 'clearcode.tm.tagContainer.currentContainer', 'clearcode.tm.pageInfo.pageInfo', '$scope', '$state', '$translate'];\n\n_SelectorController2.default.$inject = ['$compile', '$scope', MODULE_NAME + '.variableSelector', CONDITION_MODULE_NAME + '.condition'];\n\n_CreateController2.default.$inject = [MODULE_NAME + '.variableResource', MODULE_NAME + '.variableTypeResource', 'clearcode.tm.pageInfo.pageInfo', '$scope', MODULE_NAME + '.$variableForm', 'clearcode.tm.tagContainer.currentContainer', '$stateParams', 'clearcode.tm.alert.alert', '$state', '$translate', 'clearcode.tm.condition.condition'];\n\n_EditController2.default.$inject = [MODULE_NAME + '.variableResource', MODULE_NAME + '.variableTypeResource', 'clearcode.tm.pageInfo.pageInfo', '$scope', MODULE_NAME + '.$variableForm', 'clearcode.tm.tagContainer.currentContainer', '$stateParams', 'clearcode.tm.alert.alert', '$state', '$translate', 'clearcode.tm.condition.condition'];\n\n_VariableResource2.default.$inject = ['$http', '$q'];\n\n_variableClickOutside2.default.$inject = ['$document'];\n\n_VariableTypeResource2.default.$inject = ['$http', '$q'];\n\nangular.module(MODULE_NAME, ['pascalprecht.translate', 'ui.router', 'ngTable', 'clearcode.tm.alert', 'clearcode.tm.pageInfo', 'clearcode.tm.tagContainer']).config(['$stateProvider', function ($stateProvider) {\n    $stateProvider.state('variables', {\n        url: '/containers/{containerId}/variables',\n        controller: MODULE_NAME + '.ManageController as view',\n        templateUrl: MODULE_DIR + '/views/manage.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: true\n        }\n    }).state('variableCreate', {\n        url: '/containers/{containerId}/variable-create',\n        controller: MODULE_NAME + '.CreateController as view',\n        templateUrl: MODULE_DIR + '/views/create.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: true\n        }\n    }).state('variableEdit', {\n        url: '/containers/{containerId}/variable-edit/{variableId}',\n        controller: MODULE_NAME + '.EditController as view',\n        templateUrl: MODULE_DIR + '/views/edit.html',\n        data: {\n            roles: ['ROLE_SUPER_ADMIN'],\n            hasContainerList: true\n        }\n    });\n}]).run(['clearcode.tm.alert.$alert', function ($alertProvider) {\n    $alertProvider.addMessagePattern('variables.close', 'You are trying to close unsaved variable.');\n}]).controller(MODULE_NAME + '.ManageController', _ManageController2.default).controller(MODULE_NAME + '.CreateController', _CreateController2.default).controller(MODULE_NAME + '.EditController', _EditController2.default).controller(MODULE_NAME + '.SelectorController', _SelectorController2.default).service(MODULE_NAME + '.variableResource', _VariableResource2.default).service(MODULE_NAME + '.variableTypeResource', _VariableTypeResource2.default).provider(MODULE_NAME + '.$variableForm', _VariableFormProvider2.default).service(MODULE_NAME + '.variableSelector', _VariableSelector2.default).directive('variableSelector', _variableSelector2.default).directive('variableClickOutside', _variableClickOutside2.default);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./controllers/CreateController.js\":82,\"./controllers/EditController.js\":83,\"./controllers/ManageController.js\":84,\"./controllers/SelectorController\":85,\"./directives/variableClickOutside.js\":86,\"./directives/variableSelector.js\":87,\"./providers/VariableFormProvider.js\":90,\"./resource/VariableResource.js\":91,\"./resource/VariableTypeResource.js\":92,\"./services/VariableSelector.js\":93}],95:[function(require,module,exports){\n'use strict';\n\nvar _AlertProvider = require('./providers/AlertProvider.js');\n\nvar _AlertProvider2 = _interopRequireDefault(_AlertProvider);\n\nvar _AlertController = require('./controllers/AlertController.js');\n\nvar _AlertController2 = _interopRequireDefault(_AlertController);\n\nvar _AlertDirective = require('./directives/AlertDirective.js');\n\nvar _AlertDirective2 = _interopRequireDefault(_AlertDirective);\n\nvar _Alert = require('./services/Alert.js');\n\nvar _Alert2 = _interopRequireDefault(_Alert);\n\nvar _RefreshAlert = require('./services/RefreshAlert.js');\n\nvar _RefreshAlert2 = _interopRequireDefault(_RefreshAlert);\n\nvar _AlertStorage = require('./services/AlertStorage.js');\n\nvar _AlertStorage2 = _interopRequireDefault(_AlertStorage);\n\nvar _UniqueStorage = require('./services/UniqueStorage.js');\n\nvar _UniqueStorage2 = _interopRequireDefault(_UniqueStorage);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar MODULE_NAME = 'clearcode.tm.alert'; /**\n                                         * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                         *\n                                         * This program is free software: you can redistribute it and/or modify it under\n                                         * the terms of the GNU Affero General Public License as published by the Free\n                                         * Software Foundation, either version 3 of the License, or (at your option) any\n                                         * later version.\n                                         *\n                                         * This program is distributed in the hope that it will be useful,\n                                         * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                         * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                         * GNU Affero General Public License for more details.\n                                         *\n                                         * You should have received a copy of the GNU Affero General Public License\n                                         * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                         */\n\n_Alert2.default.$inject = ['$timeout', MODULE_NAME + '.alertStorage', MODULE_NAME + '.$alert', '$translate'];\n\n_RefreshAlert2.default.$inject = ['$timeout', MODULE_NAME + '.alertStorage', MODULE_NAME + '.$alert', '$translate', '$window'];\n\n_AlertDirective2.default.$inject = [MODULE_NAME + '.alert', MODULE_NAME + '.$alert', '$window'];\n\n_AlertController2.default.$inject = [MODULE_NAME + '.alertStorage'];\n\nangular.module(MODULE_NAME, ['pascalprecht.translate', 'ngSanitize', 'ngAnimate']).provider(MODULE_NAME + '.$alert', _AlertProvider2.default).factory(MODULE_NAME + '.alertStorage', function () {\n    return new _AlertStorage2.default();\n}).factory(MODULE_NAME + '.alertUniqueStorage', function () {\n    return new _UniqueStorage2.default();\n}).service(MODULE_NAME + '.alert', _Alert2.default).service(MODULE_NAME + '.refreshAlert', _RefreshAlert2.default).directive('ccNotification', _AlertDirective2.default).controller(MODULE_NAME + '.AlertController', _AlertController2.default);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./controllers/AlertController.js\":96,\"./directives/AlertDirective.js\":97,\"./providers/AlertProvider.js\":98,\"./services/Alert.js\":99,\"./services/AlertStorage.js\":100,\"./services/RefreshAlert.js\":101,\"./services/UniqueStorage.js\":102}],96:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name alert#AlertController\n * @namespace clearcode.tm.form\n */\nvar AlertController = function () {\n    /**\n     * @param {AlertStorage} storage\n     */\n    function AlertController(AlertStorage) {\n        _classCallCheck(this, AlertController);\n\n        this.storage = AlertStorage;\n    }\n\n    _createClass(AlertController, [{\n        key: \"getAll\",\n        value: function getAll() {\n            return this.storage.getAlerts();\n        }\n    }, {\n        key: \"remove\",\n        value: function remove(id) {\n            this.storage.remove(id);\n        }\n    }, {\n        key: \"clear\",\n        value: function clear() {\n            this.storage.clean();\n        }\n    }]);\n\n    return AlertController;\n}();\n\nexports.default = AlertController;\n\n},{}],97:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name alert#AlertDirective\n * @namespace clearcode.tm.alert\n */\n\nvar alertDirective = function alertDirective(Alert, alertProvider) {\n    return {\n        restrict: 'E',\n        templateUrl: 'modules/alert/views/alert.html',\n        scope: {\n            interval: '='\n        },\n        controller: 'clearcode.tm.alert.AlertController',\n        controllerAs: 'alertCtrl',\n        link: function link(scope) {\n            Alert.settings.interval = angular.isDefined(scope.interval) ? scope.interval : alertProvider.interval;\n        }\n    };\n};\n\nexports.default = alertDirective;\n\n},{}],98:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name alert#AlertProvider\n * @namespace clearcode.tm.alert\n */\n/* eslint-disable */\nvar AlertProvider = function () {\n    function AlertProvider() {\n        _classCallCheck(this, AlertProvider);\n\n        this.interval = 6000;\n        this.messagePatterns = {};\n    }\n\n    /**\n     * @description Add message pattern\n     *\n     * @param {String} id\n     * @param {String} pattern\n     * @returns {AlertProvider}\n     */\n\n\n    _createClass(AlertProvider, [{\n        key: 'addMessagePattern',\n        value: function addMessagePattern(id, pattern) {\n            if (this.messagePatterns[id] !== undefined) {\n                throw new Error('Pattern with provided id already exist');\n            }\n\n            this.messagePatterns[id] = pattern;\n\n            return this;\n        }\n\n        /**\n         * @description Add message patterns from array of objects\n         *\n         * @param {Array} patterns\n         * @returns {AlertProvider}\n         */\n\n    }, {\n        key: 'addMessagesPattern',\n        value: function addMessagesPattern(patterns) {\n            var _this = this;\n\n            if (!angular.isArray(patterns)) {\n                throw new Error('AlertProvider.addMessagesPattern expects\\n                 first argument to be Array but received ' + (typeof patterns === 'undefined' ? 'undefined' : _typeof(patterns)));\n            }\n\n            angular.forEach(patterns, function (obj) {\n                if (angular.isObject(obj)) {\n                    angular.forEach(obj, function (elem, key) {\n                        _this.addMessagePattern(key, elem);\n                    });\n                }\n            });\n\n            return this;\n        }\n\n        /**\n         * @description Get specific message pattern by id\n         *\n         * @param {String} id\n         * @returns {String|Boolean}\n         */\n\n    }, {\n        key: 'getMessagePattern',\n        value: function getMessagePattern(id) {\n            if (this.messagePatterns[id] !== undefined) {\n                return this.messagePatterns[id];\n            }\n\n            return false;\n        }\n    }, {\n        key: '$get',\n        value: function $get() {\n            return this;\n        }\n    }]);\n\n    return AlertProvider;\n}();\n/* eslint-enable */\n\n\nexports.default = AlertProvider;\n\n},{}],99:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar removeAfterTimeout = function removeAfterTimeout(id) {\n    var _this = this;\n\n    if (this.settings.interval > 0) {\n        return this.$timeout(function () {\n            _this.storage.remove(id);\n        }, this.settings.interval);\n    }\n};\n\nvar addAlert = function addAlert(type, pattern, params) {\n    var _this2 = this;\n\n    var id = void 0,\n        message = this.convertToMessage(pattern, params);\n\n    this.translate([message]).then(function (translations) {\n        id = _this2.storage.add(type, translations[message]);\n        removeAfterTimeout.call(_this2, id);\n\n        return id;\n    });\n};\n\nvar Alert = function () {\n    function Alert($timeout, storage, provider, $translate) {\n        _classCallCheck(this, Alert);\n\n        /**\n         * @type {AlertStorage}\n         */\n        this.storage = storage;\n        /**\n         * @type {Object}\n         */\n        this.$timeout = $timeout;\n        /**\n         * @type {TranslationProvider}\n         */\n        this.settings = this.settings === undefined ? provider : angular.extend(this.settings, provider);\n\n        /**\n         * @readonly\n         * @type {string}\n         */\n        this.INFO_TYPE = 'info';\n\n        /**\n         * @readonly\n         * @type {string}\n         */\n        this.ERROR_TYPE = 'danger';\n\n        /**\n         * @readonly\n         * @type {string}\n         */\n        this.SUCCESS_TYPE = 'success';\n\n        /**\n         * @readonly\n         * @type {$translate}\n         */\n        this.translate = $translate;\n    }\n\n    _createClass(Alert, [{\n        key: 'success',\n        value: function success(id) {\n            var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n            addAlert.call(this, this.SUCCESS_TYPE, id, params);\n        }\n    }, {\n        key: 'error',\n        value: function error(id) {\n            var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n            addAlert.call(this, this.ERROR_TYPE, id, params);\n        }\n    }, {\n        key: 'info',\n        value: function info(id) {\n            var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n            addAlert.call(this, this.INFO_TYPE, id, params);\n        }\n    }, {\n        key: 'getStorage',\n        value: function getStorage() {\n            return this.storage;\n        }\n    }, {\n        key: 'convertToMessage',\n        value: function convertToMessage(pattern, params) {\n            if (angular.isDefined(pattern)) {\n                pattern = this.settings.getMessagePattern(pattern);\n            }\n\n            return vsprintf(pattern, params);\n        }\n    }]);\n\n    return Alert;\n}();\n\nexports.default = Alert;\n\n},{}],100:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar indicator = void 0;\n\nvar AlertStorage = function () {\n    function AlertStorage() {\n        _classCallCheck(this, AlertStorage);\n\n        indicator = 0;\n        this.collection = {};\n    }\n\n    _createClass(AlertStorage, [{\n        key: \"getAlerts\",\n        value: function getAlerts() {\n            return this.collection;\n        }\n    }, {\n        key: \"getAlert\",\n        value: function getAlert(id) {\n            return this.collection[id];\n        }\n    }, {\n        key: \"add\",\n        value: function add(type, message) {\n            this.collection[indicator] = {\n                type: type,\n                message: message\n            };\n\n            return indicator++;\n        }\n    }, {\n        key: \"has\",\n        value: function has(type, message) {\n            for (var alert in this.collection) {\n                if (type === this.collection[alert].type && message === this.collection[alert].message) {\n                    return true;\n                }\n            }\n\n            return false;\n        }\n    }, {\n        key: \"remove\",\n        value: function remove(id) {\n            if (this.collection[id] === undefined) {\n                return false;\n            }\n\n            delete this.collection[id];\n\n            return true;\n        }\n    }, {\n        key: \"clean\",\n        value: function clean() {\n            this.collection = {};\n        }\n    }]);\n\n    return AlertStorage;\n}();\n\nexports.default = AlertStorage;\n\n},{}],101:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _Alert2 = require('./Alert.js');\n\nvar _Alert3 = _interopRequireDefault(_Alert2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n/**\n * @name alert#RefreshAlert\n * @namespace clearcode.tm.alert\n */\nvar RefreshAlert = function (_Alert) {\n    _inherits(RefreshAlert, _Alert);\n\n    function RefreshAlert($timeout, storage, provider, $translate, $window) {\n        _classCallCheck(this, RefreshAlert);\n\n        var _this = _possibleConstructorReturn(this, (RefreshAlert.__proto__ || Object.getPrototypeOf(RefreshAlert)).call(this, $timeout, storage, provider, $translate));\n\n        _this.window = $window;\n        return _this;\n    }\n\n    /**\n     * Add success message after refresh page\n     *\n     * @param localStorageKey\n     * @param message\n     */\n\n\n    _createClass(RefreshAlert, [{\n        key: 'success',\n        value: function success(localStorageKey, message) {\n            if (this.window.localStorage[localStorageKey]) {\n                _get(RefreshAlert.prototype.__proto__ || Object.getPrototypeOf(RefreshAlert.prototype), 'success', this).call(this, message);\n                this.window.localStorage.removeItem(localStorageKey);\n            }\n        }\n    }]);\n\n    return RefreshAlert;\n}(_Alert3.default);\n\nexports.default = RefreshAlert;\n\n},{\"./Alert.js\":99}],102:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _AlertStorage2 = require('./AlertStorage.js');\n\nvar _AlertStorage3 = _interopRequireDefault(_AlertStorage2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n/**\n * @name alert#UniqueStorage\n * @namespace clearcode.tm.alert\n */\nvar UniqueStorage = function (_AlertStorage) {\n  _inherits(UniqueStorage, _AlertStorage);\n\n  function UniqueStorage() {\n    _classCallCheck(this, UniqueStorage);\n\n    return _possibleConstructorReturn(this, (UniqueStorage.__proto__ || Object.getPrototypeOf(UniqueStorage)).apply(this, arguments));\n  }\n\n  _createClass(UniqueStorage, [{\n    key: 'add',\n\n    /**\n     * @description Add alert to collection\n     *\n     * @param {String} type\n     * @param {String} message\n     * @returns {Number}\n     */\n    value: function add(type, message) {\n      if (this.has(type, message)) {\n        return -1;\n      }\n      return _get(UniqueStorage.prototype.__proto__ || Object.getPrototypeOf(UniqueStorage.prototype), 'add', this).call(this, type, message);\n    }\n  }]);\n\n  return UniqueStorage;\n}(_AlertStorage3.default);\n\nexports.default = UniqueStorage;\n\n},{\"./AlertStorage.js\":100}],103:[function(require,module,exports){\n'use strict';\n\nvar _clipboardDirective = require('./directives/clipboardDirective.js');\n\nvar _clipboardDirective2 = _interopRequireDefault(_clipboardDirective);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar MODULE_NAME = 'clearcode.tm.clipboard'; /**\n                                             * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                             *\n                                             * This program is free software: you can redistribute it and/or modify it under\n                                             * the terms of the GNU Affero General Public License as published by the Free\n                                             * Software Foundation, either version 3 of the License, or (at your option) any\n                                             * later version.\n                                             *\n                                             * This program is distributed in the hope that it will be useful,\n                                             * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                             * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                             * GNU Affero General Public License for more details.\n                                             *\n                                             * You should have received a copy of the GNU Affero General Public License\n                                             * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                             */\n\n_clipboardDirective2.default.$inject = ['$compile', '$document'];\n\nangular.module(MODULE_NAME, ['ngClipboard']).directive('ccClipboard', _clipboardDirective2.default);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./directives/clipboardDirective.js\":104}],104:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar clipboardDirective = function clipboardDirective($compile, $document) {\n    return {\n        restrict: 'A',\n        scope: {\n            ngModel: '='\n        },\n        link: function link(scope, element) {\n            element.wrap('<div class=\"cc-clipboard\"></div>');\n\n            var template = angular.element($document[0].getElementById('clipboard.html')).html(),\n                tplElement = $compile(template)(scope),\n                clipboard = element.parent();\n\n            clipboard.append(tplElement);\n\n            var button = clipboard.find('button');\n\n            button.addClass('hidden');\n\n            clipboard.on('mouseenter', setCopyButtonVisible(true)).on('mouseleave', setCopyButtonVisible(false));\n\n            scope.copyToClipboard = function () {\n                return scope.ngModel;\n            };\n\n            function setCopyButtonVisible(setVisible) {\n                return function (event) {\n                    if (!eventTriggeredOverTextArea(event)) {\n                        return;\n                    }\n\n                    if (setVisible) {\n                        button.removeClass('hidden');\n                    } else {\n                        button.addClass('hidden');\n                    }\n                };\n            }\n\n            function eventTriggeredOverTextArea(event) {\n                var target = event.target || event.srcElement;\n                return target && target.nodeName === 'TEXTAREA';\n            }\n        }\n    };\n};\n\nexports.default = clipboardDirective;\n\n},{}],105:[function(require,module,exports){\n'use strict';\n\nvar _ConfirmDirective = require('./directives/ConfirmDirective.js');\n\nvar _ConfirmDirective2 = _interopRequireDefault(_ConfirmDirective);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar MODULE_NAME = 'clearcode.tm.confirm'; /**\n                                           * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                           *\n                                           * This program is free software: you can redistribute it and/or modify it under\n                                           * the terms of the GNU Affero General Public License as published by the Free\n                                           * Software Foundation, either version 3 of the License, or (at your option) any\n                                           * later version.\n                                           *\n                                           * This program is distributed in the hope that it will be useful,\n                                           * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                           * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                           * GNU Affero General Public License for more details.\n                                           *\n                                           * You should have received a copy of the GNU Affero General Public License\n                                           * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                           */\n\nangular.module(MODULE_NAME, []).directive('ccConfirm', _ConfirmDirective2.default);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./directives/ConfirmDirective.js\":106}],106:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar confirmDirective = function confirmDirective() {\n    return {\n        restrict: 'A',\n        templateUrl: 'modules/confirm/views/confirm.html',\n        transclude: true,\n        replace: true,\n        scope: {\n            ccConfirm: '&'\n        },\n        link: function link(scope) {\n            scope.turnOn = false;\n\n            scope.approve = function () {\n                scope.ccConfirm();\n            };\n\n            scope.cancel = function () {\n                scope.turnOn = false;\n            };\n\n            scope.confirm = function () {\n                scope.turnOn = true;\n            };\n        }\n    };\n};\n\nexports.default = confirmDirective;\n\n},{}],107:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _AlertController2 = require('../../alert/controllers/AlertController.js');\n\nvar _AlertController3 = _interopRequireDefault(_AlertController2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n/**\n * @name alert#AlertFormController\n * @namespace clearcode.tm.alert\n */\nvar AlertFormController = function (_AlertController) {\n  _inherits(AlertFormController, _AlertController);\n\n  function AlertFormController() {\n    _classCallCheck(this, AlertFormController);\n\n    return _possibleConstructorReturn(this, (AlertFormController.__proto__ || Object.getPrototypeOf(AlertFormController)).apply(this, arguments));\n  }\n\n  return AlertFormController;\n}(_AlertController3.default);\n\nexports.default = AlertFormController;\n\n},{\"../../alert/controllers/AlertController.js\":96}],108:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name form#AlertFormDirective\n * @namespace clearcode.tm.form\n */\n\nvar alertFormDirective = function alertFormDirective(Alert, alertProvider) {\n    return {\n        restrict: 'E',\n        templateUrl: 'modules/form/views/alertForm.html',\n        scope: {\n            interval: '='\n        },\n        controller: 'clearcode.tm.form.AlertFormController',\n        controllerAs: 'alertFormCtrl',\n        link: function link(scope) {\n            Alert.settings.interval = angular.isDefined(scope.interval) ? scope.interval : alertProvider.interval;\n        }\n    };\n};\n\nexports.default = alertFormDirective;\n\n},{}],109:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name form#CheckboxDirective\n * @namespace clearcode.tm.form\n */\nvar CheckboxDirective = function CheckboxDirective() {\n    return {\n        restrict: 'A',\n        require: '?ngModel',\n        scope: {\n            ngModel: '=',\n            ngDisabled: '='\n        },\n        link: function link(scope, element, attrs) {\n            var checkedClass = 'cc-checkbox-checked',\n                disabledClass = 'cc-checkbox-disabled';\n\n            element.wrap('<div class=\"cc-checkbox\"></div>');\n\n            if (scope.ngModel !== undefined) {\n                updateViewFromValue(scope.ngModel);\n            }\n\n            scope.$watch('ngModel', updateViewFromValue);\n\n            scope.$watch('ngDisabled', function (isDisabled) {\n                if (isDisabled) {\n                    element.parent().addClass(disabledClass);\n                } else {\n                    element.parent().removeClass(disabledClass);\n                }\n            });\n\n            function updateViewFromValue(value) {\n                if (value === true || isEqualToCustomTrueValue(value)) {\n                    element.parent().addClass(checkedClass);\n                } else {\n                    element.parent().removeClass(checkedClass);\n                }\n            }\n\n            function isEqualToCustomTrueValue(value) {\n                return attrs.ngTrueValue !== undefined && value === attrs.ngTrueValue;\n            }\n        }\n    };\n};\n\nexports.default = CheckboxDirective;\n\n},{}],110:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name form#CheckboxDirective\n * @namespace clearcode.tm.form\n */\n/* eslint-disable */\nvar RadioButtonDirective = function RadioButtonDirective() {\n\n    return {\n        restrict: 'A',\n        require: '?ccRadioModel',\n        scope: {\n            ccRadioModel: '=',\n            ccDisabled: '='\n        },\n        link: function link(scope, element, attrs) {\n\n            element.wrap('<div class=\"cc-radio\"></div>');\n\n            if (scope.ccRadioModel !== undefined) {\n\n                if (scope.ccDisabled) {\n\n                    element.parent().addClass('radioDisabled');\n                }\n\n                if (scope.ccRadioModel === element[0].defaultValue) {\n\n                    element.parent().addClass('radioSelected');\n                } else {\n\n                    element.parent().removeClass('radioSelected');\n                }\n            }\n\n            scope.$watch('ccRadioModel', function (value) {\n\n                if (value === element[0].defaultValue) {\n\n                    element.parent().addClass('radioSelected');\n                } else {\n\n                    element.parent().removeClass('radioSelected');\n                }\n            });\n        }\n    };\n};\n/* eslint-enable */\n\nexports.default = RadioButtonDirective;\n\n},{}],111:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name form#SelectDirective\n * @namespace clearcode.tm.form\n */\n\nvar SelectDirective = function SelectDirective($compile) {\n    return {\n        restrict: 'A',\n        priority: 1,\n        scope: {\n            ngModel: '=',\n            ccSelectOptions: '=',\n            ccSelectValue: '@',\n            ccSelectLabel: '@'\n        },\n        link: function link(scope, element, attrs) {\n            /* eslint-disable */\n            element.wrap('<div class=\"cc-select\"></div>');\n            /* eslint-enable */\n            element.addClass('ng-hide');\n\n            var template = angular.element(document.getElementById('select-template.html')).html();\n            var tmpElement = $compile(template)(scope);\n\n            element.parent().append(tmpElement);\n\n            scope.id = attrs.id;\n\n            var searchByValue = function searchByValue(value) {\n                for (var index in scope.ccSelectOptions) {\n                    if (scope.ccSelectOptions[index][scope.ccSelectValue] === value) {\n                        return index;\n                    }\n                }\n\n                return false;\n            };\n\n            scope.getActiveOptionLabel = function () {\n                var index = searchByValue(scope.ngModel);\n\n                if (index !== false) {\n                    return scope.ccSelectOptions[index][scope.ccSelectLabel];\n                } else {\n                    return '';\n                }\n            };\n\n            scope.changeSelection = function (element) {\n                scope.ngModel = element[scope.ccSelectValue];\n            };\n        }\n    };\n};\n\nexports.default = SelectDirective;\n\n},{}],112:[function(require,module,exports){\n'use strict';\n\nvar _CheckboxDirective = require('./directives/CheckboxDirective.js');\n\nvar _CheckboxDirective2 = _interopRequireDefault(_CheckboxDirective);\n\nvar _RadioButtonDirective = require('./directives/RadioButtonDirective.js');\n\nvar _RadioButtonDirective2 = _interopRequireDefault(_RadioButtonDirective);\n\nvar _SelectDirective = require('./directives/SelectDirective.js');\n\nvar _SelectDirective2 = _interopRequireDefault(_SelectDirective);\n\nvar _AlertForm = require('./services/AlertForm.js');\n\nvar _AlertForm2 = _interopRequireDefault(_AlertForm);\n\nvar _AlertFormDirective = require('./directives/AlertFormDirective.js');\n\nvar _AlertFormDirective2 = _interopRequireDefault(_AlertFormDirective);\n\nvar _AlertFormController = require('./controller/AlertFormController.js');\n\nvar _AlertFormController2 = _interopRequireDefault(_AlertFormController);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar MODULE_NAME = 'clearcode.tm.form';\n\n_AlertForm2.default.$inject = ['$timeout', 'clearcode.tm.alert.alertUniqueStorage', 'clearcode.tm.alert.$alert', '$translate'];\n\n_AlertFormDirective2.default.$inject = [MODULE_NAME + '.alertForm', 'clearcode.tm.alert.$alert'];\n\n_AlertFormController2.default.$inject = ['clearcode.tm.alert.alertUniqueStorage'];\n\n_SelectDirective2.default.$inject = ['$compile'];\n\nangular.module(MODULE_NAME, ['pascalprecht.translate', 'clearcode.tm.alert']).service(MODULE_NAME + '.alertForm', _AlertForm2.default).directive('ccSelect', _SelectDirective2.default).directive('ccCheckbox', _CheckboxDirective2.default).directive('ccRadio', _RadioButtonDirective2.default).directive('ccNotificationForm', _AlertFormDirective2.default).controller(MODULE_NAME + '.AlertFormController', _AlertFormController2.default);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./controller/AlertFormController.js\":107,\"./directives/AlertFormDirective.js\":108,\"./directives/CheckboxDirective.js\":109,\"./directives/RadioButtonDirective.js\":110,\"./directives/SelectDirective.js\":111,\"./services/AlertForm.js\":113}],113:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _Alert2 = require('../../alert/services/Alert.js');\n\nvar _Alert3 = _interopRequireDefault(_Alert2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is free software: you can redistribute it and/or modify it under\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * the terms of the GNU Affero General Public License as published by the Free\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Software Foundation, either version 3 of the License, or (at your option) any\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * later version.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * This program is distributed in the hope that it will be useful,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * GNU Affero General Public License for more details.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You should have received a copy of the GNU Affero General Public License\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n/**\n * @name alert#AlertForm\n * @namespace clearcode.tm.form\n */\n\nvar AlertForm = function (_Alert) {\n  _inherits(AlertForm, _Alert);\n\n  function AlertForm() {\n    _classCallCheck(this, AlertForm);\n\n    return _possibleConstructorReturn(this, (AlertForm.__proto__ || Object.getPrototypeOf(AlertForm)).apply(this, arguments));\n  }\n\n  return AlertForm;\n}(_Alert3.default);\n\nexports.default = AlertForm;\n\n},{\"../../alert/services/Alert.js\":99}],114:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name helpSystem#HelpSystemDirective\n * @namespace clearcode.tm.helpSystem\n */\n\nvar helpSystemDirective = function helpSystemDirective() {\n  return {\n    restrict: 'EA',\n    replace: true,\n    scope: { content: '@', placement: '@' },\n    templateUrl: 'modules/helpSystem/views/helpSystem.html'\n  };\n};\n\nexports.default = helpSystemDirective;\n\n},{}],115:[function(require,module,exports){\n'use strict';\n\nvar _HelpSystemDirective = require('./directives/HelpSystemDirective.js');\n\nvar _HelpSystemDirective2 = _interopRequireDefault(_HelpSystemDirective);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar MODULE_NAME = 'clearcode.tm.helpSystem'; /**\n                                              * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                              *\n                                              * This program is free software: you can redistribute it and/or modify it under\n                                              * the terms of the GNU Affero General Public License as published by the Free\n                                              * Software Foundation, either version 3 of the License, or (at your option) any\n                                              * later version.\n                                              *\n                                              * This program is distributed in the hope that it will be useful,\n                                              * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                              * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                              * GNU Affero General Public License for more details.\n                                              *\n                                              * You should have received a copy of the GNU Affero General Public License\n                                              * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                              */\n\nangular.module(MODULE_NAME, []).directive('ccHelp', _HelpSystemDirective2.default);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./directives/HelpSystemDirective.js\":114}],116:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @type {$state}\n */\nvar state;\n\nvar BreadcrumbController = function () {\n  /**\n   * @param PageInfo\n   */\n  function BreadcrumbController(scope, $state, PageInfo) {\n    var _this = this;\n\n    _classCallCheck(this, BreadcrumbController);\n\n    this.breadcrumb = PageInfo.get();\n    state = $state;\n\n    scope.$on('page.info', function () {\n      _this.breadcrumb = PageInfo.get();\n    });\n  }\n\n  /**\n   * @param breadcrumb\n   */\n\n\n  _createClass(BreadcrumbController, [{\n    key: 'stateGo',\n    value: function stateGo(breadcrumb) {\n      state.go(breadcrumb.state, breadcrumb.params);\n    }\n  }]);\n\n  return BreadcrumbController;\n}();\n\nexports.default = BreadcrumbController;\n\n},{}],117:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @type {String}\n */\nvar DEFAULT_TITLE = 'Impono Tag Manager';\n\nvar TitleController = function () {\n    /**\n     * @param {Object} scope\n     * @param PageInfo\n     */\n    function TitleController(scope, PageInfo) {\n        var _this = this;\n\n        _classCallCheck(this, TitleController);\n\n        this.title = DEFAULT_TITLE;\n        this.default = DEFAULT_TITLE;\n\n        scope.$on('page.info', function () {\n            _this.info = PageInfo.get();\n            _this.setTitle();\n        });\n    }\n\n    _createClass(TitleController, [{\n        key: 'setTitle',\n        value: function setTitle() {\n            /* eslint-disable */\n            this.title = this.info.map(function (element) {\n                return element.name;\n            }).reduce(function (previous, current) {\n                return previous += ' - ' + current;\n            });\n            /* eslint-enable */\n        }\n    }]);\n\n    return TitleController;\n}();\n\nexports.default = TitleController;\n\n},{}],118:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name pageInfo#BreadcrumbDirective\n * @namespace clearcode.tm.pageInfo\n */\nvar breadcrumbDirective = function breadcrumbDirective() {\n  return {\n    restrict: 'E',\n    templateUrl: 'modules/pageInfo/views/breadcrumb.html',\n    controller: 'clearcode.tm.pageInfo.BreadcrumbController',\n    controllerAs: 'breadcrumbCtrl'\n  };\n};\n\nexports.default = breadcrumbDirective;\n\n},{}],119:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name pageInfo#TitleDirective\n * @namespace clearcode.tm.pageInfo\n */\nvar titleDirective = function titleDirective() {\n  return {\n    restrict: 'A',\n    controller: 'clearcode.tm.pageInfo.TitleController',\n    controllerAs: 'titleCtrl'\n  };\n};\n\nexports.default = titleDirective;\n\n},{}],120:[function(require,module,exports){\n'use strict';\n\nvar _BreadcrumbController = require('./controllers/BreadcrumbController.js');\n\nvar _BreadcrumbController2 = _interopRequireDefault(_BreadcrumbController);\n\nvar _TitleController = require('./controllers/TitleController.js');\n\nvar _TitleController2 = _interopRequireDefault(_TitleController);\n\nvar _BreadcrumbDirective = require('./directives/BreadcrumbDirective.js');\n\nvar _BreadcrumbDirective2 = _interopRequireDefault(_BreadcrumbDirective);\n\nvar _PageInfo = require('./services/PageInfo.js');\n\nvar _PageInfo2 = _interopRequireDefault(_PageInfo);\n\nvar _TitleDirective = require('./directives/TitleDirective.js');\n\nvar _TitleDirective2 = _interopRequireDefault(_TitleDirective);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar MODULE_NAME = 'clearcode.tm.pageInfo'; /**\n                                            * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                            *\n                                            * This program is free software: you can redistribute it and/or modify it under\n                                            * the terms of the GNU Affero General Public License as published by the Free\n                                            * Software Foundation, either version 3 of the License, or (at your option) any\n                                            * later version.\n                                            *\n                                            * This program is distributed in the hope that it will be useful,\n                                            * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                            * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                            * GNU Affero General Public License for more details.\n                                            *\n                                            * You should have received a copy of the GNU Affero General Public License\n                                            * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                            */\n\n_BreadcrumbController2.default.$inject = ['$scope', '$state', MODULE_NAME + '.pageInfo'];\n\n_TitleController2.default.$inject = ['$scope', MODULE_NAME + '.pageInfo'];\n\n_PageInfo2.default.$inject = ['$rootScope'];\n\nangular.module(MODULE_NAME, []).controller(MODULE_NAME + '.BreadcrumbController', _BreadcrumbController2.default).controller(MODULE_NAME + '.TitleController', _TitleController2.default).directive('ccBreadcrumb', _BreadcrumbDirective2.default).directive('ccTitle', _TitleDirective2.default).service(MODULE_NAME + '.pageInfo', _PageInfo2.default);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./controllers/BreadcrumbController.js\":116,\"./controllers/TitleController.js\":117,\"./directives/BreadcrumbDirective.js\":118,\"./directives/TitleDirective.js\":119,\"./services/PageInfo.js\":121}],121:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @type {rootScope}\n */\nvar rootScope;\n\nvar PageInfo = function () {\n  /**\n   * @param $rootScope\n   */\n  function PageInfo($rootScope) {\n    _classCallCheck(this, PageInfo);\n\n    this.navigation = [];\n    rootScope = $rootScope;\n  }\n\n  /**\n   * @param name\n   * @param state\n   * @param params\n   *\n   * @return {PageInfo}\n   */\n\n\n  _createClass(PageInfo, [{\n    key: 'add',\n    value: function add(name, state, params) {\n      this.navigation.push({\n        name: name,\n        state: state,\n        params: params\n      });\n\n      return this;\n    }\n\n    /**\n     * @return {PageInfo}\n     */\n\n  }, {\n    key: 'clear',\n    value: function clear() {\n      this.navigation = [];\n\n      return this;\n    }\n\n    /**\n     * Gives signal into breadcrumb and title\n     */\n\n  }, {\n    key: 'broadcast',\n    value: function broadcast() {\n      rootScope.$broadcast('page.info');\n    }\n\n    /**\n     * @return {Array}\n     */\n\n  }, {\n    key: 'get',\n    value: function get() {\n      return this.navigation;\n    }\n  }]);\n\n  return PageInfo;\n}();\n\nexports.default = PageInfo;\n\n},{}],122:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * Math.ceil in angular filter\n *\n * @returns {Function}\n */\nvar tmCeilFilter = function tmCeilFilter() {\n  return function (number) {\n    return Math.ceil(number);\n  };\n};\n\nexports.default = tmCeilFilter;\n\n},{}],123:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar tmDateFilter = function tmDateFilter($filter, defaultDateFormat) {\n    var angularDateFilter = $filter('date');\n\n    return function (theDate) {\n        var format = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n        if (format === null) {\n            format = defaultDateFormat;\n        }\n\n        return angularDateFilter(theDate, format);\n    };\n};\n\nexports.default = tmDateFilter;\n\n},{}],124:[function(require,module,exports){\n'use strict';\n\nvar _tmDateFilter = require('./filters/tmDateFilter.js');\n\nvar _tmDateFilter2 = _interopRequireDefault(_tmDateFilter);\n\nvar _tmCeilFilter = require('./filters/tmCeilFilter.js');\n\nvar _tmCeilFilter2 = _interopRequireDefault(_tmCeilFilter);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar MODULE_NAME = 'clearcode.tm.sanitize';\n\n_tmDateFilter2.default.$inject = ['$filter', 'defaultDateFormat'];\n\nangular.module(MODULE_NAME, []).filter('tmDate', _tmDateFilter2.default).filter('tmCeil', _tmCeilFilter2.default);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./filters/tmCeilFilter.js\":122,\"./filters/tmDateFilter.js\":123}],125:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name HTMLLinter\n */\nvar HTMLLinter = function () {\n    function HTMLLinter($window) {\n        _classCallCheck(this, HTMLLinter);\n\n        this.$window = $window;\n    }\n\n    _createClass(HTMLLinter, [{\n        key: \"lint\",\n        value: function lint(text, lintRules) {\n            return this.$window.HTMLHint ? this.$window.HTMLHint.verify(text, lintRules) : [];\n        }\n    }]);\n\n    return HTMLLinter;\n}();\n\nexports.default = HTMLLinter;\n\n},{}],126:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar HTML_LINT_RULES = {\n    'tagname-lowercase': false,\n    'attr-lowercase': false,\n    'attr-value-double-quotes': false,\n    'attr-value-not-empty': false,\n    'attr-no-duplication': false,\n    'doctype-first': false,\n    'tag-pair': false,\n    'tag-self-close': false,\n    'spec-char-escape': false,\n    'id-unique': false,\n    'src-not-empty': false,\n    'title-require': false,\n    'head-script-disabled': false,\n    'doctype-html5': false,\n    'id-class-value': false,\n    'style-disabled': false,\n    'inline-style-disabled': false,\n    'inline-script-disabled': false,\n    'space-tab-mixed-disabled': false,\n    'id-class-ad-disabled': false,\n    'href-abs-or-rel': false,\n    'attr-unsafe-chars': false\n};\n\nvar JS_LINT_RULES = {\n    browser: true,\n    devel: true,\n    dojo: true,\n    jquery: true,\n    mootools: true,\n    nonstandard: true,\n    prototypejs: true,\n    yui: true,\n    bitwise: false,\n    camelcase: false,\n    curly: true,\n    enforceall: false,\n    eqeqeq: true,\n    es3: false,\n    es5: false,\n    forin: false,\n    freeze: false,\n    funcscope: true,\n    futurehostile: true,\n    immed: false,\n    latedef: false,\n    nocomma: true,\n    nonew: true,\n    notypeof: true,\n    shadow: 'inner',\n    strict: false,\n    sub: false,\n    undef: true,\n    unused: true,\n    asi: true\n};\n\n/**\n * @name LintingRules\n */\n\nvar LintingRules = function () {\n    function LintingRules() {\n        _classCallCheck(this, LintingRules);\n    }\n\n    _createClass(LintingRules, [{\n        key: 'getLintingRules',\n        value: function getLintingRules() {\n            var jsHintRules = angular.copy(JS_LINT_RULES),\n                htmlHintRules = angular.copy(HTML_LINT_RULES);\n\n            htmlHintRules.jshint = jsHintRules;\n\n            return htmlHintRules;\n        }\n    }]);\n\n    return LintingRules;\n}();\n\nexports.default = LintingRules;\n\n},{}],127:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar HTML_HEAD_WRAP_START = '<!DOCTYPE HTML><html><head>';\nvar HTML_HEAD_WRAP_END = '</head><body></body></html>';\n\n/**\n * @name TagTemplateLinter\n */\n\nvar TagTemplateLinter = function () {\n    function TagTemplateLinter(tagTemplateToJsConverter, lintingRules, htmlLinter) {\n        _classCallCheck(this, TagTemplateLinter);\n\n        this.tagTemplateToJsConverter = tagTemplateToJsConverter;\n        this.lintingRules = lintingRules;\n        this.htmlLinter = htmlLinter;\n    }\n\n    _createClass(TagTemplateLinter, [{\n        key: 'validate',\n        value: function validate(text, options, cm) {\n            if (options.deactivate) {\n                return [];\n            }\n\n            var htmlWrappedText = this.wrapInHtmlTag(text),\n                lines = htmlWrappedText.split('\\n');\n\n            this.tagTemplateToJsConverter.convert(lines, cm.options);\n\n            var tagTemplateWithFixedJsText = lines.join('\\n'),\n                allErrors = this.lint(tagTemplateWithFixedJsText, options),\n                jsErrors = this.filterOutHtmlErrors(allErrors, lines.length),\n                errors = [];\n\n            for (var i = 0; i < jsErrors.length; i++) {\n                errors.push(this.mapToLintRepresentation(jsErrors[i]));\n            }\n\n            return errors;\n        }\n    }, {\n        key: 'wrapInHtmlTag',\n        value: function wrapInHtmlTag(text) {\n            return HTML_HEAD_WRAP_START + '\\n                ' + text + '\\n                ' + HTML_HEAD_WRAP_END;\n        }\n    }, {\n        key: 'filterOutHtmlErrors',\n        value: function filterOutHtmlErrors(errors, lineCount) {\n            var jsErrors = [];\n\n            for (var i = 0; i < errors.length; i++) {\n                var error = errors[i];\n\n                if (!this.isHtmlError(error, lineCount)) {\n                    error.line -= 1;\n                    jsErrors.push(error);\n                }\n            }\n\n            return jsErrors;\n        }\n    }, {\n        key: 'isHtmlError',\n        value: function isHtmlError(error, lastLineIdx) {\n            return error.line === 0 || error.line === lastLineIdx;\n        }\n    }, {\n        key: 'lint',\n        value: function lint(text, options) {\n            options = options || {};\n            var lintRules = angular.extend({}, this.lintingRules.getLintingRules(), options);\n\n            return this.htmlLinter.lint(text, lintRules);\n        }\n\n        /* eslint-disable */\n\n    }, {\n        key: 'mapToLintRepresentation',\n        value: function mapToLintRepresentation(message) {\n            return {\n                from: CodeMirror.Pos(message.line - 1, 0),\n                to: CodeMirror.Pos(message.line - 1, 0),\n                message: message.message,\n                severity: message.type\n            };\n        }\n        /* eslint-enable */\n\n    }]);\n\n    return TagTemplateLinter;\n}();\n\nexports.default = TagTemplateLinter;\n\n},{}],128:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar TAG_TEMPLATE_VARIABLE_START = '{{';\nvar TAG_TEMPLATE_VARIABLE_END = '}}';\n\nvar TagTemplateToJsConverter = function () {\n    function TagTemplateToJsConverter() {\n        _classCallCheck(this, TagTemplateToJsConverter);\n    }\n\n    _createClass(TagTemplateToJsConverter, [{\n        key: 'convert',\n        value: function convert(textLines, options) {\n            if (!options || !options.variables) {\n                return textLines;\n            }\n\n            var variables = this.getVariables(options),\n                lineIdx = 0;\n\n            while (!this.isCursorAfterTheEndOfText(textLines.length, lineIdx)) {\n                var line = textLines[lineIdx],\n                    lineContainsVariable = line.indexOf(TAG_TEMPLATE_VARIABLE_START) !== -1;\n\n                if (lineContainsVariable) {\n                    textLines[lineIdx] = this.replaceVariablesExpressions(variables, line);\n                }\n\n                ++lineIdx;\n            }\n\n            return textLines;\n        }\n    }, {\n        key: 'isCursorAfterTheEndOfText',\n        value: function isCursorAfterTheEndOfText(totalLines, line) {\n            return line >= totalLines;\n        }\n    }, {\n        key: 'getVariables',\n        value: function getVariables(options) {\n            var variables = [];\n\n            for (var i = 0; i < options.variables.length; i++) {\n                var variable = options.variables[i],\n                    words = variable.name.trim().split(/\\s+/),\n                    variableObj = {\n                    name: variable.name,\n                    pattern: this.createVariableSearchPattern(variable.name),\n                    replacement: '\\'' + words.join('_') + '\\''\n                };\n\n                variables.push(variableObj);\n            }\n\n            return variables;\n        }\n    }, {\n        key: 'createVariableSearchPattern',\n        value: function createVariableSearchPattern(variableName) {\n            var whitespace = '[\\\\s]',\n                words = variableName.split(/[\\s]+/),\n                regexStr = words.join(whitespace + '+');\n\n            regexStr = '' + TAG_TEMPLATE_VARIABLE_START + whitespace + '*' + regexStr + whitespace + '*' + TAG_TEMPLATE_VARIABLE_END;\n\n            return new RegExp(regexStr, 'g');\n        }\n    }, {\n        key: 'replaceVariablesExpressions',\n        value: function replaceVariablesExpressions(variables, line) {\n            for (var i = 0; i < variables.length; i++) {\n                var variable = variables[i];\n                line = line.replace(variable.pattern, variable.replacement);\n            }\n\n            return line;\n        }\n    }]);\n\n    return TagTemplateToJsConverter;\n}();\n\nexports.default = TagTemplateToJsConverter;\n\n},{}],129:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar DEFAULT_CONFIG = {\n    mode: {\n        name: 'htmlmixed'\n    },\n    lineNumbers: true,\n    styleActiveLine: true,\n    matchBrackets: true,\n    theme: 'stg',\n    gutters: ['CodeMirror-lint-markers'],\n    lint: {}\n};\n\n/**\n * @name TextEditorConfig\n */\n\nvar TextEditorConfig = function () {\n    /**\n     * @param {TagTemplateLinter} tagTemplateLinter\n     */\n    function TextEditorConfig(tagTemplateLinter) {\n        _classCallCheck(this, TextEditorConfig);\n\n        this.tagTemplateLinter = tagTemplateLinter;\n    }\n\n    /**\n     * @param {Object} configOverrides\n     *\n     * @return {Object}\n     */\n\n\n    _createClass(TextEditorConfig, [{\n        key: 'getConfig',\n        value: function getConfig(configOverrides) {\n            var _this = this;\n\n            var overrides = angular.isObject(configOverrides) ? configOverrides : {},\n                cfg = angular.extend({}, DEFAULT_CONFIG, overrides);\n\n            cfg.lint.getAnnotations = function (value, opt, cm) {\n                return _this.tagTemplateLinter.validate(value, opt, cm);\n            };\n\n            return cfg;\n        }\n    }]);\n\n    return TextEditorConfig;\n}();\n\nexports.default = TextEditorConfig;\n\n},{}],130:[function(require,module,exports){\n'use strict';\n\nvar _TextEditorConfig = require('./service/TextEditorConfig.js');\n\nvar _TextEditorConfig2 = _interopRequireDefault(_TextEditorConfig);\n\nvar _TagTemplateLinter = require('./service/TagTemplateLinter.js');\n\nvar _TagTemplateLinter2 = _interopRequireDefault(_TagTemplateLinter);\n\nvar _TagTemplateToJsConverter = require('./service/TagTemplateToJsConverter.js');\n\nvar _TagTemplateToJsConverter2 = _interopRequireDefault(_TagTemplateToJsConverter);\n\nvar _LintingRules = require('./service/LintingRules.js');\n\nvar _LintingRules2 = _interopRequireDefault(_LintingRules);\n\nvar _HTMLLinter = require('./service/HTMLLinter.js');\n\nvar _HTMLLinter2 = _interopRequireDefault(_HTMLLinter);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar MODULE_NAME = 'clearcode.tm.textEditor'; /**\n                                              * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                              *\n                                              * This program is free software: you can redistribute it and/or modify it under\n                                              * the terms of the GNU Affero General Public License as published by the Free\n                                              * Software Foundation, either version 3 of the License, or (at your option) any\n                                              * later version.\n                                              *\n                                              * This program is distributed in the hope that it will be useful,\n                                              * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                              * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                              * GNU Affero General Public License for more details.\n                                              *\n                                              * You should have received a copy of the GNU Affero General Public License\n                                              * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                              */\n\n_TextEditorConfig2.default.$inject = [MODULE_NAME + '.TagTemplateLinter'];\n\n_TagTemplateLinter2.default.$inject = [MODULE_NAME + '.TagTemplateToJsConverter', MODULE_NAME + '.LintingRules', MODULE_NAME + '.HTMLLinter'];\n\n_HTMLLinter2.default.$inject = ['$window'];\n\nangular.module(MODULE_NAME, []).service(MODULE_NAME + '.LintingRules', _LintingRules2.default).service(MODULE_NAME + '.HTMLLinter', _HTMLLinter2.default).service(MODULE_NAME + '.TagTemplateToJsConverter', _TagTemplateToJsConverter2.default).service(MODULE_NAME + '.TagTemplateLinter', _TagTemplateLinter2.default).service(MODULE_NAME + '.TextEditorConfig', _TextEditorConfig2.default).run(['$rootScope', MODULE_NAME + '.TextEditorConfig', function ($rootScope, TextEditorConfig) {\n    $rootScope.TextEditorConfig = TextEditorConfig;\n}]);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./service/HTMLLinter.js\":125,\"./service/LintingRules.js\":126,\"./service/TagTemplateLinter.js\":127,\"./service/TagTemplateToJsConverter.js\":128,\"./service/TextEditorConfig.js\":129}],131:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar translationFactory = function translationFactory($http, $q) {\n    return function (options) {\n        var deferred = $q.defer();\n\n        $http({\n            method: 'GET',\n            url: options.url,\n            cache: options.cache\n        }).success(function (data) {\n            deferred.resolve(data);\n        }).error(function () {\n            deferred.reject();\n        });\n\n        return deferred.promise;\n    };\n};\n\nexports.default = translationFactory;\n\n},{}],132:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar Translation = function () {\n    function Translation(translationFactory) {\n        _classCallCheck(this, Translation);\n\n        this.languages = [];\n        this.translationFactory = translationFactory;\n    }\n\n    /**\n     * @returns {*}\n     */\n\n\n    _createClass(Translation, [{\n        key: 'getLanguages',\n        value: function getLanguages() {\n            return this.languages;\n        }\n\n        /**\n         * @param language\n         * @returns {boolean}\n         */\n\n    }, {\n        key: 'hasLanguage',\n        value: function hasLanguage(language) {\n            return this.languages.hasOwnProperty(language);\n        }\n    }, {\n        key: 'loadAvailableTranslations',\n        value: function loadAvailableTranslations() {\n            var _this = this;\n\n            return this.translationFactory({\n                url: '/api/translations',\n                cache: false\n            }).then(function (data) {\n                for (var key in data) {\n                    _this.languages.push({\n                        id: key,\n                        name: data[key]\n                    });\n                }\n            });\n        }\n    }]);\n\n    return Translation;\n}();\n\nexports.default = Translation;\n\n},{}],133:[function(require,module,exports){\n'use strict';\n\nvar _TranslationFactory = require('./factory/TranslationFactory.js');\n\nvar _TranslationFactory2 = _interopRequireDefault(_TranslationFactory);\n\nvar _Translation = require('./services/Translation.js');\n\nvar _Translation2 = _interopRequireDefault(_Translation);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar MODULE_NAME = 'clearcode.tm.translation';\n\n_TranslationFactory2.default.$inject = ['$http', '$q'];\n\n_Translation2.default.$inject = [MODULE_NAME + '.translationFactory'];\n\nangular.module(MODULE_NAME, []).factory(MODULE_NAME + '.translationFactory', _TranslationFactory2.default).service(MODULE_NAME + '.translation', _Translation2.default);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./factory/TranslationFactory.js\":131,\"./services/Translation.js\":132}],134:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name validator#stgFormDirective\n * @namespace clearcode.tm.validator\n */\n\nvar isPromise = function isPromise(promise) {\n    if ((typeof promise === 'undefined' ? 'undefined' : _typeof(promise)) === 'object' && typeof promise.then === 'function') {\n        return true;\n    }\n\n    return false;\n};\n\nvar stgFormDirective = function stgFormDirective($alertProvider, $alertForm) {\n    return {\n        restrict: 'A',\n        scope: {\n            formResource: '='\n        },\n        link: function link(scope, element) {\n            scope.$watch('formResource', function (formPromise) {\n                if (formPromise && isPromise(formPromise)) {\n                    formPromise.then(function () {}, function (resp) {\n                        if (resp.errors.hasOwnProperty('form')) {\n                            if (!$alertProvider.getMessagePattern('login.server')) {\n                                $alertProvider.addMessagePattern('login.server', resp.errors.form[0]);\n                            }\n\n                            $alertForm.getStorage().clean();\n                            $alertForm.error('login.server');\n                        }\n\n                        for (var field in resp.errors.fields) {\n                            if (resp.errors.fields.hasOwnProperty(field)) {\n                                var form = scope.$parent[element[0].attributes.name.value];\n\n                                if (isNotEmptyArray(resp, field)) {\n                                    form[field].$invalid = true;\n                                    form[field].$setDirty();\n                                    form[field].$error[field] = resp.errors.fields[field];\n                                } else {\n                                    for (var nested in resp.errors.fields[field].fields) {\n                                        if (isNested(resp, field, nested)) {\n                                            form[nested].$invalid = true;\n                                            form[nested].$error[nested] = resp.errors.fields[field].fields[nested];\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    });\n                }\n            }, false);\n        }\n    };\n\n    function isNotEmptyArray(resp, field) {\n        return resp.errors.fields[field] instanceof Array && resp.errors.fields[field].length !== 0;\n    }\n\n    function isNested(resp, field, nested) {\n        return resp.errors.fields[field].fields.hasOwnProperty(nested) && resp.errors.fields[field].fields[nested].length !== 0;\n    }\n};\n\nexports.default = stgFormDirective;\n\n},{}],135:[function(require,module,exports){\n'use strict';\n\nvar _stgFormDirective = require('./directives/stgFormDirective.js');\n\nvar _stgFormDirective2 = _interopRequireDefault(_stgFormDirective);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar MODULE_NAME = 'clearcode.tm.validator'; /**\n                                             * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n                                             *\n                                             * This program is free software: you can redistribute it and/or modify it under\n                                             * the terms of the GNU Affero General Public License as published by the Free\n                                             * Software Foundation, either version 3 of the License, or (at your option) any\n                                             * later version.\n                                             *\n                                             * This program is distributed in the hope that it will be useful,\n                                             * but WITHOUT ANY WARRANTY; without even the implied warranty of\n                                             * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n                                             * GNU Affero General Public License for more details.\n                                             *\n                                             * You should have received a copy of the GNU Affero General Public License\n                                             * along with this program. If not, see <http://www.gnu.org/licenses/>.\n                                             */\n\n_stgFormDirective2.default.$inject = ['clearcode.tm.alert.$alert', 'clearcode.tm.form.alertForm'];\n\nangular.module(MODULE_NAME, ['clearcode.tm.alert', 'clearcode.tm.form']).directive('stgForm', _stgFormDirective2.default);\n\nmodule.exports = { MODULE_NAME: MODULE_NAME };\n\n},{\"./directives/stgFormDirective.js\":134}]},{},[1])\n\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport {MODULE_NAME as APPLICATION_MODULE_NAME} from './app.js';\n\nconst MODULE_NAME = 'admin.application.prod';\n\nangular.module(MODULE_NAME, [\n    APPLICATION_MODULE_NAME\n]);\n\nangular.element(document).ready( () => {\n    angular.bootstrap(document, [MODULE_NAME]);\n});\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport {MODULE_NAME as SECURITY_MODULE_NAME} from './modules/security/security.js';\nimport {MODULE_NAME as UPDATE_MODULE_NAME} from './modules/update/update.js';\nimport {MODULE_NAME as USER_MODULE_NAME} from './modules/user/user.js';\nimport {MODULE_NAME as CONTAINER_MODULE_NAME} from './modules/tagContainer/tagContainer.js';\nimport {MODULE_NAME as TAG_MODULE_NAME} from './modules/tag/tag.js';\nimport {MODULE_NAME as TRIGGER_MODULE_NAME} from './modules/trigger/trigger.js';\nimport {MODULE_NAME as VARIABLE_MODULE_NAME} from './modules/variable/variable.js';\nimport {MODULE_NAME as INTEGRATION_MODULE_NAME} from './modules/integration/integration.js';\nimport {MODULE_NAME as CONDITION_MODULE_NAME} from './modules/condition/condition.js';\nimport {MODULE_NAME as DEBUG_MODULE_NAME} from './modules/debug/debug.js';\nimport {MODULE_NAME as OPT_OUT_MODULE_NAME} from './modules/optOut/optOut.js';\nimport {MODULE_NAME as ALERT_MODULE_NAME} from './../modules/alert/alert.js';\nimport {MODULE_NAME as TRANSLATION_MODULE_NAME} from './../modules/translation/translation.js';\nimport {MODULE_NAME as FORM_MODULE_NAME} from './../modules/form/form.js';\nimport {MODULE_NAME as CONFIRM_MODULE_NAME} from './../modules/confirm/confirm.js';\nimport {MODULE_NAME as SANITIZE_MODULE_NAME} from './../modules/sanitize/sanitize.js';\nimport {MODULE_NAME as CLIPBOARD_MODULE_NAME} from './../modules/clipboard/clipboard.js';\nimport {MODULE_NAME as PAGEINFO_MODULE_NAME} from './../modules/pageInfo/pageInfo.js';\nimport {MODULE_NAME as HELPSYSTEM_MODULE_NAME} from './../modules/helpSystem/helpSystem.js';\nimport {MODULE_NAME as VALIDATOR_MODULE_NAME} from './../modules/validator/validator.js';\nimport {MODULE_NAME as TEXT_EDITOR_MODULE_NAME} from './../modules/textEditor/textEditor.js';\n\nconst MODULE_NAME = 'admin.application';\n\nangular.module('admin.application.plugins', [\n    TAG_MODULE_NAME\n]);\n\nangular.module(MODULE_NAME, [\n    'pascalprecht.translate',\n    'cgBusy',\n    'ui.router',\n    'ui.bootstrap',\n    'checklist-model',\n    'http-auth-interceptor',\n    SECURITY_MODULE_NAME,\n    UPDATE_MODULE_NAME,\n    USER_MODULE_NAME,\n    CONDITION_MODULE_NAME,\n    TRIGGER_MODULE_NAME,\n    VARIABLE_MODULE_NAME,\n    INTEGRATION_MODULE_NAME,\n    TAG_MODULE_NAME,\n    CONTAINER_MODULE_NAME,\n    OPT_OUT_MODULE_NAME,\n    ALERT_MODULE_NAME,\n    TRANSLATION_MODULE_NAME,\n    FORM_MODULE_NAME,\n    CONFIRM_MODULE_NAME,\n    SANITIZE_MODULE_NAME,\n    CLIPBOARD_MODULE_NAME,\n    PAGEINFO_MODULE_NAME,\n    HELPSYSTEM_MODULE_NAME,\n    VALIDATOR_MODULE_NAME,\n    DEBUG_MODULE_NAME,\n    TEXT_EDITOR_MODULE_NAME,\n    'ngClipboard',\n    'admin.application.plugins'\n])\n    .run([\n        '$rootScope',\n        '$state',\n        'clearcode.tm.alert.$alert',\n        'clearcode.tm.security.security',\n        'clearcode.tm.security.oauthResource',\n        'clearcode.tm.security.tokenStorage',\n        'authService',\n        'clearcode.tm.variable.$variableForm',\n\n        ($rootScope, $state, $alertProvider, security, OAuthResource, tokenStorage, authService, $variableFormProvider) => {\n            let removeToken = false;\n\n            $variableFormProvider\n                .addType('dataLayer', {\n                    templateUrl: 'app/modules/variable/views/types/dataLayer.html'\n                })\n                .addType('cookie', {\n                    templateUrl: 'app/modules/variable/views/types/cookie.html'\n                })\n                .addType('constant', {\n                    templateUrl: 'app/modules/variable/views/types/constant.html'\n                })\n                .addType('document', {\n                    templateUrl: 'app/modules/variable/views/types/document.html'\n                })\n                .addType('random', {\n                    templateUrl: 'app/modules/variable/views/types/random.html'\n                })\n                .addType('url', {\n                    templateUrl: 'app/modules/variable/views/types/url.html'\n                })\n                .addType('campaign', {\n                    templateUrl: 'app/modules/variable/views/types/campaign.html'\n                });\n\n            $alertProvider.addMessagePattern(\n                'error.invalid',\n                'Form is invalid. Please correct selected fields'\n            );\n\n            $alertProvider.addMessagePattern(\n                'success.create',\n                'Settings saved successfully'\n            );\n\n            $alertProvider.addMessagePattern(\n                'success.edit',\n                'Settings saved successfully'\n            );\n\n            $alertProvider.addMessagePattern(\n                'success.remove',\n                'Deleted successfully'\n            );\n\n            $rootScope.$state = $state;\n            $rootScope.animateSidebarReady = false;\n\n            $rootScope.isContainerView = () => false;\n\n            $rootScope.$on('$stateChangeStart', (event, toState, toStateParams) => {\n                $rootScope.isContainerView = () => {\n                    let hasContainerList = toState.data.hasContainerList !== undefined\n                        ? toState.data.hasContainerList\n                        : false,\n                        isAuthenticated = security.isAuthenticated();\n\n                    if ($rootScope.animateSidebarReady === false && hasContainerList && isAuthenticated) {\n                        $rootScope.animateSidebarReady = true;\n                    }\n\n                    return hasContainerList && isAuthenticated;\n                };\n\n                $rootScope.activeContainerId = toStateParams.containerId;\n            });\n\n            $rootScope.$on('event:auth-loginRequired', () => {\n                let authToken = tokenStorage.getItem();\n\n                if (removeToken || undefined !== authToken) {\n                    OAuthResource.refreshToken(authToken.refreshToken).then((data) => {\n                        tokenStorage.addItem(data);\n\n                        authService.loginConfirmed('success', (config) => {\n                            config.headers.Authorization = tokenStorage.getToken();\n\n                            return config;\n                        });\n                    }, () => {\n                        tokenStorage.removeItem();\n                        authService.loginCancelled('invalid');\n                        $state.go('signIn');\n                    });\n                }\n                removeToken = !removeToken;\n            });\n        }\n    ])\n    .config([\n        '$urlRouterProvider',\n        'ngClipProvider',\n        '$translateProvider',\n\n        ($urlRouterProvider, ngClipProvider, $translateProvider) => {\n            $urlRouterProvider.otherwise('/containers');\n            ngClipProvider.setPath('ZeroClipboard.swf');\n            $translateProvider.useSanitizeValueStrategy('escape');\n\n            $translateProvider\n                .useStaticFilesLoader({\n                    prefix: '/api/translations/',\n                    suffix: '.json'\n                });\n\n            $translateProvider.preferredLanguage('en');\n            $translateProvider.useLocalStorage();\n        }\n    ])\n    .value('cgBusyDefaults', {\n        wrapperClass: 'loading'\n    })\n    .value('longDataFormat', 'dd MMMM yyyy')\n    .value('defaultDateFormat', 'yyyy-MM-dd HH:mm')\n    .filter('reverse', () => {\n        return (items) => {\n            return items.slice().reverse();\n        };\n    });\n\nmodule.exports = {MODULE_NAME};\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport ConditionResource from './resource/ConditionResource.js';\nimport Condition from './services/Condition.js';\n\nconst MODULE_NAME = 'clearcode.tm.condition';\n\nCondition.$inject = [\n    `${MODULE_NAME}.conditionResource`,\n    'clearcode.tm.tagContainer.currentContainer'\n];\n\nConditionResource.$inject = [\n    '$http',\n    '$q'\n];\n\nangular\n    .module(MODULE_NAME, [\n        'clearcode.tm.tagContainer'\n    ])\n    .service(`${MODULE_NAME}.conditionResource`, ConditionResource)\n    .service(`${MODULE_NAME}.condition`, Condition);\n\n\nmodule.exports = {MODULE_NAME};\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar conditionFactory = () => {\n    /**\n     * @name Condition\n     * @description Condition entity\n     */\n    class Condition {\n        constructor () {\n            /**\n             * @type {number}\n             */\n            this.id = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.variable = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.condition = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.value = undefined;\n        }\n    }\n\n    return Condition;\n};\n\nexport default conditionFactory;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport conditionFactory from '../entity/Condition.js';\n\n/**\n * @name ConditionResource\n */\nclass ConditionResource {\n    /**\n     * @param  {$http} $http\n     * @param  {$q} $q\n     */\n    constructor ($http, $q) {\n        this.http = $http;\n        this.q = $q;\n    }\n\n    /**\n     * @returns {Condition}\n     */\n    getEntityObject () {\n        var Condition = conditionFactory();\n\n        return new Condition();\n    }\n\n    /**\n     * @description Send request to get conditions with their specific variables\n     *\n     * @param {number} id\n     *\n     * @returns {deferred.promise}\n     */\n    query (id) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: `/api/containers/${id}/conditions`\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n}\n\nexport default ConditionResource;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * Finding type by type id\n * @param  {Array} array\n * @param  {Number} type\n * @return {Object}\n */\nvar findTypeByType = (array, type) => {\n    let tempType = type;\n\n    return array.filter(element => element.type === tempType);\n};\n\nlet currentContainer;\nlet conditionResource;\n\nclass Condition {\n    constructor ($conditionResource, $currentContainer) {\n        currentContainer = $currentContainer;\n        conditionResource = $conditionResource;\n\n        if (currentContainer.getId() !== undefined) {\n            this.conditionResourcePromise = conditionResource.query(currentContainer.getId());\n        }\n    }\n\n    getArrayOfTypes () {\n        return this.conditionResourcePromise.then(\n            resp => {\n                let typesTemp = [],\n                    typesIndex = resp.length;\n\n                while (typesIndex--) {\n                    typesTemp[resp[typesIndex].type] = resp[typesIndex].name;\n                }\n\n                return typesTemp;\n            }\n        );\n    }\n\n    allVariables () {\n        return this.conditionResourcePromise.then(\n            resp => {\n                let variables = [];\n                for (let index = 0; index < resp.length; index++) {\n                    variables = variables.length\n                        ? mergeVariables(variables, resp[index].variables)\n                        : resp[index].variables;\n                }\n                \n                return variables;\n            }\n        );\n    }\n\n    getVariables (type) {\n        return this.conditionResourcePromise.then(\n            resp => {\n                let responsedTypes = findTypeByType(resp, type);\n\n                if (responsedTypes.length === 1) {\n                    return responsedTypes[0].variables;\n                } else {\n                    return false;\n                }\n            }\n        );\n    }\n\n    getRequired (type) {\n        return this.conditionResourcePromise.then(\n            resp => {\n                let responsedTypes = findTypeByType(resp, type);\n\n                if (responsedTypes.length === 1) {\n                    return responsedTypes[0].variables.filter(variable => {\n                        return variable.name === 'Event' && responsedTypes[0].name === 'Event'\n                    });\n                } else {\n                    return false;\n                }\n            }\n        );\n    }\n\n    getActions (type) {\n        return this.conditionResourcePromise.then(\n            resp => {\n                let responsedTypes = findTypeByType(resp, type);\n\n                if (responsedTypes.length === 1) {\n                    return responsedTypes[0].actions;\n                } else {\n                    return false;\n                }\n            }\n        );\n    }\n\n    refresh () {\n        this.conditionResourcePromise = conditionResource.query(currentContainer.getId());\n    }\n}\n\nfunction mergeVariables (arrayFirst, arraySecond) {\n    let final = [];\n    for (let indexFirst in arrayFirst) {\n        let shared = false;\n        for (let indexSecond in arraySecond) {\n            if (isVariablesNameEqual(arraySecond[indexSecond], arrayFirst[indexFirst])) {\n                shared = true;\n                break;\n            }\n        }\n        if (!shared) {\n            final.push(arrayFirst[indexFirst])\n        }\n    }\n\n    return final.concat(arraySecond);\n}\n\nfunction isVariablesNameEqual (variableFirst, variableSecond) {\n    return variableFirst.name === variableSecond.name;\n}\n\nexport default Condition;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @type {$state}\n */\nlet state;\n\n/**\n * @type {$stateParams}\n */\nlet stateParams;\n\n/**\n * @type {CurrentContainer}\n */\nlet currentContainer;\n\n/**\n * @type {$scope}\n */\nlet scope;\n\nlet translate;\n\n/**\n * @type {String}\n */\nconst BREADCRUMB_TEXT = 'Debug';\n\n/**\n * @name DebugOptionsController\n */\nclass DebugOptionsController {\n    /**\n     * @param {ContainerResource} containerResource\n     * @param {$state} $state\n     * @param {$stateParams} $stateParams\n     * @param {currentContainer} CurrentContainer\n     * @param {PageInfo} PageInfo\n     * @param {$scope} $scope\n     * @param {$translate} $translate\n     */\n    constructor (\n        containerResource,\n        $state,\n        $stateParams,\n        CurrentContainer,\n        PageInfo,\n        $scope,\n        $translate\n    ) {\n        state = $state;\n        stateParams = $stateParams;\n        currentContainer = CurrentContainer;\n        scope = $scope;\n        translate = $translate;\n\n        this.container = containerResource.getEntityObject();\n\n        this.containerPromise = containerResource.get(stateParams.containerId);\n\n        this.containerPromise.then((resp) => {\n            this.container = resp;\n        });\n\n        currentContainer.getContainer().then(() => {\n            if (currentContainer.$container.hasPermission('noaccess')) {\n                state.go('container');\n            }\n\n            translate([BREADCRUMB_TEXT])\n                .then((translations) => {\n                    PageInfo.clear()\n                        .add(currentContainer.$container.name, 'tags', {\n                            containerId: currentContainer.$container.id\n                        })\n                        .add(translations[BREADCRUMB_TEXT])\n                        .broadcast();\n                });\n        });\n\n        scope.$on('pageInfo.reload', (event, args) => {\n            translate([BREADCRUMB_TEXT])\n                .then((translations) => {\n                    PageInfo.clear()\n                        .add(args.name, 'tags', {\n                            containerId: args.id\n                        })\n                        .add(translations[BREADCRUMB_TEXT])\n                        .broadcast();\n                });\n        });\n    }\n}\n\nexport default DebugOptionsController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet state,\n    stateParams,\n    alert,\n    currentContainer,\n    websitesResource;\n\n/**\n * @name WebsitesController\n */\nclass WebsitesController {\n    constructor (\n        $websitesResource,\n        $state,\n        $stateParams,\n        $alert,\n        $currentContainer,\n        $translate,\n        $scope\n    ) {\n        state = $state;\n        stateParams = $stateParams;\n        alert = $alert;\n        currentContainer = $currentContainer;\n        websitesResource = $websitesResource;\n\n        this.websites = [];\n        this.websitesPromise = websitesResource.query(stateParams.containerId); \n      \n        this.websitesPromise.then((resp) => {\n            this.websites = resp.data;\n        });\n\n        $translate(['by hash', 'by query'])\n            .then((translations) => {\n                this.parameterTypes = [{\n                    value: 0,\n                    name: translations['by query']\n                }, {\n                    value: 1,\n                    name: translations['by hash']\n                }];\n            });\n\n        $scope.getWebsiteUrlWithParameter = (website) => website.getUrlWithParameter();\n    }\n\n    /**\n     * Method to create new container website\n     */\n    addContainerWebsite () {\n        if (!currentContainer.$container.hasPermission('edit')) {\n            return;\n        }\n\n        if (!this.websites) {\n            this.websites = [];\n        }\n\n        this.websites.push(websitesResource.getEntityObject());\n    }\n\n    /**\n     * Method to remove container websites\n     *\n     * @param {Number} index\n     */\n    removeContainerWebsite (index) {\n        this.websites.splice(index, 1);\n    }\n\n    /**\n     * Handle form submit action\n     */\n    submitForm () {\n        let websites = [];\n\n        for (let i = 0; this.websites && i < this.websites.length; i++) {\n            let website = websitesResource.getEntityObject();\n\n            website.url = this.websites[i].url;\n            website.parameterType = this.websites[i].parameterType;\n\n            websites.push(website);\n        }\n\n        this.websitePromise = websitesResource.put(stateParams.containerId, websites);\n\n        this.websitePromise.then(\n            () => {\n                currentContainer.get(stateParams.containerId);\n                alert.success('success.edit');\n\n                state.go('debug', {containerId: stateParams.containerId});\n            },\n            () => {\n                alert.error('error.invalid');\n\n                this.validateContainer = true;\n            }\n        );\n    }\n}\n\nexport default WebsitesController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport DebugOptionsController from './controllers/DebugOptionsController.js';\nimport WebsitesController from './controllers/WebsitesController.js';\nimport WebsiteResource from './resource/WebsiteResource.js';\n\nconst MODULE_NAME = 'clearcode.tm.debug';\nconst MODULE_CONTAINER = 'clearcode.tm.tagContainer';\nconst MODULE_DIR = 'app/modules/debug';\n\nWebsiteResource.$inject = [\n    '$http',\n    '$q'\n];\n\nWebsitesController.$inject = [\n    `${MODULE_NAME}.websiteResource`,\n    '$state',\n    '$stateParams',\n    'clearcode.tm.alert.alert',\n    `${MODULE_CONTAINER}.currentContainer`,\n    '$translate',\n    '$scope'\n];\n\nDebugOptionsController.$inject = [\n    `${MODULE_CONTAINER}.containerResource`,\n    '$state',\n    '$stateParams',\n    `${MODULE_CONTAINER}.currentContainer`,\n    'clearcode.tm.pageInfo.pageInfo',\n    '$scope',\n    '$translate'\n];\n\nangular\n    .module(MODULE_NAME, [\n        'pascalprecht.translate',\n        'ui.router',\n        'ngTable',\n        'ngCookies',\n        'clearcode.tm.condition',\n        'clearcode.tm.alert',\n        'clearcode.tm.pageInfo',\n        'clearcode.tm.user'\n    ])\n    .run([\n        '$rootScope',\n        `${MODULE_CONTAINER}.currentContainer`,\n        '$stateParams',\n        ($rootScope, currentContainer, $stateParams) => {\n            $rootScope.currentContainerLoading = true;\n            $rootScope.currentContainer = currentContainer;\n\n            var loadContainer = (containerId) => {\n                if (containerId !== $stateParams.containerId) {\n                    let currentContainerPromise = currentContainer.get(containerId);\n\n                    currentContainerPromise.then((container) => {\n                        $rootScope.$broadcast('pageInfo.reload', container);\n                    });\n                }\n            };\n\n            $rootScope.$on('$stateChangeStart', (event, toState, toParams) => {\n                loadContainer(toParams.containerId);\n            });\n        }\n    ])\n    .config([\n        '$stateProvider',\n        ($stateProvider) => {\n            $stateProvider\n                .state('debug', {\n                    url: '/containers/{containerId}/debug',\n                    controller: `${MODULE_NAME}.DebugOptionsController as view`,\n                    templateUrl: `${MODULE_DIR}/views/options.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: true,\n                        permission: [\n                            'view'\n                        ]\n                    }\n                });\n        }\n    ])\n    .controller(`${MODULE_NAME}.DebugOptionsController`, DebugOptionsController)\n    .controller(`${MODULE_NAME}.WebsitesController`, WebsitesController)\n    .service(`${MODULE_NAME}.websiteResource`, WebsiteResource);\n\nmodule.exports = {MODULE_NAME};\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar websiteFactory = () => {\n    const DEBUG_PARAM_NAME = '_stg_debug';\n    const URL_MIN_LENGTH = 10;\n\n    /**\n     * @name Website\n     * @description Website entity\n     */\n    class Website {\n        constructor () {\n            /**\n             * @type {string}\n             */\n            this.url = '';\n\n            /**\n             * @type {Integer}\n             */\n            this.parameterType = 0;\n        }\n\n        /**\n         * @returns {string}\n         */\n        getUrlWithParameter () {\n            if (this.hasUrl() === false) {\n                return '';\n            }\n\n            return this.url + this.getSeparator() + DEBUG_PARAM_NAME;\n        }\n\n        /**\n         * @returns {string}\n         */\n        getSeparator () {\n            var separator = this.parameterType === 1 ? '#' : '?';\n\n            if (this.hasUrl() === false) {\n                return separator;\n            }\n\n            return this.url.indexOf(separator) === -1 ? separator : '&';\n        }\n\n        hasUrl () {\n            return this.url !== undefined && this.url.length > URL_MIN_LENGTH;\n        }\n    }\n\n    return Website;\n};\n\nexport default websiteFactory;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport websiteFactory from '../entity/Website.js';\n\nvar transformResponse = function (resp) {\n    if (angular.isArray(resp)) {\n        return resp.map((websiteData) => {\n            return transformResponse.call(this, websiteData);\n        });\n    }\n\n    var website = this.getEntityObject();\n\n    if (resp !== undefined) {\n        website.url = resp.url;\n        website.parameterType = resp.parameter_type;\n    }\n\n    return website;\n};\n\nvar appendTransform = function (defaults, transform) {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name WebsiteResource\n *\n */\nclass WebsiteResource {\n    /**\n     * @param {$http} $http\n     * @param {$q} $q\n     */\n    constructor ($http, $q) {\n        this.http = $http;\n        this.q = $q;\n    }\n\n    /**\n     * @returns {Website}\n     */\n    getEntityObject () {\n        var Website = websiteFactory(this);\n\n        return new Website();\n    }\n\n    /**\n     * @description Send request to get list of entity\n     *\n     * @param {number} containerId\n     * @param {Object} params\n     *\n     * @returns {deferred.promise}\n     */\n    query (containerId, params) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: `/api/containers/${containerId}/websites`,\n            params: params,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (isResponseSuccess(resp, status)) {\n                    for (var i = 0; i < resp.data.length; i++) {\n                        if (resp.data[i] instanceof Object) {\n                            resp.data[i] = transformResponse.call(this, resp.data[i]);\n                        }\n                    }\n                }\n\n                return resp;\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    put (containerId, websites) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'PUT',\n            data: {\n                websites: websites\n            },\n            url: `api/containers/${containerId}/websites`,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (isResponseSuccess(resp, status)) {\n                    return transformResponse.call(this, resp.data);\n                }\n\n                return resp;\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n}\n\nfunction isResponseSuccess (resp, status) {\n    return status < 400 && resp.data !== undefined;\n}\n\nexport default WebsiteResource;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name BaseController\n */\nclass BaseController {\n    /**\n     * @param {IntegrationResource} $Integration\n     * @param {PageInfo} $PageInfo\n     * @param {$stateParams} $stateParams\n     * @param {Alert} $alert\n     * @param {$state} $state\n     * @param {$translate} $translate\n     */\n    constructor (\n        $Integration,\n        $PageInfo,\n        $stateParams,\n        $alert,\n        $state,\n        $translate\n        ) {\n        const BREADCRUMB_TEXT = 'Integrations';\n\n        this.integration = $Integration.getEntityObject();\n        this.stateParams = $stateParams;\n        this.alert = $alert;\n        this.state = $state;\n\n        this.formTouched = false;\n\n        $translate([BREADCRUMB_TEXT, this.getBreadcrumbText()])\n            .then((translations) => {\n                $PageInfo.clear()\n                    .add(translations[BREADCRUMB_TEXT], 'integration')\n                    .add(translations[this.getBreadcrumbText()])\n                    .broadcast();\n            });\n    }\n\n    /**\n     * Handle form submit action\n     *\n     * @param {Integration} Integration\n     */\n    submitForm (Integration) {\n        this.integrationPromise = Integration.save(this.stateParams.id);\n\n        this.integrationPromise.then(\n            (resp) => {\n                this.alert.success(this.getAlertType());\n\n                if (this.state.includes('integrationCreate')) {\n                    this.state.go('integrationEdit', {\n                        integrationId: resp.id\n                    });\n                } else {\n                    this.state.go('integration');\n                }\n            },\n            () => {\n                this.alert.error('error.invalid');\n            }\n        );\n    }\n\n    /**\n     * Display error if form is invalid\n     */\n    displayInvalidFormMessage () {\n        this.validateIntegration = true;\n        this.alert.error('error.invalid');\n    }\n}\n\nexport default BaseController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport BaseController from './BaseController.js';\n\n/**\n * @name CreateController\n */\nclass CreateController extends BaseController {\n    constructor (\n            $IntegrationResource,\n            $PageInfo,\n            $stateParams,\n            $alert,\n            $state,\n            $translate\n        ) {\n        super(\n            $IntegrationResource,\n            $PageInfo,\n            $stateParams,\n            $alert,\n            $state,\n            $translate\n        );\n\n        this.integration = $IntegrationResource.getEntityObject();\n    }\n    \n    getBreadcrumbText () {\n        return 'Add a new integration';\n    }\n\n    getAlertType () {\n        return 'success.create';\n    }\n}\n\nexport default CreateController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport BaseController from './BaseController.js';\n\n/**\n * @name EditController\n */\nclass EditController extends BaseController {\n    /**\n     * @param {IntegrationResource} $IntegrationResource\n     * @param {PageInfo} $PageInfo\n     * @param {$stateParams} $stateParams\n     * @param {Alert} $alert\n     * @param {$state} $state\n     * @param {$translate} $translate\n     */\n    constructor (\n        $IntegrationResource,\n        $PageInfo,\n        $stateParams,\n        $alert,\n        $state,\n        $translate\n        ) {\n        super(\n            $IntegrationResource,\n            $PageInfo,\n            $stateParams,\n            $alert,\n            $state,\n            $translate\n        );\n        this.integrationPromise = $IntegrationResource.get($stateParams.integrationId);\n        this.integrationPromise.then(\n            resp => {\n                this.integration = resp;\n            }\n        );\n        this.formTouched = true;\n    }\n\n    getBreadcrumbText () {\n        return 'Edit integration';\n    }\n\n    getAlertType () {\n        return 'success.edit';\n    }\n}\n\nexport default EditController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet $alert;\n\nconst BREADCRUMB_TEXT = 'Integrations';\n\n/**\n * @name ManageController\n */\nclass ManageController {\n    constructor (\n        TableParams,\n        Integration,\n        alert,\n        paramConverter,\n        PageInfo,\n        $translate\n    ) {\n        $alert = alert;\n\n        this.permissions = [];\n        this.tableParams = new TableParams({\n            page: 1,\n            count: 10,\n            sorting: {\n                name: 'asc'\n            }\n        }, {\n            total: 0,\n            getData: ($defer, params) => {\n                Integration.query(paramConverter.list(params.url())).then((resp) => {\n                    params.total(resp.total);\n                    $defer.resolve(resp.data);\n                });\n            }\n        });\n\n        $translate([BREADCRUMB_TEXT])\n            .then((translations) => {\n                PageInfo.clear()\n                    .add(translations[BREADCRUMB_TEXT])\n                    .broadcast();\n            });\n    }\n\n    removeIntegration (Integration) {\n        Integration.remove().then(\n            () => {\n                $alert.success('success.remove');\n                if (this.tableParams.data.length === 1 && this.tableParams.page() > 1) {\n                    this.tableParams.page(this.tableParams.page() - 1);\n                } else {\n                    this.tableParams.reload();\n                }\n            },\n            () => {\n                $alert.error('error.remove');\n                this.tableParams.reload();\n            }\n        );\n    }\n}\n\nexport default ManageController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar integrationFactory = (resource) => {\n    /**\n     * @name Integration\n     * @description Integration entity\n     */\n    class Integration {\n        constructor () {\n            /**\n             * @type {number}\n             */\n            this.id = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.name = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.clientId = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.clientSecret = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.createdAt = undefined;\n            /**\n             * @type {string}\n             */\n            this.updatedAt = undefined;\n            /**\n             * @type {Object}\n             */\n            this.user = undefined;\n        }\n\n        /**\n         * @returns {deferred.promise}\n         */\n        save () {\n            var result = {}, promise;\n\n            var excludedProperty = ['id', 'updatedAt', 'createdAt', 'clientId', 'clientSecret', 'user'];\n\n            for (var property in this) {\n                if (\n                    !angular.isFunction(this[property]) &&\n                    this.hasOwnProperty(property) &&\n                    excludedProperty.indexOf(property) === -1\n                ) {\n                    if (property === 'type') {\n                        result[property] = this[property].id;\n                    } else {\n                        result[property] = this[property];\n                    }\n                }\n            }\n\n            if (this.id === undefined) {\n                if (this.user.email) {\n                    result.user = {};\n                    result.user.email = this.user.email;\n                }\n\n                promise = resource.post(result);\n            } else {\n                promise = resource.put(this.id, result);\n            }\n\n            return promise;\n        }\n\n        /**\n         * @returns {deferred.promise|Boolean}\n         */\n        remove () {\n            if (this.id === undefined) {\n                return false;\n            }\n\n            return resource.delete(this.id);\n        }\n    }\n\n    return Integration;\n};\n\nexport default integrationFactory;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport ManageController from './controllers/ManageController.js';\nimport CreateController from './controllers/CreateController.js';\nimport EditController from './controllers/EditController.js';\n\nimport IntegrationResource from './resource/IntegrationResource.js';\n\nconst MODULE_NAME = 'clearcode.tm.integration';\nconst MODULE_DIR = 'app/modules/integration';\n\nManageController.$inject = [\n    'ngTableParams',\n    `${MODULE_NAME}.IntegrationResource`,\n    'clearcode.tm.alert.alert',\n    'clearcode.tm.tagContainer.paramConverter',\n    'clearcode.tm.pageInfo.pageInfo',\n    '$translate'\n];\n\nCreateController.$inject = [\n    `${MODULE_NAME}.IntegrationResource`,\n    'clearcode.tm.pageInfo.pageInfo',\n    '$stateParams',\n    'clearcode.tm.alert.alert',\n    '$state',\n    '$translate'\n];\n\nEditController.$inject = [\n    `${MODULE_NAME}.IntegrationResource`,\n    'clearcode.tm.pageInfo.pageInfo',\n    '$stateParams',\n    'clearcode.tm.alert.alert',\n    '$state',\n    '$translate'\n];\n\nIntegrationResource.$inject = [\n    '$http',\n    '$q'\n];\n\nangular\n    .module(MODULE_NAME, [\n        'pascalprecht.translate',\n        'ui.router',\n        'ngTable',\n        'clearcode.tm.alert',\n        'clearcode.tm.pageInfo',\n        'clearcode.tm.tagContainer'\n    ])\n    .config([\n        '$stateProvider',\n        ($stateProvider) => {\n            $stateProvider\n                .state('integration', {\n                    url: '/integration',\n                    controller: `${MODULE_NAME}.ManageController as view`,\n                    templateUrl: `${MODULE_DIR}/views/manage.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: false\n                    }\n                })\n                .state('integrationCreate', {\n                    url: '/integration/create',\n                    controller: `${MODULE_NAME}.CreateController as view`,\n                    templateUrl: `${MODULE_DIR}/views/create.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: false\n                    }\n                })\n                .state('integrationEdit', {\n                    url: '/integration/{integrationId}/edit',\n                    controller: `${MODULE_NAME}.EditController as view`,\n                    templateUrl: `${MODULE_DIR}/views/edit.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: false\n                    }\n                });\n        }\n    ])\n    .run([\n        'clearcode.tm.alert.$alert',\n        ($alertProvider) => {\n            $alertProvider.addMessagePattern(\n                'integration.close',\n                'You are trying to close unsaved OAuth client.'\n            );\n        }\n    ])\n    .controller(`${MODULE_NAME}.ManageController`, ManageController)\n    .controller(`${MODULE_NAME}.CreateController`, CreateController)\n    .controller(`${MODULE_NAME}.EditController`, EditController)\n    .service(`${MODULE_NAME}.IntegrationResource`, IntegrationResource);\n\nmodule.exports = {MODULE_NAME};\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport integrationFactory from '../entity/Integration.js';\n\nvar transformResponse = function (resp) {\n    var Integration = integrationFactory(this);\n    var integration = new Integration();\n\n    integration.id = resp.id;\n    integration.name = resp.name;\n    integration.clientId = resp.client_id;\n    integration.clientSecret = resp.client_secret;\n    integration.createdAt = resp.created_at;\n    integration.updatedAt = resp.updated_at;\n\n    integration.user = {\n        id: undefined,\n        status: undefined,\n        roles: [],\n        email: undefined\n    };\n\n    if (resp.user) {\n        integration.user.id = resp.user.id;\n        integration.user.status = resp.user.status;\n        integration.user.roles = resp.user.roles;\n\n        if (resp.user.email) {\n            integration.user.email = resp.user.email;\n        }\n    }\n\n    return integration;\n};\n\n\nvar appendTransform = function (defaults, transform) {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name IntegrationResource\n */\nclass IntegrationResource {\n    /**\n     * @param {$http} $http\n     * @param {$q} $q\n     */\n    constructor ($http, $q) {\n        this.http = $http;\n        this.q = $q;\n    }\n\n    /**\n     * @returns {Integration}\n     */\n    getEntityObject () {\n        var Integration = integrationFactory(this);\n\n        return new Integration();\n    }\n\n    /**\n     * @description Send request to get specific entity\n     *\n     * @param {number} id\n     *\n     * @returns {deferred.promise}\n     */\n    get (id) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: `/api/integration/${id}`,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (status < 400) {\n                    return transformResponse.call(this, resp.data);\n                } else {\n                    return resp;\n                }\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    /**\n     * @description Send request to get list of entity\n     *\n     * @param {Object} params\n     *\n     * @returns {deferred.promise}\n     */\n    query (params) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: '/api/integration',\n            params: params,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp) => {\n                for (var element in resp.data) {\n                    if (resp.data[element] instanceof Object) {\n                        resp.data[element] = transformResponse.call(this, resp.data[element]);\n                    }\n                }\n\n                return resp;\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    /**\n     * @description Send request to delete entity\n     *\n     * @param {number} id\n     *\n     * @returns {deferred.promise}\n     */\n    delete (id) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'DELETE',\n            url: `/api/integration/${id}`\n        })\n            .success((data) => {\n                deferred.resolve(data);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    /**\n     * @description Send request to create entity\n     *\n     * @param {object} entity\n     *\n     * @returns {deferred.promise}\n     */\n    post (entity) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'POST',\n            url: '/api/integration',\n            data: entity,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (status < 400) {\n                    return transformResponse.call(this, resp.data);\n                } else {\n                    return resp;\n                }\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    /**\n     * Send request to update entity\n     *\n     * @param {number} id\n     * @param {object} entity\n     *\n     * @returns {deferred.promise}\n     */\n    put (id, entity) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'PUT',\n            url: `/api/integration/${id}`,\n            data: entity,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (status < 400) {\n                    return transformResponse.call(this, resp.data);\n                } else {\n                    return resp;\n                }\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n}\n\nexport default IntegrationResource;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet PageInfo,\n    translate,\n    snippet;\n\nconst BREADCRUMB_TEXT = 'Opt-out generator',\n    defaultOptOutMessage = `You can choose to opt out of being tracked by all marketing and advertising tools installed on this website. \nTo make that choice, please click below to receive an opt-out cookie.`,\n    defaultOptIn = 'You are currently opted in. Click here to opt out.',\n    defaultOptOut = 'You are currently opted out. Click here to opt in.';\n\n/**\n * @name GeneratorController\n */\nclass GeneratorController {\n    /*\n     * @param {PageInfo} $PageInfo\n     * @param {Snippet} $snippet\n     * @param {$scope} scope\n     * @param {$translate} $translate\n     */\n    constructor (\n        $PageInfo,\n        $snippet,\n        scope,\n        $translate\n    ) {\n        PageInfo = $PageInfo;\n        translate = $translate;\n        snippet = $snippet;\n\n        this.options = [{\n            name: 'domain',\n            value: 0\n        }, {\n            name: 'global',\n            value: 1\n        }];\n\n        this.option = 0;\n        this.optOutMessage = defaultOptOutMessage;\n        this.optInOption = defaultOptIn;\n        this.optOutOption = defaultOptOut;\n\n        scope.$watch('view.option', () => {\n            this.generateSnippet();\n        });\n\n        this.setPageInfo();\n\n        this.generateSnippet();\n    }\n\n    setPageInfo () {\n        translate([BREADCRUMB_TEXT])\n            .then((translations) => {\n                PageInfo.clear()\n                    .add(translations[BREADCRUMB_TEXT])\n                    .broadcast();\n            });\n    }\n\n    generateSnippet () {\n        this.snippet = snippet.buildSnippet(this.option, this.optInOption, this.optOutOption, this.optOutMessage.replace(/\\n/g, '<br>'));\n    }\n}\n\nexport default GeneratorController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport GeneratorController from './controllers/GeneratorController.js';\nimport Snippet from './services/Snippet.js';\n\nconst MODULE_NAME = 'clearcode.tm.optOut';\nconst MODULE_DIR = 'app/modules/optOut';\n\nGeneratorController.$inject = [\n    'clearcode.tm.pageInfo.pageInfo',\n    `${MODULE_NAME}.snippet`,\n    '$scope',\n    '$translate'\n];\n\nangular\n    .module(MODULE_NAME, [\n        'pascalprecht.translate',\n        'ui.router',\n        'clearcode.tm.alert',\n        'clearcode.tm.pageInfo',\n        'clearcode.tm.form',\n        'clearcode.tm.security'\n    ])\n    .config([\n        '$stateProvider',\n\n        ($stateProvider) => {\n            $stateProvider\n                .state('optOutGenerator', {\n                    url: '/opt-out',\n                    controller: `${MODULE_NAME}.GeneratorController as view`,\n                    templateUrl: `${MODULE_DIR}/views/generator.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: false\n                    }\n                });\n        }])\n    .controller(`${MODULE_NAME}.GeneratorController`, GeneratorController)\n    .service(`${MODULE_NAME}.snippet`, Snippet);\n\nmodule.exports = {MODULE_NAME};\n\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nconst  optOutOpeningComment = '<!-- Start 7Tag privacy opt-out code -->',\n    optOutClosingComment = '<!-- End 7Tag privacy opt-out code -->',\n    hostname = window.location.hostname;\n\nclass Snippet {\n    buildSnippet (option, optInMessage, optOutMessage, message) {\n        let snippet = optOutOpeningComment +\n            this.buildVariablesInitialization(optInMessage, optOutMessage, option) +\n            this.buildExternalScript() +\n            this.buildMainMessage(message) +\n            optOutClosingComment;\n\n        return snippet;\n    }\n\n    buildVariablesInitialization (optInMessage, optOutMessage, option) {\n        return '<script>window.sevenTag = window.sevenTag || {};' +\n               `window.sevenTag.optedOutCheckboxText=\"${optOutMessage}\";` +\n               `window.sevenTag.optedInCheckboxText=\"${optInMessage}\";` +\n               `window.sevenTag.isGlobal=${!!option};` +\n               `window.sevenTag.instanceHostname=\"${hostname}\";</script>`;\n    }\n\n    buildExternalScript () {\n        return `<script src=\"//${hostname}/containers/privacy/script.v2.js\"></script>`;\n    }\n\n    buildMainMessage (message) {\n        return '<div id=\"_stg_opt_out_iframe_content\" style=\"display: none;\">' +\n               `<p>${message}</p>` +\n               '<input id=\"_stg_optout_checkbox\" onclick=\"window.parent.storeUserOptOutPreferences();\" type=\"checkbox\">' +\n               '<label id=\"_stg_optout_checkbox_label\" for=\"_stg_optout_checkbox\"></label>' +\n               '</div>';\n    }\n}\n\nexport default Snippet;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet $oauthResource;\nlet $tokenStorage;\nlet state;\nlet $alertForm;\n\nconst BREADCRUMB_TEXT = 'Welcome to Impono';\n\n/**\n * @name security#LoginController\n * @description Controller for login view\n */\nclass LoginController {\n    /**\n     * @param {OAuthResource} oauthResource\n     * @param {TokenStorage} tokenStorage\n     * @param {$state} $state\n     * @param {AlertForm} alertForm\n     * @param {PageInfo} PageInfo\n     *\n     */\n    constructor (oauthResource, tokenStorage, $state, alertForm, PageInfo) {\n        this.auth = {\n            identity: '',\n            password: ''\n        };\n        this.loginPromise = undefined;\n\n        $oauthResource = oauthResource;\n        $tokenStorage = tokenStorage;\n        state = $state;\n        $alertForm = alertForm;\n\n        $alertForm.getStorage().clean();\n\n        PageInfo.clear()\n            .add(BREADCRUMB_TEXT)\n            .broadcast();\n    }\n\n    submitForm (auth) {\n        this.loading = true;\n        this.loginPromise = $oauthResource.post(auth.identity, auth.password);\n\n        this.loginPromise.then(\n            (resp) => {\n                $alertForm.getStorage().clean();\n                $tokenStorage.addItem(resp);\n                state.go('container');\n            },\n            () => {\n                this.loading = false;\n            }\n        );\n    }\n\n    displayInvalidLoginMessage () {\n        $alertForm.error('login.invalid');\n    }\n}\n\nexport default LoginController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet deleteRequestInterceptor = ($q, $rootScope, $injector) => {\n    let METHOD_DELETE = 'DELETE';\n    let POST_DELETE_URL_SUFIX = '/remove';\n\n    return {\n        request: (config) => {\n            if (config.method.toUpperCase() === METHOD_DELETE && $rootScope.deleteHeaderNotSupported === true) {\n                config.method = 'POST';\n                config.url += POST_DELETE_URL_SUFIX;\n            }\n\n            return config;\n        },\n        responseError: (rejection) => {\n            let $http = $injector.get('$http');\n            if (rejection.config.method.toUpperCase() === METHOD_DELETE) {\n                if (rejection.status === 405) {\n                    $rootScope.deleteHeaderNotSupported = true;\n\n                    return $http.post(rejection.config.url + POST_DELETE_URL_SUFIX);\n                }\n            }\n\n            return $q.reject(rejection);\n        }\n    };\n};\n\nexport default deleteRequestInterceptor;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nconst DEFAULT_LANGUAGE = 'en';\n\nlet localeInterceptor = ($window) => {\n    return {\n        request: (config) => {\n            let localStorageLang = $window.localStorage['NG_TRANSLATE_LANG_KEY'];\n\n            if (!/^https?:\\/\\//i.test(config.url)) {\n                config.headers.Locale = localStorageLang\n                    ? localStorageLang\n                    : DEFAULT_LANGUAGE;\n            }\n\n            return config;\n        }\n    };\n};\n\nexport default localeInterceptor;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet securityInterceptor = ($q, tokenStorage, $injector) => {\n    return {\n        request: (config) => {\n            if (undefined !== tokenStorage.getItem() && /(.js|.html|.css|.json)$/.test(config.url) === false) {\n                config.headers.Authorization = tokenStorage.getToken();\n            }\n\n            return config;\n        },\n\n        responseError: (rejection) => {\n            // TODO: change this to state ( problem with dependency injection )\n            let $state = $injector.get('$state');\n            if (rejection.status === 400) {\n                if (\n                    rejection.data &&\n                    (rejection.data.error === 'invalid_request' || rejection.data.error === 'invalid_grant')\n                ) {\n                    tokenStorage.removeItem();\n                    $state.go('signIn');\n                }\n            }\n\n            if (rejection.status === 403) {\n                $state.go('accessDenied');\n            }\n\n            return $q.reject(rejection);\n        }\n    };\n};\n\nexport default securityInterceptor;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport AuthToken from '../token/AuthToken.js';\n\nconst RESOURCE_ROUTE = '/api/oauth/v2/token';\nconst LOGOUT_ROUTE = '/api/users/me/logout';\nconst GRANT_TYPE = 'password';\n\nlet transformResponse = function (resp, header, status) {\n    let response;\n\n    if (status < 400) {\n        let authToken = this.getEntity();\n\n        authToken.accessToken = resp.access_token;\n        authToken.expiresIn = resp.expires_in;\n        authToken.tokenType = resp.token_type;\n        authToken.scope = resp.scope;\n        authToken.refreshToken = resp.refresh_token;\n\n        response = authToken;\n    } else {\n        response = resp;\n    }\n\n    return response;\n};\n\nlet appendTransform = (defaults, transform) => {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name OAuthResource\n */\nclass OAuthResource {\n    constructor ($http, $q, tokenStorage, OAuthClientSettings) {\n        this.http = $http;\n        this.q = $q;\n        this.tokenStorage = tokenStorage;\n        this.OAuthClientSettings = OAuthClientSettings;\n    }\n\n    /**\n     * @returns {AuthToken}\n     */\n    getEntity () {\n        AuthToken.prototype.save = () => {\n            let deferred = this.q.defer();\n\n            this.tokenStorage.add(this);\n            deferred.resolve(this);\n\n            return deferred.promise;\n        };\n\n        AuthToken.prototype.remove = () => {\n            let deferred = this.q.defer();\n\n            this.tokenStorage.remove();\n            deferred.resolve(this);\n\n            return deferred.promise;\n        };\n\n        return new AuthToken();\n    }\n\n    /**\n     * @description Send request to get oauth\n     *\n     * @param {string} identity of user ( email or username )\n     * @param {string} password\n     *\n     * @returns {deferred.promise}\n     */\n    post (identity, password) {\n        let deferred = this.q.defer();\n\n        this.http({\n            method: 'POST',\n            url: RESOURCE_ROUTE,\n            data: {\n                /* eslint-disable */\n                client_id: this.OAuthClientSettings.clientId,\n                client_secret: this.OAuthClientSettings.clientSecret,\n                grant_type: GRANT_TYPE,\n                username: identity,\n                password: password\n                /* eslint-enable */\n            },\n            ignoreAuthModule: true,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                return transformResponse.call(this, resp, header, status);\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    /**\n     * @description Send request to get new tokens\n     *\n     * @param {string} token\n     *\n     * @returns {deferred.promise}\n     */\n    refreshToken (token) {\n        let deferred = this.q.defer();\n\n        this.http({\n            method: 'POST',\n            url: RESOURCE_ROUTE,\n            data: {\n                /* eslint-disable */\n                client_id: this.OAuthClientSettings.clientId,\n                client_secret: this.OAuthClientSettings.clientSecret,\n                grant_type: 'refresh_token',\n                refresh_token: token\n                /* eslint-enable */\n            },\n            ignoreAuthModule: true,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (resp.error !== undefined) {\n                    return resp;\n                }\n\n                return transformResponse.call(this, resp, header, status);\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    /**\n     * @description Send request to logout\n     *\n     * @returns {Promise}\n     */\n    logout () {\n        let deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: LOGOUT_ROUTE\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n}\n\nexport default OAuthResource;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport LoginController from './controller/LoginController.js';\n\nimport Authorization from './service/Authorization.js';\nimport Security from './service/Security.js';\nimport OAuthResource from './resource/OAuthResource.js';\nimport TokenStorage from './service/TokenStorage.js';\nimport securityInterceptor from './interceptor/SecurityInterceptor.js';\nimport localeInterceptor from './interceptor/LocaleInterceptor.js';\nimport deleteRequestInterceptor from './interceptor/DeleteRequestInterceptor.js';\n\nconst MODULE_NAME = 'clearcode.tm.security';\n\nAuthorization.$inject = [\n    `${MODULE_NAME}.security`,\n    '$state'\n];\n\nSecurity.$inject = [\n    '$q',\n    '$timeout',\n    `${MODULE_NAME}.tokenStorage`,\n    'clearcode.tm.user.userResource',\n    `${MODULE_NAME}.oauthResource`,\n    '$translate'\n];\n\nOAuthResource.$inject = [\n    '$http',\n    '$q',\n    `${MODULE_NAME}.tokenStorage`,\n    'OAuthClientSettings'\n];\n\nLoginController.$inject = [\n    `${MODULE_NAME}.oauthResource`,\n    `${MODULE_NAME}.tokenStorage`,\n    '$state',\n    'clearcode.tm.form.alertForm',\n    'clearcode.tm.pageInfo.pageInfo'\n];\n\nsecurityInterceptor.$inject = [\n    '$q',\n    `${MODULE_NAME}.tokenStorage`,\n    '$injector'\n];\n\nTokenStorage.$inject = [\n    '$localStorage'\n];\n\nlocaleInterceptor.$inject = [\n    '$window'\n];\n\ndeleteRequestInterceptor.$inject = [\n    '$q',\n    '$rootScope',\n    '$injector'\n];\n\nangular\n    .module(MODULE_NAME, [\n        'pascalprecht.translate',\n        'ui.router',\n        'clearcode.tm.alert',\n        'clearcode.tm.tagContainer',\n        'clearcode.tm.user',\n        'clearcode.tm.pageInfo',\n        'clearcode.tm.form',\n        'clearcode.tm.update'\n    ])\n    .config([\n        '$stateProvider',\n        '$httpProvider',\n\n        ($stateProvider, $httpProvider) => {\n            $httpProvider.interceptors.push(`${MODULE_NAME}.securityInterceptor`);\n            $httpProvider.interceptors.push(`${MODULE_NAME}.deleteRequestInterceptor`);\n            $httpProvider.interceptors.push(`${MODULE_NAME}.localeInterceptor`);\n\n            $stateProvider\n                .state('signIn', {\n                    url: '/sign-in',\n                    controller: `${MODULE_NAME}.LoginController`,\n                    controllerAs: 'view',\n                    data: {\n                        roles: [],\n                        secure: false\n                    },\n                    templateUrl: '/app/modules/security/views/signIn.html'\n                })\n                .state('accessDenied', {\n                    url: '/access-denied',\n                    data: {\n                        roles: []\n                    },\n                    templateUrl: '/app/modules/security/views/accessDenied.html'\n                });\n        }\n    ])\n    .run([\n        '$rootScope',\n        `${MODULE_NAME}.authorization`,\n        '$state',\n        `${MODULE_NAME}.security`,\n        'clearcode.tm.alert.$alert',\n        'clearcode.tm.tagContainer.currentContainer',\n\n        ($rootScope, authorization, $state, security, $alertProvider, currentContainer) => {\n            $alertProvider.addMessagePattern(\n                'login.invalid',\n                'Login or password is incorrect. Please try again.'\n            );\n\n            $alertProvider.addMessagePattern(\n                'request.error',\n                'User with passed email address does not exist.'\n            );\n\n            $alertProvider.addMessagePattern(\n                'request.success',\n                'The email with the activation link has been sent successfully.'\n            );\n\n            $alertProvider.addMessagePattern(\n                'changePassword.success',\n                'Password has been changed successfully.'\n            );\n\n            $alertProvider.addMessagePattern(\n                'changePassword.error',\n                'Sorry, something went wrong. Try to reset your password one more time.'\n            );\n\n            $alertProvider.addMessagePattern(\n                'changePassword.token',\n                'Reset password token is required.'\n            );\n\n            $alertProvider.addMessagePattern(\n                'changePassword.notCurrentPassword',\n                'This value should be the users current password.'\n            );\n\n            $alertProvider.addMessagePattern(\n                'invalid.email',\n                'Your email address is invalid.'\n            );\n\n            $alertProvider.addMessagePattern(\n                'password.different',\n                'Repeat password does not match.'\n            );\n\n            $alertProvider.addMessagePattern(\n                'password.both',\n                'Both password fields requires at least 8 characters.'\n            );\n\n            $alertProvider.addMessagePattern(\n                'password.first',\n                'First password field requires at least 8 characters.'\n            );\n\n            $alertProvider.addMessagePattern(\n                'password.second',\n                'Second password field requires at least 8 characters.'\n            );\n\n            $rootScope.logout = () => {\n                security.logout().then(() => {\n                    currentContainer.disableDebugMode();\n                    $state.go('signIn');\n                });\n            };\n\n            $rootScope.deleteHeaderNotSupported = false;\n            $rootScope.security = security;\n\n            $rootScope.$on('$stateChangeStart', (event, toState) => {\n                var isDataDefined = toState.data !== undefined, isSecure, roles;\n\n                if (isDataDefined) {\n                    isSecure = toState.data.secure !== undefined ? toState.data.secure : true;\n                    roles = toState.data.roles !== undefined ? toState.data.roles : [];\n                }\n\n                authorization.authorize(roles).then(\n                    () => {},\n                    () => {\n                        if (isSecure) {\n                            $state.go('signIn');\n                        }\n                    }\n                );\n            });\n        }\n    ])\n    .value('$localStorage', localStorage)\n    .controller(`${MODULE_NAME}.LoginController`, LoginController)\n    .service(`${MODULE_NAME}.authorization`, Authorization)\n    .service(`${MODULE_NAME}.security`, Security)\n    .service(`${MODULE_NAME}.oauthResource`, OAuthResource)\n    .service(`${MODULE_NAME}.tokenStorage`, TokenStorage)\n    .value('OAuthClientSettings', {\n        clientId: typeof OAUTH_CLIENT_ID === 'undefined' ? '1_1234567890' : OAUTH_CLIENT_ID,\n        clientSecret: typeof OAUTH_CLIENT_SECRET === 'undefined' ? 'sec1234567890' : OAUTH_CLIENT_SECRET\n    })\n    .factory(`${MODULE_NAME}.securityInterceptor`, securityInterceptor)\n    .factory(`${MODULE_NAME}.localeInterceptor`, localeInterceptor)\n    .factory(`${MODULE_NAME}.deleteRequestInterceptor`, deleteRequestInterceptor);\n\nmodule.exports = {MODULE_NAME};\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet security;\nlet state;\n\n/**\n * @name security#Authorization\n * @description\n * Service for authorization\n */\nclass Authorization {\n    constructor ($security, $state) {\n        security = $security;\n        state = $state;\n    }\n\n    authorize (roles) {\n        return security.getUser()\n            .then(() => {\n                if (doNotEnter(roles)) {\n                    state.go('signIn');\n                }\n            });\n    }\n}\n\nfunction doNotEnter (roles) {\n    let isAuthenticated = security.isAuthenticated();\n\n    return roles && roles.length > 0 && !security.hasAnyRole(roles) && !isAuthenticated;\n}\n\nexport default Authorization;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name Security\n * @description\n * Store information about current user access token\n */\nclass Security {\n    constructor ($q, $timeout, tokenStorage, userResource, oauthResource, $translate) {\n        this.q = $q;\n        this.timeout = $timeout;\n        this.user = undefined;\n        this.authenticated = false;\n        this.tokenStorage = tokenStorage;\n        this.userResource = userResource;\n        this.oauthResource = oauthResource;\n        this.translate = $translate;\n        this.checked = false;\n    }\n\n    isAuthenticated () {\n        return this.authenticated;\n    }\n\n    isChecked () {\n        return this.checked;\n    }\n\n    isSuperAdmin () {\n        return this.user.roles.indexOf('ROLE_SUPER_ADMIN') !== -1;\n    }\n\n    hasRole (roleString) {\n        if (!this.authenticated || roleString === undefined) {\n            return false;\n        }\n\n        return this.user.roles.indexOf(roleString) !== -1 || this.isSuperAdmin();\n    }\n\n    hasAnyRole (roles) {\n        if (!this.authenticated || roles === undefined) {\n            return false;\n        }\n\n        for (let i = 0; i < roles.length; i++) {\n            if (this.hasRole(roles[i])) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    authenticate (user) {\n        this.user = user;\n        this.authenticated = true;\n        this.translate.use(user.language);\n    }\n\n    logout () {\n        let deferred = this.q.defer();\n\n        this.oauthResource.logout().then(\n            () => {\n                this.user = undefined;\n                this.authenticated = false;\n                this.tokenStorage.removeItem();\n\n                deferred.resolve();\n            },\n            (err) => {\n                deferred.reject(err);\n            }\n        );\n\n        return deferred.promise;\n    }\n\n    getUser (force) {\n        let deferred = this.q.defer();\n\n        if (force) {\n            this.reloadUser();\n        }\n\n        if (this.user !== undefined) {\n            deferred.resolve(this.user);\n            this.authenticate(this.user);\n\n            return deferred.promise;\n        }\n\n        if (undefined !== this.tokenStorage.getItem()) {\n            if (!this.isAuthenticated()) {\n                this.reloadUser();\n            }\n        } else {\n            this.checked = true;\n            deferred.reject();\n        }\n\n        return deferred.promise;\n    }\n\n    reloadUser () {\n        let deferred = this.q.defer();\n\n        this.userResource.getMe().then(\n            (resp) => {\n                this.checked = true;\n\n                this.authenticate(resp);\n                deferred.resolve(this.user);\n            },\n            () => {\n                this.checked = true;\n            }\n        );\n    }\n}\n\nexport default Security;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet localStorage;\n\n/**\n * @name TokenStorage\n */\nclass TokenStorage {\n    constructor ($localStorage) {\n        localStorage = $localStorage;\n    }\n\n    getItem () {\n        let accessToken = localStorage.accessToken;\n\n        if (undefined !== accessToken) {\n            accessToken = JSON.parse(accessToken);\n        }\n\n        return accessToken;\n    }\n\n    getToken () {\n        let authToken = this.getItem();\n\n        return `${TokenStorage.capitalizeFirstLetter(authToken.tokenType)} ${authToken.accessToken}`;\n    }\n\n    static capitalizeFirstLetter (string) {\n        return string.charAt(0).toUpperCase() + string.slice(1);\n    }\n\n    addItem (authToken) {\n        localStorage.accessToken = JSON.stringify(authToken);\n\n        return authToken;\n    }\n\n    removeItem () {\n        localStorage.removeItem('accessToken');\n    }\n}\n\nexport default TokenStorage;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name AuthToken\n */\nclass AuthToken {\n    constructor () {\n        /**\n         * @type {string}\n         */\n        this.accessToken = undefined;\n\n        /**\n         * @type {number}\n         */\n        this.expiresIn = undefined;\n\n        /**\n         * @type {string}\n         */\n        this.tokenType = undefined;\n\n        /**\n         * @type {string}\n         */\n        this.scope = undefined;\n\n        /**\n         * @type {string}\n         */\n        this.refreshToken = undefined;\n    }\n}\n\nexport default AuthToken;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nconst BREADCRUMB_GLOBAL = 'Tags';\n\nconst TAG_TEMPLATE_TAB_ASYNC = 'async',\n    TAG_TEMPLATE_TAB_SYNC = 'sync',\n    PAGE_VIEW_TRIGGER_TYPE = 0,\n    DOM_READY_TRIGGER_TYPE = 4,\n    PAGE_LOAD_TRIGGER_TYPE = 5,\n    SYNCHRONOUS_TAGS_TRIGGER_TYPES = [PAGE_VIEW_TRIGGER_TYPE, DOM_READY_TRIGGER_TYPE, PAGE_LOAD_TRIGGER_TYPE];\n\n/**\n * @name BaseController\n */\nclass BaseController {\n    constructor (\n        $tagResource,\n        $triggerResource,\n        $variableResource,\n        $state,\n        $stateParams,\n        $alert,\n        $scope,\n        $timeout,\n        $TableParams,\n        $paramConverter,\n        CurrentContainer,\n        PageInfo,\n        templatesStorage,\n        $translate\n    ) {\n        this.alert = $alert;\n        this.state = $state;\n        this.scope = $scope;\n        this.stateParams = $stateParams;\n        this.triggerResource = $triggerResource;\n        this.TableParams = $TableParams;\n        this.paramConverter = $paramConverter;\n        this.currentContainer = CurrentContainer;\n\n        this.tag = $tagResource.getEntityObject();\n\n        this.tagPromise = undefined;\n\n        this.triggers = [];\n        this.chosenTriggers = [];\n        this.triggerPromise = undefined;\n        this.displayStepsAfterFirst = false;\n        this.templatesStorage = templatesStorage;\n        this.synchronousTemplates = [];\n        this.asynchronousTemplates = [];\n        this.triggersWhenTagIsAsync = [];\n        this.scope.tagTemplateTab = TAG_TEMPLATE_TAB_ASYNC;\n        this.divideTemplatesBasedOnSynchronicity($timeout);\n\n        this.template = undefined;\n        this.translate = $translate;\n        this.variables = [];\n\n        this.textEditorConfig = {};\n        this.isCodeEditorFocused = false;\n\n        $variableResource.queryAllAvailable(this.stateParams.containerId).then( resp => {\n            this.variables = resp.data;\n        });\n\n        this.textEditorConfig.onLoad = cm => {\n            cm.options.variables = this.variables;\n\n            $scope.insertVariableIntoCode = variable => {\n                cm.doc.replaceSelection(`{{ ${variable.name} }}`);\n                cm.focus();\n            };\n\n            cm.on('focus', () => {\n                this.isCodeEditorFocused = true;\n            });\n\n            cm.on('blur', () => {\n                this.isCodeEditorFocused = false;\n            });\n        };\n\n        $scope.$on('trigger.add', (event, resp) => {\n            this.tag.addTrigger(resp);\n            this.showTriggerForm = false;\n            this.validateTriggers = false;\n        });\n\n        $scope.$on('trigger.edit', (event, resp) => {\n            this.tag.editTrigger(resp);\n            this.editTriggerForm = false;\n            this.validateTriggers = false;\n        });\n\n        this.translate(['Place the code']).then((translations) => {\n            this.textEditorConfig.placeholder = translations['Place the code'];\n        });\n\n        this.currentContainer.getContainer().then(() => {\n            if (this.currentContainer.$container.hasPermission('noaccess')) {\n                $state.go('container');\n            }\n\n            this\n                .translate([this.getBreadcrumbText(), BREADCRUMB_GLOBAL])\n                .then((translations) => {\n                    PageInfo.clear()\n                        .add(this.currentContainer.$container.name, 'tags', {\n                            containerId: this.currentContainer.$container.id\n                        })\n                        .add(translations[BREADCRUMB_GLOBAL], 'tags', {\n                            containerId: this.currentContainer.$container.id\n                        })\n                        .add(translations[this.getBreadcrumbText()])\n                        .broadcast();\n                });\n        });\n\n        $scope.$on('pageInfo.reload', (event, args) => {\n            this\n                .translate([this.getBreadcrumbText(), BREADCRUMB_GLOBAL])\n                .then((translations) => {\n                    PageInfo.clear()\n                        .add(args.name, 'tags', {\n                            containerId: args.id\n                        })\n                        .add(translations[BREADCRUMB_GLOBAL], 'tags', {\n                            containerId: args.id\n                        })\n                        .add(translations[this.getBreadcrumbText()])\n                        .broadcast();\n                });\n        });\n    }\n\n    divideTemplatesBasedOnSynchronicity ($timeout) {\n        let alreadyLoadedTemplates = this.templatesStorage.getAll(),\n            classifyTemplate = template => {\n                if (template.isSynchronous) {\n                    this.synchronousTemplates.push(template);\n                } else {\n                    this.asynchronousTemplates.push(template);\n                }\n            },\n            classifyAfterAllTemplateDataLoaded  = (template) => {\n                $timeout(() => classifyTemplate(template), 0);\n            };\n\n        for (let i = 0; i < alreadyLoadedTemplates.length; i++) {\n            classifyAfterAllTemplateDataLoaded(alreadyLoadedTemplates[i]);\n        }\n        this.templatesStorage.setListener(classifyAfterAllTemplateDataLoaded);\n    }\n\n    hasVariables () {\n        let variablesNotEmpty = angular.isArray(this.variables) && this.variables.length > 0;\n        return !this.isTagTemplateTabActive(TAG_TEMPLATE_TAB_SYNC) && variablesNotEmpty;\n    }\n\n    setTagTemplateTab (tab, keepCurrentTemplate) {\n        if (tab === this.scope.tagTemplateTab) {\n            return;\n        }\n\n        if (!keepCurrentTemplate) {\n            this.deselectCurrentTemplate();\n        }\n\n        this.scope.tagTemplateTab = tab;\n        this.tag.isSynchronous = this.isTagTemplateTabActive(TAG_TEMPLATE_TAB_SYNC);\n        this.rememeberCurrentTriggers();\n\n        if (this.isTagTemplateTabActive(TAG_TEMPLATE_TAB_SYNC)) {\n            this.documentWirteWhenTagIsAsync = this.tag.documentWrite;\n            this.tag.documentWrite = true;\n        } else {\n            this.tag.documentWrite = this.documentWirteWhenTagIsAsync;\n        }\n    }\n\n    rememeberCurrentTriggers () {\n        if (this.isTagTemplateTabActive(TAG_TEMPLATE_TAB_SYNC)) {\n            this.triggersWhenTagIsAsync = this.tag.triggers || [];\n            this.tag.triggers = filterTriggersForSynchronousTags(this.triggersWhenTagIsAsync);\n        } else {\n            this.tag.triggers = this.triggersWhenTagIsAsync;\n        }\n    }\n\n    hasTriggersNotAssignableToSyncTags () {\n        let allTags = this.triggersWhenTagIsAsync || [],\n            triggersAssignableToSyncTags = filterTriggersForSynchronousTags(allTags);\n        return triggersAssignableToSyncTags.length !== allTags.length;\n    }\n\n    isTagTemplateTabActive (tab) {\n        return tab === this.scope.tagTemplateTab;\n    }\n\n    currentTemplateAllowsToSetRVP () {\n        let templateIsTracking = this.hasSelectedPluginTemplate() && this.template.isTracking;\n        return this.hasSelectedCustomTemplate() || templateIsTracking;\n    }\n\n    setTagTemplate (id) {\n        let selectedSameTemplateAsCurrent = this.tag.template === id;\n        if (selectedSameTemplateAsCurrent) {\n            this.deselectCurrentTemplate();\n            return false;\n        }\n\n        this.tag.template = id;\n\n        if (this.hasSelectedPluginTemplate()) {\n            this.template = this.templatesStorage.get(id);\n            this.tag.code = undefined;\n\n            let requiresAdditionalSelectTemplateType = this.template.types.length !== 0;\n            if (requiresAdditionalSelectTemplateType) {\n                this.displayStepsAfterFirst = false;\n            } else {\n                this.setTemplateType(id);\n            }\n\n            this.tag.respectVisitorsPrivacy = this.template.isTracking;\n        } else {\n            this.displayStepsAfterFirst = true;\n            this.tag.respectVisitorsPrivacy = this.isTagTemplateTabActive(TAG_TEMPLATE_TAB_ASYNC);\n        }\n    }\n\n    initTagTemplate (id, options) {\n        this.tag.template = id;\n        this.setTagTemplateTab(this.tag.isSynchronous ? TAG_TEMPLATE_TAB_SYNC : TAG_TEMPLATE_TAB_ASYNC, true);\n\n        if (this.hasSelectedPluginTemplate()) {\n            this.template = this.templatesStorage.get(id);\n            this.tag.code = undefined;\n\n            if (this.template.types.length === 0) {\n                this.tag.templateOptions = options;\n                this.templateFields = this.templatesStorage.getOptions(id);\n                this.template.templateUrl = this.templatesStorage.getTemplateUrl(id);\n            } else {\n                this.tag.templateOptions.type = options.type;\n                this.templateFields = this.templatesStorage.getOptions(id, options.type);\n                this.template.templateUrl = this.templatesStorage.getTemplateUrl(id, options.type);\n            }\n        }\n\n        this.displayStepsAfterFirst = true;\n    }\n\n    setTemplateType (id, type) {\n        let selectedSameTypeAsCurrent = this.tag.templateOptions.type !== undefined && this.tag.templateOptions.type === type;\n        if (selectedSameTypeAsCurrent) {\n            return false;\n        }\n\n        this.templateFields = this.templatesStorage.getOptions(id, type);\n        this.setOptions();\n        this.tag.templateOptions.type = type;\n        this.template.templateUrl = this.templatesStorage.getTemplateUrl(id, type);\n        this.displayStepsAfterFirst = true;\n    }\n\n    setOptions () {\n        let fieldsLength = this.templateFields.length;\n        this.tag.templateOptions = {};\n\n        while (fieldsLength--) {\n            this.tag.templateOptions[this.templateFields[fieldsLength].name] = this.templateFields[fieldsLength].value;\n        }\n    }\n\n    showExistingTriggers () {\n        this.chosenTriggers = [];\n        this.prepareExistingTriggersList();\n        this.showListTriggersForm = true;\n    }\n\n    showAddNewTriggerForm () {\n        this.validateTriggers = false;\n        this.showTriggerForm = true;\n    }\n\n    prepareExistingTriggersList () {\n        this.triggers = [];\n        this.types = [\n            'Page View',\n            'Click',\n            'Event',\n            'Form submission'\n        ];\n\n        this.existingTable = new this.TableParams({\n            page: 1,\n            count: 10,\n            sorting: {\n                name: 'asc'\n            }\n        }, {\n            total: 0,\n            getData: ($defer, params) => {\n                let parameters = this.paramConverter.list(params.url());\n                parameters['exclude[]'] = this.tag.triggers.map(trigger => trigger.id);\n                parameters['types[]'] = this.isTagTemplateTabActive(TAG_TEMPLATE_TAB_SYNC) ? SYNCHRONOUS_TAGS_TRIGGER_TYPES : [];\n\n                this.triggerResource.query(this.currentContainer.$container.id, parameters).then(\n                    (resp) => {\n                        params.total(resp.total);\n                        $defer.resolve(resp.data);\n                    }\n                );\n            }\n        });\n    }\n\n    addExistingTriggers () {\n        let chosenLength = this.chosenTriggers.length;\n\n        while (chosenLength--) {\n            this.tag.triggers.push(this.chosenTriggers[chosenLength]);\n        }\n    }\n\n    submitForm (tag) {\n        this.tagPromise = tag.save(this.stateParams.containerId);\n\n        this.tagPromise.then(\n            () => {\n                this.alert.success(this.getAlertType(this.stateParams.tagId));\n                this.currentContainer.makeChanges();\n                this.state.go('tags', {containerId: this.stateParams.containerId});\n            },\n            () => {\n                this.alert.error('error.invalid');\n            }\n        );\n    }\n\n    displayInvalidFormMessage () {\n        this.validateTag = true;\n        this.alert.error('error.invalid');\n    }\n\n    deselectCurrentTemplate () {\n        this.template = undefined;\n        this.tag.template = null;\n        this.displayStepsAfterFirst = false;\n\n        this.editTriggerForm = false;\n        this.showTriggerForm = false;\n        this.showListTriggersForm = false;\n    }\n\n    hasSelectedTemplate () {\n        return this.tag.template !== null;\n    }\n\n    hasSelectedCustomTemplate () {\n        return this.hasSelectedTemplate() && this.tag.template === undefined;\n    }\n\n    hasSelectedPluginTemplate () {\n        return this.hasSelectedTemplate() && !this.hasSelectedCustomTemplate();\n    }\n}\n\nfunction filterTriggersForSynchronousTags (triggers) {\n    let result = [];\n    for (let i = 0; i < triggers.length; i++) {\n        if (SYNCHRONOUS_TAGS_TRIGGER_TYPES.indexOf(triggers[i].type) !== -1) {\n            result.push(triggers[i]);\n        }\n    }\n    return result;\n}\n\nexport default BaseController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport BaseController from './BaseController.js';\n\n/**\n * @name CreateController\n */\nclass CreateController extends BaseController {\n    constructor (\n        $tagResource,\n        $triggerResource,\n        $variableResource,\n        $state,\n        $stateParams,\n        $alert,\n        $scope,\n        $timeout,\n        $TableParams,\n        $paramConverter,\n        CurrentContainer,\n        PageInfo,\n        TemplatesStorage,\n        $translate\n    ) {\n        super(\n            $tagResource,\n            $triggerResource,\n            $variableResource,\n            $state,\n            $stateParams,\n            $alert,\n            $scope,\n            $timeout,\n            $TableParams,\n            $paramConverter,\n            CurrentContainer,\n            PageInfo,\n            TemplatesStorage,\n            $translate\n        );\n    }\n\n    getBreadcrumbText () {\n        return 'Add a new tag';\n    }\n\n    getAlertType () {\n        return 'success.create';\n    }\n}\n\nexport default CreateController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport BaseController from './BaseController.js';\n\n/**\n * @name EditController\n */\nclass EditController extends BaseController {\n    constructor (\n        $tagResource,\n        $triggerResource,\n        $variableResource,\n        $state,\n        $stateParams,\n        $alert,\n        $scope,\n        $timeout,\n        $TableParams,\n        $paramConverter,\n        CurrentContainer,\n        PageInfo,\n        templatesStorage,\n        $translate\n    ) {\n        super(\n            $tagResource,\n            $triggerResource,\n            $variableResource,\n            $state,\n            $stateParams,\n            $alert,\n            $scope,\n            $timeout,\n            $TableParams,\n            $paramConverter,\n            CurrentContainer,\n            PageInfo,\n            templatesStorage,\n            $translate\n        );\n\n        this.tagPromise = $tagResource.get($stateParams.tagId);\n        this.tagPromise.then(\n            (resp) => {\n                this.tag = resp;\n                this.initTagTemplate(this.tag.template, this.tag.templateOptions);\n            }\n        );\n    }\n\n    getBreadcrumbText () {\n        return 'Configure tag';\n    }\n\n    getAlertType () {\n        return 'success.edit';\n    }\n}\n\nexport default EditController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet $alert;\nlet stateParams;\nlet scope;\n\nconst BREADCRUMB_TEXT = 'Tags';\n\n/**\n * @name ManageController\n */\nclass ManageController {\n    constructor (\n        TableParams,\n        $stateParams,\n        tagResource,\n        publishedStatus,\n        alert,\n        paramConverter,\n        CurrentContainer,\n        PageInfo,\n        $scope,\n        state,\n        $translate\n    ) {\n        $alert = alert;\n        stateParams = $stateParams;\n        scope = $scope;\n        this.permissions = [];\n\n        this.containerId = stateParams.containerId;\n        this.translate = $translate;\n        this.currentContainer = CurrentContainer;\n        this.publishedStatus = publishedStatus;\n\n        this.currentContainer.getContainer().then((container) => {\n            if (!this.currentContainer.$container.hasPermission('view')) {\n                state.go('container');\n            } else {\n                this.permissions = this.currentContainer.$container.permissions;\n            }\n\n            this\n                .translate([BREADCRUMB_TEXT])\n                .then((translations) => {\n                    PageInfo.clear()\n                        .add(container.name, 'tags', {\n                            containerId: container.id\n                        })\n                        .add(translations[BREADCRUMB_TEXT])\n                        .broadcast();\n                });\n        });\n\n        this.tableParams = new TableParams({\n            page: 1,\n            count: 10,\n            sorting: {\n                name: 'asc'\n            }\n        }, {\n            total: 0,\n            $scope: $scope,\n            getData: ($defer, params) => {\n                tagResource.query(stateParams.containerId, paramConverter.list(params.url())).then((resp) => {\n                    params.total(resp.total);\n                    $defer.resolve(resp.data);\n                });\n            }\n        });\n\n        this.tableParams.reload();\n        scope.params = this.tableParams;\n\n        this.addReloadOnPublishListener($scope);\n\n        // behaviour after page change\n        $scope.$on('ngTableAfterReloadData', () => {\n            this.showTriggers = -1;\n            this.showMenu = -1;\n        }, true);\n\n        $scope.$watch('params.$params', (newParams, oldParams) => {\n            if (newParams === oldParams) {\n                return;\n            }\n\n            $scope.params.settings().$scope = $scope;\n            $scope.params.reload();\n        }, true);\n\n        scope.$on('pageInfo.reload', (event, args) => {\n            this\n                .translate([BREADCRUMB_TEXT])\n                .then((translations) => {\n                    PageInfo.clear()\n                        .add(args.name, 'tags', {\n                            containerId: args.id\n                        })\n                        .add(translations[BREADCRUMB_TEXT])\n                        .broadcast();\n                });\n        });\n    }\n\n    addReloadOnPublishListener ($scope) {\n        let deregisterPublishListener = $scope.$on('container-published', () => {\n            $scope.params.reload();\n        });\n        $scope.$on('$destroy', () => {\n            deregisterPublishListener();\n        });\n    }\n\n    removeTag (tag) {\n        tag.remove().then(\n            () => {\n                $alert.success('success.remove');\n                this.currentContainer.makeChanges();\n\n                if (this.tableParams.data.length === 1 && this.tableParams.page() > 1) {\n                    this.tableParams.page(this.tableParams.page() - 1);\n                } else {\n                    this.tableParams.reload();\n                }\n            },\n            () => {\n                $alert.error('error.remove');\n                this.tableParams.reload();\n            }\n        );\n    }\n\n    changeStatus (tag) {\n        tag.changeStatus(this.containerId).then(\n            () => {\n                this.currentContainer.makeChanges();\n                $alert.success('status.change');\n            },\n            () => {\n                $alert.error('status.failed');\n            }\n        );\n    }\n\n    getPublishedStatus (tag) {\n        return this.publishedStatus.getPublishedStatusForTag(tag);\n    }\n\n    toggleActionMenu ($index) {\n        if (this.permissions.indexOf('edit') !== -1 ) {\n            this.showMenu = this.showMenu === $index\n                ? -1\n                : $index;\n\n            this.showTriggers = -1;\n        }\n    }\n\n    toggleTriggerList ($index) {\n        this.showMenu = -1;\n        this.showTriggers = this.isRowExpanded($index) ? -1 : $index;\n    }\n\n    isRowExpanded ($index) {\n        return this.showTriggers === $index;\n    }\n}\n\nexport default ManageController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet tagFactory = (resource) => {\n    /**\n     * @name Variable\n     * @description Variable entity\n     */\n    class Tag {\n        constructor () {\n            /**\n             * @type {number}\n             */\n            this.id = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.name = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.code = undefined;\n\n            /**\n             * @type {Array}\n             */\n            this.triggers = [];\n\n            /**\n             * @type {string}\n             */\n            this.updatedAt = undefined;\n\n            /**\n             * @type {number}\n             */\n            this.priority = 0;\n\n            /**\n             * @type {boolean}\n             */\n            this.documentWrite = false;\n\n            /**\n             * @type {boolean}\n             */\n            this.disableInDebugMode = false;\n\n            /**\n             * @type {boolean}\n             */\n            this.respectVisitorsPrivacy = false;\n\n            /**\n             * @type {boolean}\n             */\n            this.isSynchronous = false;\n\n            /**\n             * @type {boolean}\n             */\n            this.isActive = true;\n\n            /**\n             * @type {string}\n             */\n            this.template = null;\n\n            /**\n             * @type {Object}\n             */\n            this.templateOptions = {};\n\n            /**\n             * @type {boolean}\n             */\n            this.statusChangePending = false;\n        }\n\n        /**\n         * @param {Trigger} trigger\n         */\n        addTrigger (trigger) {\n            this.triggers.push(trigger);\n        }\n\n        /**\n         * @param {Trigger} trigger\n         */\n        editTrigger (trigger) {\n            let index = this.triggers.length;\n\n            while (index--) {\n                if (this.triggers[index].id === trigger.id) {\n                    this.triggers[index] = trigger;\n\n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n        /**\n         * @param {Trigger} trigger\n         */\n        removeTrigger (trigger) {\n            var index = this.triggers.indexOf(trigger);\n\n            if (index > -1) {\n                this.triggers.splice(index, 1);\n\n                return true;\n            }\n\n            return false;\n        }\n\n        /**\n         * @param {Number} id\n         */\n        removeTriggerById (id) {\n            var index = this.triggers.length;\n\n            while (index--) {\n                if (this.triggers[index].id === id) {\n                    this.triggers.splice(index, 1);\n\n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n        /**\n         * @param {number} containerId\n         *\n         * @returns {deferred.promise}\n         */\n        save (containerId) {\n            var result = {}, promise;\n            var excludedProperty = ['id', 'updatedAt', 'createdAt', 'statusChangePending'];\n\n            if (this.template === undefined) {\n                excludedProperty.push('templateOptions');\n            } else {\n                excludedProperty.push('code');\n                excludedProperty.push('documentWrite');\n            }\n\n            for (var property in this) {\n                if (\n                    !angular.isFunction(this[property]) &&\n                    this.hasOwnProperty(property) &&\n                    excludedProperty.indexOf(property) === -1\n                ) {\n                    if (property === 'triggers') {\n                        var collection = [];\n\n                        for (var index in this[property]) {\n                            if (this[property][index] instanceof Object) {\n                                collection.push(this[property][index].id);\n                            }\n                        }\n\n                        result[property] = collection;\n                    } else {\n                        result[property] = this[property];\n                    }\n                }\n            }\n\n            if (this.id === undefined) {\n                promise = resource.post(containerId, result);\n            } else {\n                promise = resource.put(this.id, result);\n            }\n\n            return promise;\n        }\n\n        /**\n         * @returns {deferred.promise|Boolean}\n         */\n        remove () {\n            if (this.id === undefined) {\n                return false;\n            }\n\n            return resource.delete(this.id);\n        }\n\n        /**\n         * @param containerId\n         * @returns {deferred.promise}\n         */\n        changeStatus (containerId) {\n            let tag = angular.copy(this);\n            tag.isActive = !tag.isActive;\n            this.statusChangePending = true;\n\n            let promise = tag.save(containerId).then(\n                (tag) => {\n                    this.isActive = !this.isActive;\n                    this.updatedAt = tag.updatedAt;\n                }\n            ).finally(\n                () => {\n                    this.statusChangePending = false;\n                }\n            );\n\n            return promise;\n        }\n    }\n\n    return Tag;\n};\n\nexport default tagFactory;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport templateTypeFactory from '../entity/TemplateType.js';\n\nvar templateFactory = () => {\n    let TemplateType = templateTypeFactory();\n\n    class Template {\n        constructor (id, name) {\n            this.id = id;\n            this.name = name;\n            this.brandUrl = undefined;\n            this.templateUrl = undefined;\n            this.type = undefined;\n            this.types = [];\n            this.fields = [];\n            this.isSynchronous = false;\n            this.isTracking = true;\n        }\n\n        addTextField (params) {\n            let field = params ? params : {};\n            field.type = 'text';\n            this.fields.push(field);\n            return this;\n        }\n\n        addHiddenField (name, value) {\n            let field = {};\n            field.name = name;\n            field.value = value;\n            field.type = 'hidden';\n            this.fields.push(field);\n            return this;\n        }\n\n        addSelectField (params) {\n            let field = params ? params : {};\n            field.type = 'select';\n            this.fields.push(field);\n            return this;\n        }\n\n        addType (id, name) {\n            let type = new TemplateType(id, name);\n            this.types.push(type);\n            return type;\n        }\n\n        addBrand (url) {\n            this.brandUrl = url;\n            return this;\n        }\n\n        addTemplateUrl (url) {\n            this.templateUrl = url;\n            return this;\n        }\n\n        setSynchronous (isSynchronous) {\n            this.isSynchronous = isSynchronous;\n            return this;\n        }\n\n        setTracking (isTracking) {\n            this.isTracking = isTracking;\n            return this;\n        }\n    }\n\n    return Template;\n};\n\n\nexport default templateFactory;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nvar templateTypeFactory = () => {\n    class TemplateType {\n        constructor (id, name) {\n            /**\n             * @type {string}\n             */\n            this.id = id;\n\n            /**\n             * @type {string}\n             */\n            this.name = name;\n\n            /**\n             * @type {string}\n             */\n            this.templateUrl = undefined;\n\n            /**\n             * @type {object}\n             */\n            this.fields = [];\n        }\n\n        addTextField (params) {\n            let field = params ? params : {};\n\n            field.type = 'text';\n            this.fields.push(field);\n\n            return this;\n        }\n\n        addHiddenField (name, value) {\n            let field = {};\n\n            field.name = name;\n            field.value = value;\n            field.type = 'hidden';\n\n            this.fields.push(field);\n\n            return this;\n        }\n\n        addTemplateUrl (url) {\n            this.templateUrl = url;\n\n            return this;\n        }\n    }\n\n    return TemplateType;\n};\n\nexport default templateTypeFactory;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport templateFactory from '../entity/Template.js';\n\nlet Template = templateFactory();\n\n/**\n * @name TemplatesProvider\n */\nclass TemplatesProvider {\n    constructor () {\n        this.collection = [];\n        this.onAddListener;\n    }\n\n    setListener (listener) {\n        this.onAddListener = listener;\n    }\n\n    add (id, name) {\n        let template = new Template(id, name);\n        this.collection.push(template);\n\n        if (this.onAddListener) {\n            this.onAddListener(template);\n        }\n\n        return template;\n    }\n\n    get (id) {\n        let templateLength = this.collection.length;\n\n        while (templateLength--) {\n            if (this.collection[templateLength].id === id) {\n                return this.collection[templateLength];\n            }\n        }\n\n        return false;\n    }\n\n    getAll () {\n        return this.collection;\n    }\n\n    $get () {\n        return this;\n    }\n}\n\nexport default TemplatesProvider;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport tagFactory from '../entity/Tag.js';\n\nvar transformResponse = function (resp) {\n    var Tag = tagFactory(this);\n    var tag = new Tag();\n\n    tag.id = resp.id;\n    tag.name = resp.name;\n    tag.code = resp.code;\n    tag.priority = resp.priority;\n    tag.updatedAt = resp.updated_at;\n    tag.createdAt = resp.created_at;\n    tag.documentWrite = resp.document_write;\n    tag.disableInDebugMode = resp.disable_in_debug_mode;\n    tag.isActive = resp.is_active;\n    tag.respectVisitorsPrivacy = resp.respect_visitors_privacy;\n    tag.isSynchronous = resp.is_synchronous;\n\n    if (resp.template !== null) {\n        tag.template = resp.template;\n        tag.templateOptions = resp.template_options;\n    } else {\n        tag.template = undefined;\n    }\n\n    for (var key in resp.triggers) {\n        if (resp.triggers[key] instanceof Object) {\n            tag.addTrigger(resp.triggers[key]);\n        }\n    }\n\n    return tag;\n};\n\n\nvar appendTransform = function (defaults, transform) {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name TagResource\n */\nclass TagResource {\n    constructor ($http, $q) {\n        this.http = $http;\n        this.q = $q;\n    }\n\n    getEntityObject () {\n        var Tag = tagFactory(this);\n\n        return new Tag();\n    }\n\n    get (id) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: `/api/tags/${id}`,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (status < 400) {\n                    return transformResponse.call(this, resp.data);\n                } else {\n                    return resp;\n                }\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    query (containerId, params) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: `/api/containers/${containerId}/tags`,\n            params: params,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp) => {\n                for (var element in resp.data) {\n                    if (resp.data[element] instanceof Object) {\n                        resp.data[element] = transformResponse.call(this, resp.data[element]);\n                    }\n                }\n\n                return resp;\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    delete (id) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'DELETE',\n            url: `/api/tags/${id}`\n        })\n            .success((data) => {\n                deferred.resolve(data);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    post (containerId, entity) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'POST',\n            url: `/api/containers/${containerId}/tags`,\n            data: entity,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (status < 400) {\n                    return transformResponse.call(this, resp.data);\n                } else {\n                    return resp;\n                }\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    put (id, entity) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'PUT',\n            url: `/api/tags/${id}`,\n            data: entity,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (status < 400) {\n                    return transformResponse.call(this, resp.data);\n                } else {\n                    return resp;\n                }\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n}\n\nexport default TagResource;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet findByKey = function (collection, key, value) {\n    let collectionLength = collection.length;\n\n    while (collectionLength--) {\n        if (collection[collectionLength][key] === value) {\n            return collection[collectionLength];\n        }\n    }\n\n    return false;\n};\n\n/**\n * @name Templates\n */\nclass Templates {\n    constructor ($templates) {\n        this.templatesService = $templates;\n        this.collection = this.templatesService.getAll();\n    }\n\n    setListener (listener) {\n        this.templatesService.setListener(listener);\n    }\n\n    getAll () {\n        return this.collection;\n    }\n\n    get (id) {\n        let collectionLength = this.collection.length;\n\n        while (collectionLength--) {\n            if (this.collection[collectionLength].id === id) {\n                return this.collection[collectionLength];\n            }\n        }\n\n        return false;\n    }\n\n    getOptions (id, typeId) {\n        let template = findByKey(this.collection, 'id', id);\n\n        if (template) {\n            if (typeId) {\n                let type = findByKey(template.types, 'id', typeId);\n\n                return type && type.hasOwnProperty('fields')\n                    ? type.fields\n                    : false;\n            }\n\n            return template.hasOwnProperty('fields')\n                ? template.fields\n                : false;\n        }\n\n        return false;\n    }\n\n    getTemplateUrl (id, typeId) {\n        let template = findByKey(this.collection, 'id', id);\n\n        if (typeId) {\n            let type = findByKey(template.types, 'id', typeId);\n\n            return type\n                ? type.templateUrl\n                : false;\n        }\n\n        return template.templateUrl;\n    }\n}\n\nexport default Templates;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport CreateController from './controllers/CreateController.js';\nimport EditController from './controllers/EditController.js';\nimport ManageController from './controllers/ManageController.js';\n\nimport TagResource from './resource/TagResource.js';\nimport Templates from './services/Templates.js';\nimport TemplatesProvider from './providers/TemplatesProvider.js';\n\nconst MODULE_NAME = 'clearcode.tm.tag';\nconst MODULE_TRIGGER = 'clearcode.tm.trigger';\nconst MODULE_VARIABLE = 'clearcode.tm.variable';\nconst MODULE_TAG_CONTAINER = 'clearcode.tm.tagContainer';\nconst MODULE_DIR = 'app/modules/tag';\n\nTemplates.$inject = [\n    `${MODULE_NAME}.$template`\n];\n\nTagResource.$inject = [\n    '$http',\n    '$q'\n];\n\nManageController.$inject = [\n    'ngTableParams',\n    '$stateParams',\n    `${MODULE_NAME}.tagResource`,\n    `${MODULE_TAG_CONTAINER}.publishedStatus`,\n    'clearcode.tm.alert.alert',\n    `${MODULE_TAG_CONTAINER}.paramConverter`,\n    `${MODULE_TAG_CONTAINER}.currentContainer`,\n    'clearcode.tm.pageInfo.pageInfo',\n    '$scope',\n    '$state',\n    '$translate'\n];\n\nCreateController.$inject = [\n    `${MODULE_NAME}.tagResource`,\n    `${MODULE_TRIGGER}.triggerResource`,\n    `${MODULE_VARIABLE}.variableResource`,\n    '$state',\n    '$stateParams',\n    'clearcode.tm.alert.alert',\n    '$scope',\n    '$timeout',\n    'ngTableParams',\n    `${MODULE_TAG_CONTAINER}.paramConverter`,\n    `${MODULE_TAG_CONTAINER}.currentContainer`,\n    'clearcode.tm.pageInfo.pageInfo',\n    `${MODULE_NAME}.templatesStorage`,\n    '$translate'\n];\n\nEditController.$inject = [\n    `${MODULE_NAME}.tagResource`,\n    `${MODULE_TRIGGER}.triggerResource`,\n    `${MODULE_VARIABLE}.variableResource`,\n    '$state',\n    '$stateParams',\n    'clearcode.tm.alert.alert',\n    '$scope',\n    '$timeout',\n    'ngTableParams',\n    `${MODULE_TAG_CONTAINER}.paramConverter`,\n    `${MODULE_TAG_CONTAINER}.currentContainer`,\n    'clearcode.tm.pageInfo.pageInfo',\n    `${MODULE_NAME}.templatesStorage`,\n    '$translate'\n];\n\nmodule.exports = {MODULE_NAME};\nangular\n    .module(MODULE_NAME, [\n        'pascalprecht.translate',\n        'ui.router',\n        'ngTable',\n        'clearcode.tm.alert',\n        'clearcode.tm.pageInfo',\n        'clearcode.tm.tagContainer',\n        'clearcode.tm.trigger',\n        'ui.codemirror'\n    ])\n    .config([\n        '$stateProvider',\n\n        ($stateProvider) => {\n            $stateProvider\n                .state('tags', {\n                    url: '/containers/{containerId}/tags',\n                    controller: `${MODULE_NAME}.ManageController as view`,\n                    templateUrl: `${MODULE_DIR}/views/manage.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: true\n                    }\n                })\n                .state('tagCreate', {\n                    url: '/containers/{containerId}/tag-create',\n                    controller: `${MODULE_NAME}.CreateController as view`,\n                    templateUrl: `${MODULE_DIR}/views/create.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: true\n                    }\n                })\n                .state('tagEdit', {\n                    url: '/containers/{containerId}/tag/edit/{tagId}',\n                    controller: `${MODULE_NAME}.EditController as view`,\n                    templateUrl: `${MODULE_DIR}/views/edit.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: true\n                    }\n                });\n        }\n    ])\n    .run([\n        'clearcode.tm.alert.$alert',\n\n        ($alertProvider) => {\n            $alertProvider.addMessagePattern(\n                'trigger.close',\n                'You are trying to close unsaved trigger.'\n            );\n\n            $alertProvider.addMessagePattern(\n                'status.change',\n                'Tag status was changed successfully'\n            );\n\n            $alertProvider.addMessagePattern(\n                'status.failed',\n                'Sorry, something went wrong.'\n            );\n        }\n    ])\n    .provider(`${MODULE_NAME}.$template`, TemplatesProvider)\n    .controller(`${MODULE_NAME}.ManageController`, ManageController)\n    .controller(`${MODULE_NAME}.CreateController`, CreateController)\n    .controller(`${MODULE_NAME}.EditController`, EditController)\n    .service(`${MODULE_NAME}.tagResource`, TagResource)\n    .service(`${MODULE_NAME}.templatesStorage`, Templates);\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet state;\nlet $alert;\n\nconst BREADCRUMB_TEXT = 'Add a container';\n\n/**\n * @name CreateController\n */\nclass CreateController {\n    constructor (containerResource, $state, alert, PageInfo, $translate) {\n        state = $state;\n        $alert = alert;\n        this.container = containerResource.getEntityObject();\n        this.translate = $translate;\n\n        this\n            .translate([BREADCRUMB_TEXT])\n            .then((translations) => {\n                PageInfo.clear()\n                    .add(translations[BREADCRUMB_TEXT])\n                    .broadcast();\n            });\n    }\n\n    submitForm (container) {\n        this.containerPromise = container.save();\n        this.containerPromise.then(\n            (resp) => {\n                $alert.success('container.create');\n                state.go('containerExplanation', {containerId: resp.id});\n            },\n            () => {\n                $alert.error('error.invalid');\n            }\n        );\n    }\n\n    displayInvalidFormMessage () {\n        this.validateContainer = true;\n        $alert.error('error.invalid');\n    }\n}\n\nexport default CreateController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet state;\nlet stateParams;\nlet alert;\nlet currentContainer;\nlet scope;\n\nconst BREADCRUMB_TEXT = 'Options';\n\n/**\n * @name EditController\n */\nclass EditController {\n    constructor (\n        containerResource,\n        $state,\n        $stateParams,\n        $alert,\n        CurrentContainer,\n        PageInfo,\n        $scope,\n        $translate\n    ) {\n        state = $state;\n        stateParams = $stateParams;\n        alert = $alert;\n        currentContainer = CurrentContainer;\n        scope = $scope;\n\n        this.pageInfo = PageInfo;\n        this.container = containerResource.getEntityObject();\n        this.containerPromise = containerResource.get(stateParams.containerId);\n        this.containerPromise.then((resp) => {\n            this.container = resp;\n        });\n\n        this.translate = $translate;\n        currentContainer.getContainer().then(() => {\n            if (currentContainer.$container.hasPermission('noaccess')) {\n                state.go('container');\n            }\n\n            this.refreshBreadcrumb(BREADCRUMB_TEXT, currentContainer.$container);\n        });\n\n        scope.$on('pageInfo.reload', (event, container) => {\n            this.refreshBreadcrumb(BREADCRUMB_TEXT, container);\n        });\n    }\n\n    removeContainer () {\n        this.container.remove().then(\n            () => {\n                alert.success('success.remove');\n                state.go('container');\n            },\n            () => {\n                alert.error('error.remove');\n            }\n        );\n    }\n\n    submitForm (container) {\n        this.containerPromise = container.save();\n\n        this.containerPromise.then(\n            (container) => {\n                this.refreshBreadcrumb(BREADCRUMB_TEXT, container);\n                currentContainer.get(stateParams.containerId);\n                alert.success('success.edit');\n                state.go('containerEdit', {containerId: stateParams.containerId});\n            },\n            () => {\n                alert.error('error.invalid');\n            }\n        );\n    }\n\n    displayInvalidFormMessage () {\n        this.validateContainer = true;\n        alert.error('error.invalid');\n    }\n\n    refreshBreadcrumb (breadcrumbText, container) {\n        let pageInfo = this.pageInfo;\n\n        this.translate([breadcrumbText])\n            .then((translations) => {\n                pageInfo\n                    .clear()\n                    .add(container.name, 'tags', {\n                        containerId: container.id\n                    })\n                    .add(translations[breadcrumbText])\n                    .broadcast();\n            });\n    }\n}\n\nexport default EditController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet stateParams;\n\nconst PAGE_TITLE = 'Container created successfully';\n\n/**\n * @name ExplanationController\n */\nclass ExplanationController {\n    constructor (\n        containerResource,\n        $stateParams,\n        PageInfo,\n        CurrentContainer,\n        $translate\n    ) {\n        stateParams = $stateParams;\n        this.translate = $translate;\n\n        CurrentContainer.makeChanges();\n\n        this\n            .translate([PAGE_TITLE])\n            .then((translations) => {\n                PageInfo.clear()\n                    .add(translations[PAGE_TITLE])\n                    .broadcast();\n            });\n\n        this.container = containerResource.getEntityObject();\n        this.containerPromise = containerResource.get(stateParams.containerId);\n\n        this.containerPromise.then((resp) => {\n            this.container = resp;\n        });\n    }\n}\n\nexport default ExplanationController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nconst DEBOUNCE_TIMEOUT = 500;\n\nlet $alert, $timeout;\n\n/**\n * @name ManageController\n */\nclass ManageController {\n    constructor (\n        TableParams,\n        scope,\n        timeout,\n        containerResource,\n        publishedStatus,\n        alert,\n        paramConverter,\n        currentContainer\n    ) {\n        $alert = alert;\n        $timeout = timeout;\n        this.publishedStatus = publishedStatus;\n        currentContainer.disableDebugMode();\n        this.currentFilterQuery = '';\n        this.filterQuery = '';\n\n        this.tableParams = new TableParams({\n            page: 1,\n            count: 10,\n            sorting: {\n                name: 'asc'\n            }\n        }, {\n            total: 0,\n            getData: ($defer, params) => {\n                let queryParam = paramConverter.list(params.url());\n                if (this.useSearchByName()) {\n                    queryParam.name = this.currentFilterQuery;\n                }\n\n                containerResource.query(queryParam).then((resp) => {\n                    params.total(resp.total);\n                    $defer.resolve(resp.data);\n                    this.filterQuery = this.currentFilterQuery;\n                });\n            }\n        });\n\n        scope.$on('$destroy', () => {\n            $timeout.cancel(this.debounce);\n        });\n    }\n\n    removeContainer (container) {\n        container.remove().then(\n            () => {\n                $alert.success('success.remove');\n                if (this.tableParams.data.length === 1) {\n                    this.tableParams.page(this.tableParams.page() - 1);\n                }\n                this.tableParams.reload();\n            },\n            () => {\n                $alert.error('error.remove');\n                this.tableParams.reload();\n            }\n        );\n    }\n\n    getPublishedStatus (container) {\n        return this.publishedStatus.getPublishedStatusForContainer(container);\n    }\n\n    search () {\n        this.tableParams.page(1);\n        this.tableParams.reload();\n    }\n\n    searchDebounced () {\n        $timeout.cancel(this.debounce);\n\n        let searchCallback = () => {\n            this.search();\n        };\n\n        if (this.currentFilterQuery !== this.filterQuery) {\n            this.debounce = $timeout(searchCallback, DEBOUNCE_TIMEOUT);\n        }\n    }\n\n    resetSearchQuery () {\n        this.currentFilterQuery = '';\n        this.search();\n    }\n\n    showSearchLoader () {\n        return this.currentFilterQuery !== this.filterQuery;\n    }\n\n    useSearchByName () {\n        return this.currentFilterQuery !== undefined && this.currentFilterQuery.length > 0;\n    }\n}\n\nexport default ManageController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet permissionsResource;\nlet currentContainer;\nlet alert;\n\n/**\n * @name PermissionsController\n */\nclass PermissionsController {\n    constructor (TableParams, paramConverter, $currentContainer, $alert, $permissionsResource) {\n        this.permissionsPromise = undefined;\n        permissionsResource = $permissionsResource;\n        currentContainer = $currentContainer;\n        alert = $alert;\n\n        this.usersTable = new TableParams({\n            page: 1,\n            count: 10,\n            sorting: {\n                name: 'asc'\n            }\n        }, {\n            total: 0,\n            getData: ($defer, params) => {\n                permissionsResource.query(currentContainer.$container.id, paramConverter.list(params.url())).then(\n                    (resp) => {\n                        params.total(resp.total);\n                        $defer.resolve(resp.data);\n                    }\n                );\n            }\n        });\n    }\n\n    setPermission (permission, value) {\n        var tempRequest = angular.copy(permission);\n        tempRequest.permissions = value;\n        this.permissionsPromise = tempRequest.save(currentContainer.$container.id);\n\n        this.permissionsPromise.then(\n            (resp) => {\n                permission.permissions = resp.permissions;\n            },\n            () => {\n                alert.error('permissions.error');\n            }\n        );\n    }\n\n    isValid (permission, value) {\n        if (permission.permissions === value || permission.user.roles.indexOf('ROLE_SUPER_ADMIN') !== -1) {\n            return false;\n        }\n\n        return true;\n    }\n}\n\nexport default PermissionsController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name PrivacyController\n */\nexport default class PrivacyController {\n    constructor (stateParams, containerResource) {\n        this.privacyPromise = containerResource.getPrivacyOptOut(stateParams.containerId)\n            .then((resp) => {\n                this.code = resp.code;\n            });\n    }\n}\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar containerFactory = (resource) => {\n    /**\n     * @name Container\n     * @description Container entity\n     */\n    class Container {\n        constructor () {\n            this.id;\n            this.name;\n            this.code;\n            this.codeSynchronous;\n            this.version;\n            this.hasUnpublishedChanges;\n            this.publishedAt;\n            this.permissions;\n            this.delay;\n            this.websites;\n        }\n\n        /**\n         * @returns {deferred.promise}\n         */\n        save () {\n            var result = {}, promise;\n            var excludedProperty = ['id', 'code', 'codeSynchronous', 'version', 'hasUnpublishedChanges', 'publishedAt', 'permissions', 'websites'];\n\n            for (var property in this) {\n                if (\n                    !angular.isFunction(this[property]) &&\n                    this.hasOwnProperty(property) &&\n                    excludedProperty.indexOf(property) === -1\n                ) {\n                    result[property] = this[property];\n                }\n            }\n\n            if (this.id === undefined) {\n                delete result.delay;\n                promise = resource.post(result);\n            } else {\n                promise = resource.put(this.id, result);\n            }\n\n            return promise;\n        }\n\n        /**\n         * @returns {deferred.promise|Boolean}\n         */\n        remove () {\n            if (this.id === undefined) {\n                return false;\n            }\n\n            return resource.delete(this.id);\n        }\n\n        hasPermission (permission) {\n            return this.permissions.indexOf(permission) !== -1;\n        }\n\n        /**\n         * Get permission\n         */\n        getPermission () {\n            let permissionsPrioritiedArray = [{\n                value: 'operator',\n                text: 'Owner'\n            }, {\n                value: 'publish',\n                text: 'Publish'\n            }, {\n                value: 'edit',\n                text: 'Edit'\n            }, {\n                value: 'view',\n                text: 'View'\n            }];\n\n            for (let permissionIndex in permissionsPrioritiedArray) {\n                if (this.permissions.indexOf(permissionsPrioritiedArray[permissionIndex].value) !== -1) {\n                    return permissionsPrioritiedArray[permissionIndex].text;\n                }\n            }\n        }\n    }\n\n    return Container;\n};\n\nexport default containerFactory;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar permissionFactory = (resource) => {\n    /**\n     * @name Permission\n     * @description Permission entity\n     */\n    class Permission {\n        constructor () {\n            this.user;\n            this.permissions;\n        }\n\n        save (containerId) {\n            let result,\n                promise;\n            result = angular.copy(this);\n            result.user = result.user.id;\n            promise = resource.put(containerId, result);\n\n            return promise;\n        }\n    }\n\n    return Permission;\n};\n\nexport default permissionFactory;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport containerFactory from '../entity/Container.js';\n\nlet transformResponse = function (resp) {\n    let Container = containerFactory(this);\n\n    let container = new Container();\n\n    if (resp !== undefined) {\n        container.id = resp.id;\n        container.name = resp.name;\n        container.description = resp.description;\n        container.code = resp.code;\n        container.codeSynchronous = resp.code_synchronous;\n        container.version = resp.version;\n        container.hasUnpublishedChanges = resp.has_unpublished_changes;\n        container.publishedAt = resp.published_at;\n        container.permissions = resp.permissions;\n        container.delay = resp.delay;\n        container.websites = [];\n\n        for (let i = 0; i < resp.websites.length; i++) {\n            let website = this.WebsiteResource.getEntityObject();\n\n            website.url = resp.websites[i].url;\n            website.parameterType = resp.websites[i].parameter_type;\n\n            container.websites.push(website);\n        }\n    }\n\n    return container;\n};\n\nlet appendTransform = function (defaults, transform) {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name ContainerResource\n */\nclass ContainerResource {\n    constructor ($http, $q, WebsiteResource) {\n        this.http = $http;\n        this.q = $q;\n        this.WebsiteResource = WebsiteResource;\n    }\n\n    getEntityObject () {\n        let Container = containerFactory(this);\n\n        return new Container();\n    }\n\n    get (id) {\n        let deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: `/api/containers/${id}`,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp) => {\n                return transformResponse.call(this, resp.data);\n            })\n        })\n            .success((data) => {\n                deferred.resolve(data);\n            })\n            .error(() => {\n                deferred.reject();\n            });\n\n        return deferred.promise;\n    }\n\n    query (params) {\n        let deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: '/api/containers',\n            params: params,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp) => {\n                for (let element in resp.data) {\n                    if (resp.data[element] instanceof Object) {\n                        resp.data[element] = transformResponse.call(this, resp.data[element]);\n                    }\n                }\n\n                return resp;\n            })\n        })\n            .success((data) => {\n                deferred.resolve(data);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    delete (id) {\n        let deferred = this.q.defer();\n\n        this.http({\n            method: 'DELETE',\n            url: `/api/containers/${id}`\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    post (entity) {\n        let deferred = this.q.defer();\n\n        this.http({\n            method: 'POST',\n            url: '/api/containers',\n            data: entity,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp) => {\n                return transformResponse.call(this, resp.data);\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    put (id, entity) {\n        let deferred = this.q.defer();\n\n        this.http({\n            method: 'PUT',\n            url: `/api/containers/${id}`,\n            data: entity,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp) => {\n                return transformResponse.call(this, resp.data);\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    publishVersion (id) {\n        let deferred = this.q.defer();\n\n        this.http({\n            method: 'POST',\n            url: `/api/containers/${id}/version-publish`\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    restoreVersion (id) {\n        let deferred = this.q.defer();\n\n        this.http({\n            method: 'POST',\n            url: `/api/containers/${id}/version-restore`\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    getPrivacyOptOut (id) {\n        let deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: `containers/${id}/privacy`\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n}\n\nexport default ContainerResource;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport permissionFactory from '../entity/Permission.js';\n\nvar transformResponse = function (resp) {\n    let permissionList = ['operator', 'publish', 'edit', 'view', 'noaccess'];\n\n    let Permission = permissionFactory(this);\n\n    let permission = new Permission();\n\n    permission.user = resp.user;\n\n    if (resp.permissions instanceof Object) {\n        for (let permissionIndex in permissionList) {\n            if (resp.permissions.indexOf(permissionList[permissionIndex]) !== -1) {\n                permission.permissions = permissionList[permissionIndex];\n                break;\n            }\n        }\n    } else {\n        permission.permissions = resp.permissions;\n    }\n\n    return permission;\n};\n\nlet appendTransform = function (defaults, transform) {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name PermissionResource\n */\nclass PermissionResource {\n    constructor ($http, $q) {\n        this.http = $http;\n        this.q = $q;\n    }\n\n    getEntityObject () {\n        var Permission = permissionFactory(this);\n\n        return new Permission();\n    }\n\n    query (id, params) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: `/api/containers/${id}/permissions`,\n            params: params,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp) => {\n                for (var element in resp.data) {\n                    if (resp.data[element] instanceof Object) {\n                        resp.data[element] = transformResponse.call(this, resp.data[element]);\n                    }\n                }\n\n                return resp;\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    put (id, entity) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'PUT',\n            data: entity,\n            url: `api/containers/${id}/permissions`,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (status < 400) {\n                    return transformResponse.call(this, resp.data);\n                }\n\n                return resp;\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n}\n\nexport default PermissionResource;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet stateParams;\nlet $containerResource;\nlet alert;\nlet state;\nlet rootScope;\nlet cookies;\nlet conditionResource;\n\nconst PREVIEW_KEY = 'preview';\nconst DEBUG_KEY = 'debug';\n\n\n/**\n * Convert params for request\n *\n * @name CurrentContainer\n */\nclass CurrentContainer {\n    constructor (\n        $stateParams,\n        containerResource,\n        $alert,\n        $state,\n        $rootScope,\n        $cookies,\n        $conditionResource,\n        $translate\n    ) {\n        stateParams = $stateParams;\n        $containerResource = containerResource;\n        alert = $alert;\n        state = $state;\n        rootScope = $rootScope;\n        this.$container = undefined;\n        cookies = $cookies;\n\n        this.types = undefined;\n        this.debugMode = false;\n        this.previewedContainer = undefined;\n        this.translate = $translate;\n        conditionResource = $conditionResource;\n    }\n\n    get (containerId) {\n        containerId = this.getId(containerId);\n        rootScope.currentContainerLoading = true;\n\n        this.containerPromise = $containerResource.get(containerId).then(\n            (resp) => {\n                this.$container = resp;\n                rootScope.currentContainerLoading = false;\n                this.verifyDebugMode();\n\n                if (this.types === undefined) {\n                    this.types = this.setTypes();\n                }\n\n                return this.$container;\n            }\n        );\n\n        return this.containerPromise;\n    }\n\n    getId (containerId) {\n        return containerId !== undefined ? containerId : stateParams.containerId;\n    }\n\n    getContainer () {\n        let response;\n\n        if (this.containerPromise === undefined) {\n            response = this.get();\n        } else {\n            response = this.containerPromise;\n        }\n\n        return response;\n    }\n\n    publish () {\n        let publishPromise = $containerResource.publishVersion(this.getId());\n\n        rootScope.currentContainerLoading = true;\n\n        return publishPromise.then(\n            () => {\n                alert.success('success.publish');\n                rootScope.currentContainerLoading = false;\n                this.get().then(() => {\n                    rootScope.$broadcast('container-published', this);\n                });\n            },\n            () => {\n                alert.error('container.error');\n                rootScope.currentContainerLoading = false;\n            }\n        );\n    }\n\n    canRestore () {\n        if (!this.$container) {\n            return false;\n        }\n\n        return this.$container.publishedAt && this.$container.hasUnpublishedChanges;\n    }\n\n    isDirty () {\n        return this.$container && this.$container.hasUnpublishedChanges;\n    }\n\n    isPublished () {\n        if (!this.$container) {\n            return false;\n        }\n\n        return this.$container.publishedAt && !this.$container.hasUnpublishedChanges;\n    }\n\n    makeChanges () {\n        if (!this.$container) {\n            return false;\n        }\n\n        return this.$container.hasUnpublishedChanges = true;\n    }\n\n    /**\n     * Dischard draft changes to latest published version\n     */\n    restore () {\n        var restorePromise = $containerResource.restoreVersion(this.getId());\n        rootScope.currentContainerLoading = true;\n\n        restorePromise.then(\n            () => {\n                alert.success('success.restore');\n                this.get();\n\n                let isTagView = state.includes('tags') || state.includes('tagEdit') || state.includes('tagCreate'),\n                    isTriggerView = state.includes('triggers') || state.includes('triggerCreate') || state.includes('triggerEdit');\n                if (isTagView) {\n                    state.go('tags', {containerId: this.getId()}, {reload: true});\n                } else if (isTriggerView) {\n                    state.go('triggers', {containerId: this.getId()}, {reload: true});\n                } else {\n                    state.go('containerEdit', {containerId: this.getId()}, {reload: true});\n                }\n\n                rootScope.currentContainerLoading = false;\n            },\n            () => {\n                alert.error('container.error');\n            }\n        );\n    }\n\n    verifyDebugMode () {\n        if (this.isDebugModeEnabled()) {\n            let cookiesDebug = cookies.get(DEBUG_KEY);\n            if (cookiesDebug === this.$container.id) {\n                this.debugMode = true;\n                this.previewedContainer = this.$container;\n\n                this\n                    .translate(['Now Previewing'])\n                    .then((translations) => {\n                        this.previewedContainerText = translations['Now Previewing'];\n                    });\n            } else {\n                this.disableDebugMode();\n            }\n        }\n    }\n\n    isDebugModeEnabled () {\n        let cookiesDebug = cookies.get(DEBUG_KEY);\n        let cookiesPreview = cookies.get(PREVIEW_KEY);\n\n        return cookiesDebug !== undefined && cookiesPreview !== undefined && cookiesDebug === cookiesPreview;\n    }\n\n    enableDebugMode () {\n        this.debugMode = true;\n        this.previewedContainer = this.$container;\n\n        this\n            .translate(['Now Previewing'])\n            .then((translations) => {\n                this.previewedContainerText = translations['Now Previewing'];\n            });\n\n        cookies.put(PREVIEW_KEY, this.$container.id);\n        cookies.put(DEBUG_KEY, this.$container.id);\n    }\n\n    disableDebugMode () {\n        this.debugMode = false;\n        this.previewedContainer = undefined;\n\n        cookies.remove(PREVIEW_KEY);\n        cookies.remove(DEBUG_KEY);\n    }\n\n    setTypes () {\n        return conditionResource.query(this.getId()).then(\n            (resp) => {\n                let respIndex = resp.length,\n                    mapped = [];\n\n                while (respIndex--) {\n                    mapped[respIndex] = {\n                        name: resp[respIndex].name,\n                        type: resp[respIndex].type\n                    };\n                }\n\n                return mapped;\n            }\n        );\n    }\n\n    hasPermission (permission) {\n        return this.getContainer().then((container) => container.hasPermission(permission));\n    }\n}\n\nexport default CurrentContainer;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * Convert params for request\n *\n * @name ParamConverter\n */\nclass ParamConverter {\n    list (params) {\n        return {\n            limit: params.count,\n            offset: (params.page - 1) * params.count\n        };\n    }\n}\n\nexport default ParamConverter;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nconst STATE_DRAFT = 0,\n    STATE_NEVER_PUBLISHED = 1,\n    STATE_PUBLISHED = 2,\n    STATE_WAITING_FOR_CONTAINER_DATA = 3;\nconst PUBLISHED_STATE = [\n    {\n        name: 'Draft',\n        class: 'stg-status-badge-draft'\n    },\n    {\n        name: 'Draft - never published',\n        class: 'stg-status-badge-never-published'\n    },\n    {\n        name: 'Published',\n        class: 'stg-status-badge-published'\n    },\n    {\n        name: '',\n        class: ''\n    }\n];\n\nlet currentContainer;\n\n/**\n * @name PublishedStatus\n */\nclass PublishedStatus {\n    constructor ($currentContainer) {\n        currentContainer = $currentContainer;\n    }\n\n    getPublishedStatusForContainer (container) {\n        return getPublishedState(container, container.hasUnpublishedChanges);\n    }\n\n    getPublishedStatusForTag (tag) {\n        let $container = currentContainer.$container;\n        if (!$container) {\n            return PUBLISHED_STATE[STATE_WAITING_FOR_CONTAINER_DATA];\n        }\n\n        let dateTagChanged = new Date(tag.updatedAt),\n            dateTagCreated = new Date(tag.createdAt),\n            dateContainerPublished = new Date($container.publishedAt),\n            tagIsDirty = dateTagChanged > dateContainerPublished,\n            tagCreatedAfterLastPublish = dateTagCreated > dateContainerPublished;\n        return getPublishedState($container, tagIsDirty, tagCreatedAfterLastPublish);\n    }\n}\n\nfunction getPublishedState (container, hasUnpublishedChanges, wasNeverPublished) {\n    if (!containerHasBeenPublished(container) || wasNeverPublished) {\n        return PUBLISHED_STATE[STATE_NEVER_PUBLISHED];\n    } else if (hasUnpublishedChanges) {\n        return PUBLISHED_STATE[STATE_DRAFT];\n    } else {\n        return PUBLISHED_STATE[STATE_PUBLISHED];\n    }\n}\n\nfunction containerHasBeenPublished (container) {\n    return !!container.publishedAt;\n}\n\nexport default PublishedStatus;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport ManageController from './controllers/ManageController.js';\nimport CreateController from './controllers/CreateController.js';\nimport EditController from './controllers/EditController.js';\nimport ExplanationController from './controllers/ExplanationController.js';\nimport PermissionsController from './controllers/PermissionsController.js';\nimport PrivacyController from './controllers/PrivacyController.js';\n\nimport ContainerResource from './resource/ContainerResource.js';\nimport PermissionResource from './resource/PermissionResource.js';\nimport ParamConverter from './service/ParamConverter.js';\nimport CurrentContainer from './service/CurrentContainer.js';\nimport PublishedStatus from './service/PublishedStatus.js';\n\nconst MODULE_NAME = 'clearcode.tm.tagContainer';\nconst DEBUG_MODULE_NAME = 'clearcode.tm.debug';\nconst MODULE_DIR = 'app/modules/tagContainer';\n\nContainerResource.$inject = [\n    '$http',\n    '$q',\n    `${DEBUG_MODULE_NAME}.websiteResource`\n];\n\nPermissionResource.$inject = [\n    '$http',\n    '$q'\n];\n\nCurrentContainer.$inject = [\n    '$stateParams',\n    `${MODULE_NAME}.containerResource`,\n    'clearcode.tm.alert.alert',\n    '$state',\n    '$rootScope',\n    '$cookieStore',\n    'clearcode.tm.condition.conditionResource',\n    '$translate'\n];\n\nPublishedStatus.$inject = [\n    `${MODULE_NAME}.currentContainer`\n];\n\nManageController.$inject = [\n    'ngTableParams',\n    '$scope',\n    '$timeout',\n    `${MODULE_NAME}.containerResource`,\n    `${MODULE_NAME}.publishedStatus`,\n    'clearcode.tm.alert.alert',\n    `${MODULE_NAME}.paramConverter`,\n    `${MODULE_NAME}.currentContainer`\n];\n\nCreateController.$inject = [\n    `${MODULE_NAME}.containerResource`,\n    '$state',\n    'clearcode.tm.alert.alert',\n    'clearcode.tm.pageInfo.pageInfo',\n    '$translate'\n];\n\nEditController.$inject = [\n    `${MODULE_NAME}.containerResource`,\n    '$state',\n    '$stateParams',\n    'clearcode.tm.alert.alert',\n    'clearcode.tm.tagContainer.currentContainer',\n    'clearcode.tm.pageInfo.pageInfo',\n    '$scope',\n    '$translate'\n];\n\nExplanationController.$inject = [\n    `${MODULE_NAME}.containerResource`,\n    '$stateParams',\n    'clearcode.tm.pageInfo.pageInfo',\n    'clearcode.tm.tagContainer.currentContainer',\n    '$translate'\n];\n\nPermissionsController.$inject = [\n    'ngTableParams',\n    `${MODULE_NAME}.paramConverter`,\n    `${MODULE_NAME}.currentContainer`,\n    'clearcode.tm.alert.alert',\n    `${MODULE_NAME}.permissionResource`\n];\n\nPrivacyController.$inject = [\n    '$stateParams',\n    `${MODULE_NAME}.containerResource`\n];\n\nangular\n    .module(MODULE_NAME, [\n        'pascalprecht.translate',\n        'ui.router',\n        'ngTable',\n        'ngCookies',\n        'clearcode.tm.condition',\n        'clearcode.tm.alert',\n        'clearcode.tm.pageInfo',\n        'clearcode.tm.user',\n        DEBUG_MODULE_NAME\n    ])\n    .run([\n\n        '$rootScope',\n        `${MODULE_NAME}.currentContainer`,\n        '$stateParams',\n        'clearcode.tm.alert.$alert',\n\n        ($rootScope, currentContainer, $stateParams, $alertProvider) => {\n            $rootScope.currentContainerLoading = true;\n            $rootScope.currentContainer = currentContainer;\n\n            var loadContainer = (containerId) => {\n                if (containerId !== $stateParams.containerId) {\n                    let currentContainerPromise = currentContainer.get(containerId);\n\n                    currentContainerPromise.then((container) => {\n                        $rootScope.$broadcast('pageInfo.reload', container);\n                    });\n                }\n            };\n\n            $rootScope.$on('$stateChangeStart', (event, toState, toParams) => {\n                loadContainer(toParams.containerId);\n            });\n\n            $alertProvider.addMessagePattern(\n                'success.restore',\n                'Well done! Action completed successfully.'\n            );\n\n            $alertProvider.addMessagePattern(\n                'container.create',\n                'Container has been created successfully.'\n            );\n\n            $alertProvider.addMessagePattern(\n                'container.error',\n                'Sorry, something went wrong.'\n            );\n\n            $alertProvider.addMessagePattern(\n                'success.publish',\n                'Container has been published! Changes are now live!'\n            );\n\n            $alertProvider.addMessagePattern(\n                'permissions.error',\n                'Permissions can not be changed.'\n            );\n        }\n    ])\n    .config([\n        '$stateProvider',\n\n        ($stateProvider) => {\n            $stateProvider\n                .state('container', {\n                    url: '/containers',\n                    controller: `${MODULE_NAME}.ManageController as view`,\n                    templateUrl: `${MODULE_DIR}/views/manage.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: false,\n                        permission: [\n                            'view'\n                        ]\n                    }\n                })\n                .state('containerCreate', {\n                    url: '/containers-create',\n                    controller: `${MODULE_NAME}.CreateController as view`,\n                    templateUrl: `${MODULE_DIR}/views/create.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: false,\n                        permission: [\n                            'edit'\n                        ]\n                    }\n                })\n                .state('containerExplanation', {\n                    url: '/containers-explanation/{containerId}',\n                    controller: `${MODULE_NAME}.ExplanationController as view`,\n                    templateUrl: `${MODULE_DIR}/views/explanation.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: true,\n                        permission: [\n                            'owner'\n                        ]\n                    }\n                })\n                .state('containerEdit', {\n                    url: '/containers-edit/{containerId}',\n                    controller: `${MODULE_NAME}.EditController as view`,\n                    templateUrl: `${MODULE_DIR}/views/options.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: true,\n                        permission: [\n                            'edit'\n                        ]\n                    }\n                });\n        }\n    ])\n    .controller(`${MODULE_NAME}.ManageController`, ManageController)\n    .controller(`${MODULE_NAME}.CreateController`, CreateController)\n    .controller(`${MODULE_NAME}.EditController`, EditController)\n    .controller(`${MODULE_NAME}.ExplanationController`, ExplanationController)\n    .controller(`${MODULE_NAME}.PermissionsController`, PermissionsController)\n    .controller(`${MODULE_NAME}.PrivacyController`, PrivacyController)\n    .service(`${MODULE_NAME}.containerResource`, ContainerResource)\n    .service(`${MODULE_NAME}.permissionResource`, PermissionResource)\n    .service(`${MODULE_NAME}.paramConverter`, ParamConverter)\n    .service(`${MODULE_NAME}.currentContainer`, CurrentContainer)\n    .service(`${MODULE_NAME}.publishedStatus`, PublishedStatus);\n\nmodule.exports = {MODULE_NAME};\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nconst PAGE_VIEW_TYPES = [{\n        value: 0,\n        name: 'Page view'\n    }, {\n        value: 1,\n        name: 'DOM ready'\n    }, {\n        value: 2,\n        name: 'Page load'\n    }],\n    NOT_VISIBLE_TRIGGER_TYPES = ['Page Load', 'DOM Ready'];\n\n\n/**\n * @name BaseController\n */\nclass BaseController {\n    constructor (\n        $scope,\n        $triggerResource,\n        $conditionResource,\n        $stateParams,\n        $state,\n        $alert,\n        CurrentContainer,\n        $condition,\n        $PageInfo,\n        $translate\n    ) {\n        const BREADCRUMB_GLOBAL = 'Triggers';\n\n        this.required = undefined;\n        this.variables = undefined;\n        this.actions = undefined;\n\n        this.triggerPromise = undefined;\n\n        this.triggerResource = $triggerResource;\n        this.conditionResource = $conditionResource;\n\n        this.scope = $scope;\n        this.stateParams = $stateParams;\n        this.state = $state;\n        this.alert = $alert;\n        this.currentContainer = CurrentContainer;\n        this.Condition = $condition;\n        this.PageInfo = $PageInfo;\n\n        this.typesArrayPromise = $condition.getArrayOfTypes().then(filterVisibleTriggerTypes);\n\n        this.trigger = $triggerResource.getEntityObject();\n        this.condition = $conditionResource.getEntityObject();\n        this.translate = $translate;\n\n        $scope.$on('pageInfo.reload', (event, args) => {\n            this\n                .translate([this.getBreadcrumbText(), BREADCRUMB_GLOBAL])\n                .then((translations) => {\n                    $PageInfo.clear()\n                        .add(args.name, 'tags', {\n                            containerId: args.id\n                        })\n                        .add(translations[BREADCRUMB_GLOBAL], 'triggers', {\n                            containerId: args.id\n                        })\n                        .add(translations[this.getBreadcrumbText()])\n                        .broadcast();\n                });\n        });\n\n        this.pageViewTriggerTypes = PAGE_VIEW_TYPES;\n\n        function filterVisibleTriggerTypes (types) {\n            return types.filter(type => NOT_VISIBLE_TRIGGER_TYPES.indexOf(type) === -1);\n        }\n    }\n\n    setType (type) {\n        if (this.typesArray[type] !== undefined) {\n            this.trigger.type = type;\n            this.trigger.conditions = [];\n\n            this.Condition.getVariables(type).then(resp => {\n                this.variables = resp;\n            });\n            this.Condition.getActions(type).then(resp => {\n                this.actions = resp;\n            });\n            this.Condition.getRequired(type).then(\n                resp => {\n                    this.required = resp;\n                    let requiredIndex = this.required.length;\n\n                    while (requiredIndex--) {\n                        this.trigger.conditions.push({\n                            variable: this.required[requiredIndex].name,\n                            condition: this.actions[0].type,\n                            value: ''\n                        });\n                    }\n                }\n            );\n        } else {\n            throw new Error('Invalid type');\n        }\n    }\n\n    addCondition () {\n        this.condition = this.conditionResource.getEntityObject();\n\n        this.condition.variable = this.variables[0].name;\n        this.condition.condition = this.actions[0].type;\n\n        this.trigger.addCondition(this.condition);\n    }\n\n    validateTrigger (form) {\n        this.scope[form.$name].$setPristine();\n\n        let conditionLength = this.trigger.conditions.length;\n\n        if (this.scope[form.$name].name.$valid) {\n            if (conditionLength !== 0) {\n                while (conditionLength--) {\n                    /* eslint-disable */\n                    if (this.scope[form.$name]['conditionValue[' + conditionLength + ']'].$invalid) {\n                        return false;\n                    }\n                    /* eslint-enable */\n                }\n            }\n\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    isTypeRequired (variable) {\n        return this.required !== undefined && this.required.map(element => element.name).indexOf(variable) !== -1;\n    }\n\n    getVariableName (variable) {\n        var variablesIndex = this.variables.map(element => element.name).indexOf(variable);\n\n        if (variablesIndex === -1) {\n            variablesIndex = this.required.map(element => element.name).indexOf(variable);\n\n            return variablesIndex !== -1 ? this.required[variablesIndex].name : false;\n        }\n\n        return this.variables[variablesIndex].name;\n    }\n\n    getConditionName (conditionName) {\n        var conditionsIndex = this.actions.map(element => element.name).indexOf(conditionName);\n\n        return conditionsIndex !== -1 ? this.actions[conditionsIndex].name : false;\n    }\n\n    leaveFormInsideTag () {\n        this\n            .translate([this.getBreadcrumbText()])\n            .then((translations) => {\n                this.PageInfo.clear()\n                    .add(this.currentContainer.$container.name, 'tags', {\n                        containerId: this.currentContainer.$container.id\n                    })\n                    .add(translations[this.getBreadcrumbText()])\n                    .broadcast();\n            });\n\n        return false;\n    }\n\n    showFormForSynchronousTrigger () {\n        let isEmbededInsideSynchronousTagForm = this.scope.tagTemplateTab === 'sync';\n        return this.trigger.isAddedToSynchronousTag || isEmbededInsideSynchronousTagForm;\n    }\n\n    submitForm (trigger) {\n        this.triggerPromise = trigger.save(this.stateParams.containerId);\n\n        this.triggerPromise.then(\n            () => {\n                this.currentContainer.makeChanges();\n                this.alert.success(this.getAlertType());\n\n                this.state.go('triggers', {\n                    containerId: this.stateParams.containerId\n                });\n            },\n            () => {\n                this.alert.error('error.invalid');\n            }\n        );\n    }\n\n    displayInvalidFormMessage (view) {\n        view.validateTriggers = true;\n        this.alert.error('error.invalid');\n    }\n}\n\nexport default BaseController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport BaseController from './BaseController.js';\n\nconst BREADCRUMB_GLOBAL = 'Triggers';\n\n/**\n * @name CreateController\n */\nclass CreateController extends BaseController {\n    constructor (\n        $scope,\n        $triggerResource,\n        $conditionResource,\n        $stateParams,\n        $state,\n        $alert,\n        CurrentContainer,\n        $condition,\n        PageInfo,\n        $translate\n    ) {\n        super(\n            $scope,\n            $triggerResource,\n            $conditionResource,\n            $stateParams,\n            $state,\n            $alert,\n            CurrentContainer,\n            $condition,\n            PageInfo,\n            $translate\n        );\n\n        this.typesArrayPromise.then(resp => {\n            this.typesArray = resp;\n            this.setType(0);\n        });\n\n        CurrentContainer.getContainer().then( () => {\n            if (!CurrentContainer.$container.hasPermission('edit')) {\n                $state.go('triggers', {containerId: $stateParams.containerId});\n            }\n\n            this\n                .translate([this.getBreadcrumbText(), BREADCRUMB_GLOBAL])\n                .then((translations) => {\n                    PageInfo.clear()\n                        .add(CurrentContainer.$container.name, 'tags', {\n                            containerId: CurrentContainer.$container.id\n                        })\n                        .add(translations[BREADCRUMB_GLOBAL], 'triggers', {\n                            containerId: CurrentContainer.$container.id\n                        })\n                        .add(translations[this.getBreadcrumbText()])\n                        .broadcast();\n                });\n        });\n    }\n\n    getBreadcrumbText () {\n        return 'Add a new trigger';\n    }\n\n    getAlertType () {\n        return 'success.create';\n    }\n\n    addTrigger (form, trigger) {\n        this.triggerPromise = trigger.save(this.stateParams.containerId);\n\n        this.triggerPromise.then(\n            resp => {\n                this.scope[form.$name].$setPristine();\n                this.trigger = this.triggerResource.getEntityObject();\n                this.scope.$emit('trigger.add', resp);\n            },\n            () => {\n            }\n        );\n    }\n}\n\nexport default CreateController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport BaseController from './BaseController.js';\n\nconst BREADCRUMB_GLOBAL = 'Triggers';\n\n/**\n * @name EditController\n */\nclass EditController extends BaseController {\n    constructor (\n        $scope,\n        $triggerResource,\n        $conditionResource,\n        $stateParams,\n        $state,\n        $alert,\n        CurrentContainer,\n        $condition,\n        PageInfo,\n        $translate\n    ) {\n        super(\n            $scope,\n            $triggerResource,\n            $conditionResource,\n            $stateParams,\n            $state,\n            $alert,\n            CurrentContainer,\n            $condition,\n            PageInfo,\n            $translate\n        );\n\n        this.triggerPromise = $triggerResource.get($stateParams.triggerId);\n\n        this.triggerPromise.then(\n            (triggerResp) => {\n                this.trigger = triggerResp;\n\n                this.typesArrayPromise.then(typesResp => {\n                    this.typesArray = typesResp;\n\n                    this.Condition.getVariables(this.trigger.type).then(resp => {\n                        this.variables = resp;\n                    });\n                    this.Condition.getActions(this.trigger.type).then(resp => {\n                        this.actions = resp;\n                    });\n                    this.Condition.getRequired(this.trigger.type).then(resp => {\n                        this.required = resp;\n                    });\n                });\n            }\n        );\n\n        this.currentContainer.getContainer().then(() => {\n            if (this.currentContainer.$container.hasPermission('noaccess')) {\n                this.state.go('container');\n            }\n\n            this\n                .translate([this.getBreadcrumbText(), BREADCRUMB_GLOBAL])\n                .then((translations) => {\n                    PageInfo.clear()\n                        .add(this.currentContainer.$container.name, 'tags', {\n                            containerId: this.currentContainer.$container.id\n                        })\n                        .add(translations[BREADCRUMB_GLOBAL], 'triggers', {\n                            containerId: this.currentContainer.$container.id\n                        })\n                        .add(translations[this.getBreadcrumbText()])\n                        .broadcast();\n                });\n        });\n    }\n\n    getBreadcrumbText () {\n        return 'Configure trigger';\n    }\n\n    getAlertType () {\n        return 'success.edit';\n    }\n}\n\nexport default EditController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport BaseController from './BaseController.js';\n\n/**\n * @name EditController\n */\nclass EditController extends BaseController {\n    constructor (\n        $scope,\n        $triggerResource,\n        $conditionResource,\n        $stateParams,\n        $alert,\n        CurrentContainer,\n        $condition,\n        PageInfo,\n        $translate\n    ) {\n        super(\n            $scope,\n            $triggerResource,\n            $conditionResource,\n            $stateParams,\n            null,\n            $alert,\n            CurrentContainer,\n            $condition,\n            PageInfo,\n            $translate\n        );\n    }\n\n    /**\n     * @desc Init trigger\n     * @param {number} triggerId\n     */\n    initTrigger (triggerId) {\n        this.triggerPromise = this.triggerResource.get(triggerId);\n\n        this.triggerPromise.then(triggerResp => {\n            this.trigger = triggerResp;\n\n            this.typesArrayPromise.then(typesResp => {\n                this.typesArray = typesResp;\n                this.Condition.getVariables(this.trigger.type).then(resp => {\n                    this.variables = resp;\n                });\n\n                this.Condition.getActions(this.trigger.type).then(resp => {\n                    this.actions = resp;\n                });\n\n                this.Condition.getRequired(this.trigger.type).then(resp => {\n                    this.required = resp;\n                });\n            });\n        });\n    }\n\n    getBreadcrumbText () {\n        return 'Configure trigger';\n    }\n\n    getAlertType () {\n        return 'success.edit';\n    }\n\n    submitForm (trigger) {\n        this.triggerPromise = trigger.save(this.stateParams.containerId);\n\n        this.triggerPromise.then(\n            resp => {\n                this.currentContainer.makeChanges();\n                this.alert.success('trigger.edit');\n                this.scope.$emit('trigger.edit', resp);\n            },\n            () => {\n                this.alert.error('error.invalid');\n            }\n        );\n    }\n}\n\nexport default EditController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet alert,\n    triggerResource,\n    stateParams,\n    currentContainer,\n    scope,\n    condition;\n\nconst BREADCRUMB_TEXT = 'Triggers';\n\n/**\n * @name ManageController\n */\nclass ManageController {\n    constructor (\n        TableParams,\n        $stateParams,\n        $triggerResource,\n        $alert,\n        $paramConverter,\n        CurrentContainer,\n        PageInfo,\n        $scope,\n        $condition,\n        state,\n        $translate\n    ) {\n        alert = $alert;\n        stateParams = $stateParams;\n        triggerResource = $triggerResource;\n        currentContainer = CurrentContainer;\n        scope = $scope;\n        condition = $condition;\n\n        this.typesArrayPromise = condition.getArrayOfTypes();\n\n        this.typesArrayPromise.then(resp => {\n            this.typesArray = resp;\n        });\n\n        this.translate = $translate;\n        this.containerId = stateParams.containerId;\n        this.tableParams = new TableParams({\n            page: 1,\n            count: 10,\n            sorting: {\n                name: 'asc'\n            }\n        }, {\n            total: 0,\n            getData: ($defer, params) => {\n                triggerResource.query(stateParams.containerId, $paramConverter.list(params.url())).then(function (resp) {\n                    params.total(resp.total);\n                    $defer.resolve(resp.data);\n                });\n            }\n        });\n\n        currentContainer.getContainer().then(() => {\n            if (!currentContainer.$container.hasPermission('view')) {\n                state.go('container');\n            }\n\n            this\n                .translate([BREADCRUMB_TEXT])\n                .then((translations) => {\n                    PageInfo.clear()\n                        .add(currentContainer.$container.name, 'tags', {\n                            containerId: currentContainer.$container.id\n                        })\n                        .add(translations[BREADCRUMB_TEXT])\n                        .broadcast();\n                });\n        });\n\n        scope.$on('pageInfo.reload', (event, args) => {\n            this\n                .translate([BREADCRUMB_TEXT])\n                .then((translations) => {\n                    PageInfo.clear()\n                        .add(args.name, 'tags', {\n                            containerId: args.id\n                        })\n                        .add(translations[BREADCRUMB_TEXT])\n                        .broadcast();\n                });\n        });\n    }\n\n    removeTrigger (trigger) {\n        trigger.remove().then(\n            () => {\n                alert.success('success.remove');\n                currentContainer.makeChanges();\n\n                if (this.tableParams.data.length === 1 && this.tableParams.page() > 1) {\n                    this.tableParams.page(this.tableParams.page() - 1);\n                } else {\n                    this.tableParams.reload();\n                }\n            },\n            () => {\n                alert.error('error.remove');\n                this.tableParams.reload();\n            }\n        );\n    }\n}\n\nexport default ManageController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet triggerFactory = function (resource) {\n    /**\n     * @name Trigger\n     * @description Trigger entity\n     */\n    class Trigger {\n        constructor () {\n            /**\n             * @type {number}\n             */\n            this.id = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.name = undefined;\n\n            /**\n             * @type {Number}\n             */\n            this.type = 0;\n\n            /**\n             * @type {Number}\n             */\n            this.subtype = 0;\n\n            /**\n            * @type {Array}\n            */\n            this.conditions = [];\n\n            /**\n             * @type {number}\n             */\n            this.tagsCount = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.updatedAt = undefined;\n\n            /**\n             * @type {boolean}\n             */\n            this.isAddedToSynchronousTag = false;\n        }\n\n        addCondition (condition) {\n            this.conditions.push(condition);\n        }\n\n        removeCondition (index) {\n            this.conditions.splice(index, 1);\n        }\n\n        save (containerId) {\n            let result = {},\n                promise,\n                excludedProperty = ['id', 'updatedAt', 'createdAt', 'tagsCount', 'isAddedToSynchronousTag'];\n\n            for (let property in this) {\n                if (\n                    !angular.isFunction(this[property]) &&\n                    this.hasOwnProperty(property) &&\n                    excludedProperty.indexOf(property) === -1\n                ) {\n                    if (property === 'conditions') {\n                        let collection = [];\n\n                        for (let index in this[property]) {\n                            if (this[property][index] instanceof Object) {\n                                collection.push(\n                                    {\n                                        variable: this[property][index].variable,\n                                        condition: this[property][index].condition,\n                                        value: this[property][index].value\n                                    }\n                                );\n                            }\n                        }\n\n                        result[property] = collection;\n                    } else {\n                        result[property] = this[property];\n                    }\n                }\n            }\n\n            if (this.id === undefined) {\n                promise = resource.post(containerId, result);\n            } else {\n                promise = resource.put(this.id, result);\n            }\n\n            return promise;\n        }\n\n        remove () {\n            if (this.id === undefined) {\n                return false;\n            }\n\n            return resource.delete(this.id);\n        }\n    }\n\n    return Trigger;\n};\n\nexport default triggerFactory;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport triggerFactory from '../entity/Trigger.js';\n\nconst PAGE_VIEW_TRIGGER_TYPE = 0,\n    DOM_READY_TRIGGER_TYPE = 4,\n    PAGE_LOAD_TRIGGER_TYPE = 5,\n    DOM_READY_SUBTYPE = 1,\n    PAGE_LOAD_SUBTYPE = 2;\n\n\nvar transformResponse = function (resp) {\n    var Trigger = triggerFactory(this);\n\n    var trigger = new Trigger();\n\n    if (resp !== undefined) {\n        trigger.id = resp.id;\n        trigger.name = resp.name;\n        trigger.type = resp.type;\n        trigger.conditions = resp.conditions;\n        trigger.tagsCount = resp.tags_count;\n        trigger.updatedAt = resp.updated_at;\n        trigger.isAddedToSynchronousTag = resp.is_added_to_synchronous_tag;\n        addTriggerSubtypesInfo(trigger);\n    }\n\n    return trigger;\n};\n\nfunction addTriggerSubtypesInfo (trigger) {\n    if (trigger.type === DOM_READY_TRIGGER_TYPE) {\n        trigger.type = PAGE_VIEW_TRIGGER_TYPE;\n        trigger.subtype = DOM_READY_SUBTYPE;\n    }\n\n    if (trigger.type === PAGE_LOAD_TRIGGER_TYPE) {\n        trigger.type = PAGE_VIEW_TRIGGER_TYPE;\n        trigger.subtype = PAGE_LOAD_SUBTYPE;\n    }\n}\n\nvar transformRequest = function (request) {\n    var Trigger = triggerFactory(this),\n        trigger = new Trigger();\n\n    if (request !== undefined) {\n        trigger.id = request.id;\n        trigger.name = request.name;\n        trigger.type = request.type;\n        trigger.conditions = request.conditions;\n        trigger.tagsCount = request.tags_count;\n        trigger.updatedAt = request.updated_at;\n\n        delete trigger.isAddedToSynchronousTag;\n        removeTriggerSubtypesInfo(trigger, request);\n    }\n\n    return trigger;\n};\n\nfunction removeTriggerSubtypesInfo (trigger, request) {\n    if (request.type === PAGE_VIEW_TRIGGER_TYPE && request.subtype === DOM_READY_SUBTYPE) {\n        trigger.type = DOM_READY_TRIGGER_TYPE;\n    }\n\n    if (request.type === PAGE_VIEW_TRIGGER_TYPE && request.subtype === PAGE_LOAD_SUBTYPE) {\n        trigger.type = PAGE_LOAD_TRIGGER_TYPE;\n    }\n\n    delete trigger.subtype;\n}\n\n\nvar appendTransform = function (defaults, transform) {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name TriggerResource\n */\nclass TriggerResource {\n    constructor ($http, $q) {\n        this.http = $http;\n        this.q = $q;\n    }\n\n    getEntityObject () {\n        var Trigger = triggerFactory(this);\n\n        return new Trigger();\n    }\n\n    get (id) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: `/api/triggers/${id}`,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (status < 400) {\n                    return transformResponse.call(this, resp.data);\n                } else {\n                    return resp;\n                }\n            })\n        })\n        .success((resp) => {\n            deferred.resolve(resp);\n        })\n        .error((err) => {\n            deferred.reject(err);\n        });\n\n        return deferred.promise;\n    }\n\n    query (containerId, params) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: `/api/containers/${containerId}/triggers`,\n            params: params,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp) => {\n                for (var element in resp.data) {\n                    if (resp.data[element] instanceof Object) {\n                        resp.data[element] = transformResponse.call(this, resp.data[element]);\n                    }\n                }\n\n                return resp;\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    delete (id) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'DELETE',\n            url: `/api/triggers/${id}`\n        })\n            .success((data) => {\n                deferred.resolve(data);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    post (containerId, entity) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'POST',\n            url: `/api/containers/${containerId}/triggers`,\n            data: entity,\n            transformRequest: appendTransform(transformRequest, this.http.defaults.transformRequest),\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (status < 400) {\n                    return transformResponse.call(this, resp.data);\n                } else {\n                    return resp;\n                }\n            })\n        })\n            .success((data) => {\n                deferred.resolve(data);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    put (id, entity) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'PUT',\n            url: `/api/triggers/${id}`,\n            data: entity,\n            transformRequest: appendTransform(transformRequest, this.http.defaults.transformRequest),\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (status < 400) {\n                    return transformResponse.call(this, resp.data);\n                } else {\n                    return resp;\n                }\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n}\n\nexport default TriggerResource;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport CreateController from './controllers/CreateController.js';\nimport EditController from './controllers/EditController.js';\nimport ManageController from './controllers/ManageController.js';\nimport EditInsideTagController from './controllers/EditInsideTagController.js';\n\nimport TriggerResource from './resource/TriggerResource.js';\n\nconst MODULE_NAME = 'clearcode.tm.trigger';\nconst CONDITION_MODULE_NAME = 'clearcode.tm.condition';\nconst MODULE_DIR = '/app/modules/trigger';\n\nManageController.$inject = [\n    'ngTableParams',\n    '$stateParams',\n    `${MODULE_NAME}.triggerResource`,\n    'clearcode.tm.alert.alert',\n    'clearcode.tm.tagContainer.paramConverter',\n    'clearcode.tm.tagContainer.currentContainer',\n    'clearcode.tm.pageInfo.pageInfo',\n    '$scope',\n    'clearcode.tm.condition.condition',\n    '$state',\n    '$translate'\n];\n\nCreateController.$inject = [\n    '$scope',\n    `${MODULE_NAME}.triggerResource`,\n    `${CONDITION_MODULE_NAME}.conditionResource`,\n    '$stateParams',\n    '$state',\n    'clearcode.tm.alert.alert',\n    'clearcode.tm.tagContainer.currentContainer',\n    'clearcode.tm.condition.condition',\n    'clearcode.tm.pageInfo.pageInfo',\n    '$translate'\n];\n\nEditController.$inject = [\n    '$scope',\n    `${MODULE_NAME}.triggerResource`,\n    `${CONDITION_MODULE_NAME}.conditionResource`,\n    '$stateParams',\n    '$state',\n    'clearcode.tm.alert.alert',\n    'clearcode.tm.tagContainer.currentContainer',\n    'clearcode.tm.condition.condition',\n    'clearcode.tm.pageInfo.pageInfo',\n    '$translate'\n];\n\nEditInsideTagController.$inject = [\n    '$scope',\n    `${MODULE_NAME}.triggerResource`,\n    `${CONDITION_MODULE_NAME}.conditionResource`,\n    '$stateParams',\n    'clearcode.tm.alert.alert',\n    'clearcode.tm.tagContainer.currentContainer',\n    'clearcode.tm.condition.condition',\n    'clearcode.tm.pageInfo.pageInfo',\n    '$translate'\n];\n\nTriggerResource.$inject = [\n    '$http',\n    '$q'\n];\n\nangular\n    .module(MODULE_NAME, [\n        'pascalprecht.translate',\n        'ui.router',\n        'ngTable',\n        'clearcode.tm.alert',\n        'clearcode.tm.pageInfo',\n        'clearcode.tm.tagContainer',\n        'clearcode.tm.condition'\n    ])\n    .config([\n        '$stateProvider',\n        ($stateProvider) => {\n            $stateProvider\n                .state('triggers', {\n                    url: '/containers/{containerId}/triggers',\n                    controller: `${MODULE_NAME}.ManageController as view`,\n                    templateUrl: `${MODULE_DIR}/views/manage.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: true\n                    }\n                })\n                .state('triggerCreate', {\n                    url: '/containers/{containerId}/trigger-create',\n                    controller: `${MODULE_NAME}.CreateController as triggerForm`,\n                    templateUrl: `${MODULE_DIR}/views/create.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: true\n                    }\n                })\n                .state('triggerEdit', {\n                    url: '/containers/{containerId}/trigger/edit/{triggerId}',\n                    controller: `${MODULE_NAME}.EditController as triggerForm`,\n                    templateUrl: `${MODULE_DIR}/views/edit.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: true\n                    }\n                });\n        }\n    ])\n    .run([\n        'clearcode.tm.alert.$alert',\n        ($alertProvider) => {\n            $alertProvider.addMessagePattern(\n                'trigger.create',\n                'Trigger has been created successfully.'\n            );\n            $alertProvider.addMessagePattern(\n                'trigger.edit',\n                'Trigger has been updated successfully.'\n            );\n        }\n    ])\n    .controller(`${MODULE_NAME}.CreateController`, CreateController)\n    .controller(`${MODULE_NAME}.EditController`, EditController)\n    .controller(`${MODULE_NAME}.ManageController`, ManageController)\n    .controller(`${MODULE_NAME}.EditInsideTagController`, EditInsideTagController)\n    .service(`${MODULE_NAME}.triggerResource`, TriggerResource);\n\nmodule.exports = {MODULE_NAME};\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet updateResource,\n    window;\n\n/**\n * @name update#VersionController\n */\nclass VersionController {\n    constructor ($updateResource, $window, version) {\n        updateResource = $updateResource;\n        window = $window;\n        this.version = version;\n    }\n\n    updateAvailable () {\n        return this.version.latest !== undefined && !this.version.isUpToDate();\n    }\n\n    startUpdate () {\n        updateResource.setSession().then((resp) => {\n            window.location.href = resp.url;\n        });\n    }\n}\n\nexport default VersionController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name SetVersionDirective\n */\n\nvar setVersionDirective = (version, updateResource) => {\n    return {\n        restrict: 'A',\n        scope: {\n            stgVersion: '@'\n        },\n        link: (scope) => {\n            version.current = scope.stgVersion;\n\n            if (version.latest === undefined) {\n                updateResource.getLatest(version.current).then((resp) => {\n                    version.latest = resp.version;\n                });\n            }\n        }\n    };\n};\n\nexport default setVersionDirective;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name UpdateResource\n */\nclass UpdateResource {\n    constructor ($http, $q, $location) {\n        this.http = $http;\n        this.q = $q;\n        this.location = $location;\n    }\n\n    setSession () {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: 'admin-tools/update'\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    getLatest (version) {\n        var deferred = this.q.defer();\n        let domain = this.location.host();\n\n        this.http({\n            method: 'GET',\n            url: '//download.impono.org/version.json',\n            params: {\n                version: version,\n                domain: domain\n            },\n            headers: {\n                'Access-Control-Request-Headers': undefined\n            }\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n}\n\nexport default UpdateResource;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name update#Version\n */\n\nclass Version {\n\n    constructor () {\n        this.current = undefined;\n        this.latest = undefined;\n    }\n\n    isUpToDate () {\n        return this.current !== undefined && this.current === this.latest;\n    }\n}\n\nexport default Version;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport VersionController from './controllers/VersionController.js';\nimport UpdateResource from './resources/UpdateResource.js';\nimport version from './services/Version.js';\nimport setVersionDirective from './directives/setVersionDirective.js';\n\nconst MODULE_NAME = 'clearcode.tm.update';\n\nVersionController.$inject = [\n    `${MODULE_NAME}.updateResource`,\n    '$window',\n    `${MODULE_NAME}.version`\n];\n\nUpdateResource.$inject = [\n    '$http',\n    '$q',\n    '$location'\n];\n\nsetVersionDirective.$inject = [\n    `${MODULE_NAME}.version`,\n    'clearcode.tm.update.updateResource'\n];\n\nversion.$inject = [\n    '$rootScope'\n];\n\nangular\n    .module(MODULE_NAME, [])\n    .controller(`${MODULE_NAME}.VersionController`, VersionController)\n    .service(`${MODULE_NAME}.updateResource`, UpdateResource)\n    .service(`${MODULE_NAME}.version`, version)\n    .directive('stgSetVersion', setVersionDirective);\n\nmodule.exports = {MODULE_NAME};\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nconst BREADCRUMB_SECTION = 'My account';\n\n/**\n * @name BaseController\n */\nclass BaseController {\n    constructor (userResource, alert, PageInfo, state, $translate, refreshAlert) {\n        this.ACTIVATION_SET_PASSWORD = 'ACTIVATION_SET_PASSWORD';\n        this.ROLE_API = 'ROLE_API';\n        this.ROLE_USER = 'ROLE_USER';\n        this.ROLE_SUPER_ADMIN = 'ROLE_SUPER_ADMIN';\n        this.ROLE_CONTAINERS_CREATE = 'ROLE_CONTAINERS_CREATE';\n\n        this.alert = alert;\n        this.state = state;\n        this.userResource = userResource;\n        this.userPromise = undefined;\n        this.user = userResource.getEntity();\n\n        $translate([BREADCRUMB_SECTION])\n            .then((translations) => {\n                PageInfo.clear()\n                    .add(translations[BREADCRUMB_SECTION])\n                    .broadcast();\n            });\n\n        refreshAlert.success('LANGUAGE_CHANGE_MESSAGE', 'user.change_language');\n    }\n\n    displayRoleSectionForUser () {\n        return !this.state.includes('editProfile');\n    }\n\n    displayPasswordSection () {\n        if (!this.activation) {\n            return false;\n        }\n\n        return this.activation === this.ACTIVATION_SET_PASSWORD;\n    }\n\n    setUser (id) {\n        if (this.state.includes('editProfile')) {\n            this.userPromise = this.userResource.getMe();\n        } else {\n            this.role = undefined;\n            this.createContainerRole = undefined;\n            this.userPromise = this.userResource.get(id);\n        }\n\n        this.userPromise.then((resp) => {\n            this.user = resp;\n            this.role = this.getUserRole();\n            this.createContainerRole = this.user.roles.indexOf(this.ROLE_CONTAINERS_CREATE) !== -1;\n        });\n    }\n\n    getUserRole () {\n        if (this.user.hasRole(this.ROLE_SUPER_ADMIN)) {\n            return this.ROLE_SUPER_ADMIN;\n        }\n\n        if (this.user.hasRole(this.ROLE_API)) {\n            return this.ROLE_API;\n        }\n\n        return this.ROLE_USER;\n    }\n\n    setRole (role) {\n        let roleIndex = this.user.roles.indexOf(role);\n\n        if (roleIndex !== -1) {\n            this.user.roles.splice(roleIndex, 1);\n\n            return false;\n        } else {\n            this.user.roles.push(role);\n\n            return true;\n        }\n    }\n\n    submitForm (user) {\n        if (this.state.includes('editProfile')) {\n            this.userPromise = user.saveMe();\n        } else {\n            user.roles = [this.role];\n\n            if (this.role === this.ROLE_USER && this.createContainerRole) {\n                user.roles.push(this.ROLE_CONTAINERS_CREATE);\n            }\n\n            this.userPromise = user.save();\n        }\n\n        this.userPromise.then(\n            () => {\n                this.alert.success('user.save');\n\n                if (!this.state.includes('editProfile')) {\n                    this.state.go('users');\n                }\n            },\n            () => {\n                this.alert.error('user.invalid');\n            }\n        );\n    }\n\n    displayInvalidFormMessage () {\n        this.alert.error('error.invalid');\n    }\n}\n\nexport default BaseController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nconst BREADCRUMB_SECTION = 'My account';\n\nlet userResource;\nlet alert;\nlet state;\nlet scope;\nlet translate;\n\nclass ChangePasswordController {\n    constructor ($userResource, $alert, $state, PageInfo, $scope, $translate) {\n        userResource = $userResource;\n        alert = $alert;\n        state = $state;\n        scope = $scope;\n        translate = $translate;\n        this.validationForce = false;\n        this.changePasswordPromise = undefined;\n        this.translate = $translate;\n        this.currentPassword = '';\n        this.plainPassword = {\n            first: '',\n            second: ''\n        };\n\n        translate([BREADCRUMB_SECTION])\n            .then((translations) => {\n                PageInfo.clear()\n                    .add(translations[BREADCRUMB_SECTION])\n                    .broadcast();\n            });\n    }\n\n    submitForm (currentPassword, newPassword) {\n        let data = {\n            /* eslint-disable */\n            current_password: currentPassword,\n            /* eslint-enable */\n            plainPassword: newPassword\n        };\n\n        this.changePasswordPromise = userResource.changePassword(data);\n\n        this.changePasswordPromise.then(\n            () => {\n                alert.success('password.change');\n                state.go('container');\n            },\n            () => {\n                alert.error('error.invalid');\n            }\n        );\n    }\n\n    displayInvalidFormMessage (newPassword) {\n        this.validationForce = true;\n\n        if (newPassword.first !== newPassword.second) {\n            scope.changePasswordForm.first.$invalid = true;\n            scope.changePasswordForm.second.$invalid = true;\n\n            translate(['Passwords have to be identical'])\n                .then((translations) => {\n                    scope.changePasswordForm.first.$error.first = [translations['Passwords have to be identical']];\n                });\n\n            scope.changePasswordForm.second.$error.second = [];\n            alert.error('error.invalid');\n        } else if (newPassword.first === undefined || newPassword.second === undefined) {\n            alert.error('password.both');\n        } else {\n            alert.error('error.invalid');\n        }\n    }\n}\n\nexport default ChangePasswordController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport BaseController from './BaseController.js';\n\n/**\n * @type {String}\n */\nconst BREADCRUMB_TEXT = 'Add a user';\n\n/**\n * @type {String}\n */\nconst BREADCRUMB_GLOBAL = 'Users';\n/**\n * @type {String}\n */\nconst ACTIVATION_EMAIL = 'ACTIVATION_EMAIL';\n\n/**\n * @type {String}\n */\nconst ACTIVATION_SET_PASSWORD = 'ACTIVATION_SET_PASSWORD';\n\n/**\n * @type {String}\n */\nconst ROLE_USER = 'ROLE_USER';\n\nlet scope;\nlet translate;\n\n/**\n * @name CreateController\n */\nclass CreateController extends BaseController {\n    /**\n     * @param {UserResource} userResource\n     * @param {Alert} alert\n     * @param {PageInfo} PageInfo\n     * @param {$state} state\n     * @param {$scope} $scope\n     * @param {$translate} $translate\n     * @param {RefreshAlert} RefreshAlert\n     */\n    constructor (userResource, alert, PageInfo, state, $scope, $translate, RefreshAlert) {\n        super(userResource, alert, PageInfo, state, $translate, RefreshAlert);\n\n        scope = $scope;\n        translate = $translate;\n\n        this.activation = ACTIVATION_EMAIL;\n        this.role = ROLE_USER;\n\n        this.password = {\n            first: '',\n            second: ''\n        };\n\n        translate([BREADCRUMB_TEXT, BREADCRUMB_GLOBAL])\n            .then((translations) => {\n                PageInfo.clear()\n                    .add(translations[BREADCRUMB_GLOBAL], 'users')\n                    .add(translations[BREADCRUMB_TEXT])\n                    .broadcast();\n            });\n    }\n\n    /**\n     * Display error if form is invalid\n     */\n    createUserFormValidation () {\n        var isValid = false;\n\n        scope.createUserForm.first.$dirty = true;\n        scope.createUserForm.second.$dirty = true;\n\n        if (this.password.first !== this.password.second) {\n            scope.createUserForm.first.$invalid = true;\n            scope.createUserForm.second.$invalid = true;\n\n            translate(['Passwords have to be identical'])\n                .then((translations) => {\n                    scope.createUserForm.first.$error.first = [translations['Passwords have to be identical']];\n                });\n\n            scope.createUserForm.second.$error.second = [];\n            isValid = false;\n        } else if (this.password.first.length < 8 || this.password.second.length < 8) {\n            scope.createUserForm.first.$invalid = true;\n            scope.createUserForm.second.$invalid = true;\n\n            translate(['Password needs to have minimum 8 characters'])\n                .then((translations) => {\n                    scope.createUserForm.first.$error.first = [translations['Password needs to have minimum 8 characters']];\n                });\n\n            scope.createUserForm.second.$error.second = [];\n\n            isValid = false;\n        } else if (this.activation === ACTIVATION_SET_PASSWORD) {\n            isValid = true;\n        }\n\n        if (!scope.createUserForm.$valid) {\n            isValid = false\n        }\n\n        if (scope.createUserForm.$valid && this.activation === ACTIVATION_EMAIL) {\n            isValid = true;\n        }\n\n        if (!isValid) {\n            this.alert.error('user.invalid');\n        }\n\n        return isValid;\n    }\n\n    submitForm (user) {\n        user.roles = [this.role];\n\n        if (this.role === this.ROLE_USER && this.createContainerRole) {\n            user.roles.push(this.ROLE_CONTAINERS_CREATE);\n        }\n\n        if (this.activation === ACTIVATION_SET_PASSWORD) {\n            user.plainPassword = this.password;\n        }\n\n        this.userPromise = user.save();\n\n        this.userPromise.then(\n            () => {\n                this.alert.success('user.save');\n                this.state.go('users');\n            },\n            () => {\n                this.alert.error('user.invalid');\n            }\n        );\n    }\n}\n\nexport default CreateController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport BaseController from './BaseController.js';\n\n/**\n * @type {String}\n */\nconst BREADCRUMB_TEXT = 'Edit user';\n\n/**\n * @type {String}\n */\nconst BREADCRUMB_GLOBAL = 'Users';\n\nlet scope;\nlet state;\nlet translate;\n\n/**\n * @name EditController\n */\nclass EditController extends BaseController {\n    /**\n     * @param {UserResource} userResource\n     * @param {stateParams} stateParams\n     * @param {Alert} alert\n     * @param {PageInfo} PageInfo\n     * @param {$state} $state\n     * @param {$scope} $scope\n     * @param {$translate} $translate\n     * @param {refreshAlert} refreshAlert\n     * @param {security} security\n     */\n    constructor (userResource, stateParams, alert, PageInfo, $state, $scope, $translate, refreshAlert, security) {\n        super(userResource, alert, PageInfo, $state, $translate, refreshAlert);\n\n        scope = $scope;\n        state = $state;\n        translate = $translate;\n        this.security = security;\n\n        if (state.includes('editProfile')) {\n            this.setUser();\n        } else {\n            this.activation = this.ACTIVATION_SET_PASSWORD;\n\n            this.password = {\n                first: '',\n                second: ''\n            };\n\n            this.setUser(stateParams.userId);\n\n\n            translate([BREADCRUMB_TEXT, BREADCRUMB_GLOBAL])\n                .then((translations) => {\n                    PageInfo.clear()\n                        .add(translations[BREADCRUMB_GLOBAL], 'users')\n                        .add(translations[BREADCRUMB_TEXT])\n                        .broadcast();\n                });\n        }\n    }\n\n    /**\n     * Display error if form is invalid\n     */\n    editUserFormValidation () {\n        scope.editUserForm.first.$dirty = true;\n        scope.editUserForm.second.$dirty = true;\n\n        if (this.password.first === '' && this.password.second === '') {\n            return true;\n        }\n\n        if (this.password.first !== this.password.second) {\n            scope.editUserForm.first.$invalid = true;\n            scope.editUserForm.second.$invalid = true;\n\n            translate(['Passwords have to be identical'])\n                .then((translations) => {\n                    scope.editUserForm.first.$error.first = [translations['Passwords have to be identical']];\n                });\n\n            scope.editUserForm.second.$error.second = [];\n\n            return false;\n        } else if (this.password.first.length < 8 || this.password.second.length < 8) {\n            scope.editUserForm.first.$invalid = true;\n            scope.editUserForm.second.$invalid = true;\n\n            translate(['Password needs to have minimum 8 characters'])\n                .then((translations) => {\n                    scope.editUserForm.first.$error.first = [translations['Password needs to have minimum 8 characters']];\n                });\n\n            scope.editUserForm.second.$error.second = [];\n\n            return false;\n        }\n\n        return scope.editUserForm.$valid;\n    }\n\n    submitForm (user) {\n        user.roles = [this.role];\n\n        if (this.role === this.ROLE_USER && this.createContainerRole) {\n            user.roles.push(this.ROLE_CONTAINERS_CREATE);\n        }\n\n        if (this.hasOwnProperty('password')) {\n            if (this.password.first !== '') {\n                user.plainPassword = this.password;\n            }\n        }\n\n\n        if (state.includes('editProfile')) {\n            this.userPromise = user.saveMe();\n        } else {\n            this.userPromise = user.save();\n        }\n\n        this.userPromise.then(\n            () => {\n                this.security.getUser(true);\n                this.alert.success('user.save');\n\n                if (!state.includes('editProfile')) {\n                    state.go('users');\n                }\n            },\n            () => {\n                this.alert.error('user.invalid');\n            }\n        );\n    }\n}\n\nexport default EditController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet $alert,\n    $userResource;\n\nconst BREADCRUMB_TEXT = 'Users';\n\n/**\n * @name ManageController\n */\nclass ManageController {\n    constructor (TableParams, userResource, alert, paramConverter, currentContainer, PageInfo, $translate) {\n        this.translate = $translate;\n        $alert = alert;\n        $userResource = userResource;\n\n        currentContainer.disableDebugMode();\n\n        this.tableParams = new TableParams({\n            page: 1,\n            count: 10,\n            sorting: {\n                name: 'asc'\n            }\n        }, {\n            total: 0,\n            getData: ($defer, params) => {\n                userResource.query(paramConverter.list(params.url())).then((resp) => {\n                    params.total(resp.total);\n                    $defer.resolve(resp.data);\n                });\n            }\n        });\n\n        this\n            .translate([BREADCRUMB_TEXT])\n            .then((translations) => {\n                PageInfo.clear()\n                    .add(translations[BREADCRUMB_TEXT])\n                    .broadcast();\n            });\n    }\n\n    removeUser (user) {\n        user.remove().then(\n            () => {\n                $alert.success('success.remove');\n\n                if (this.tableParams.data.length === 1) {\n                    this.tableParams.page(this.tableParams.page() - 1);\n                }\n\n                this.tableParams.reload();\n            },\n            () => {\n                $alert.error('error.remove');\n                this.tableParams.reload();\n            }\n        );\n    }\n\n    resetPassword (user) {\n        let data = {\n            username: user.email\n        };\n\n        this.resetPromise = $userResource.resetPassword(data);\n\n        this.resetPromise.then(\n            () => {\n                $alert.success('user.reset');\n                this.tableParams.reload();\n            }\n        );\n    }\n}\n\nexport default ManageController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @type {Alert}\n */\nvar alert;\n\n/**\n * @type {string}\n */\nconst BREADCRUMB_SECTION = 'My account';\n\n/**\n * @type {Translation}\n */\nvar translation;\n\nclass OthersSettingsController {\n    constructor ($alert, $scope, $translate, $translation, $window, PageInfo) {\n        alert = $alert;\n        this.scope = $scope;\n        translation = $translation;\n        this.validationForce = false;\n        this.translate = $translate;\n        this.window = $window;\n        this.languages = translation.getLanguages();\n\n        if (!this.languages.length) {\n            this.loadTranslationsPromise = translation.loadAvailableTranslations();\n\n            this.loadTranslationsPromise.then(() => {\n                this.languages = translation.languages;\n            });\n        }\n\n        $translate([BREADCRUMB_SECTION])\n            .then((translations) => {\n                PageInfo.clear()\n                    .add(translations[BREADCRUMB_SECTION])\n                    .broadcast();\n            });\n    }\n\n    /**\n     * @param {Object} user\n     */\n    submitForm (user) {\n        var localStorageLang = this.window.localStorage['NG_TRANSLATE_LANG_KEY'];\n        var storedLanguage = localStorageLang ? localStorageLang : 'en';\n        this.othersSettingsPromise = user.saveOthersSettings();\n\n        this.othersSettingsPromise.then(\n            (User) => {\n                this.translate.use(User.language).then(() => {\n                    if (User.language !== storedLanguage) {\n                        this.window.localStorage['LANGUAGE_CHANGE_MESSAGE'] = true;\n                        this.window.location.reload();\n                    } else {\n                        alert.success('user.save');\n                    }\n                });\n            },\n            () => {\n                alert.error('error.invalid');\n            }\n        );\n    }\n}\n\nexport default OthersSettingsController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @type {UserResource}\n */\nvar userResource;\n\n/**\n * @type {AlertForm}\n */\nvar alertForm;\n\n/**\n * @type {String}\n */\nconst BREADCRUMB_TEXT = 'Forgot your password?';\n\n/**\n * @name security#ResetRequestController\n * @description Controller for sending request for new password\n */\nclass ResetRequestController {\n    /**\n     * @param {UserResource} $userResource\n     * @param {AlertForm} $alertForm\n     * @param {Alert} $alert\n     * @param {PageInfo} PageInfo\n     * @param {$translate} $translate\n     */\n    constructor ($userResource, $alertForm, $alert, PageInfo, $translate) {\n        this.email = '';\n        this.translate = $translate;\n        this.alert = $alert;\n        userResource = $userResource;\n\n        alertForm = $alertForm;\n        alertForm.getStorage().clean();\n\n        this.validationForce = false;\n\n        this.resetPromise = undefined;\n\n        this.success = false;\n\n        this\n            .translate([BREADCRUMB_TEXT])\n            .then((translations) => {\n                PageInfo.clear()\n                    .add(translations[BREADCRUMB_TEXT])\n                    .broadcast();\n            });\n    }\n\n    /**\n     *\n     * @param {String} email\n     */\n    submitForm (email) {\n        var data = {\n            username: email\n        };\n\n        this.resetPromise = userResource.resetPassword(data);\n\n        this.resetPromise.then(\n            () => {\n                alertForm.getStorage().clean();\n                this.success = true;\n\n                this\n                    .translate(['The email with the activation link has been sent successfully.'])\n                    .then((translations) => {\n                        this.formTitle = translations['The email with the activation link has been sent successfully.'];\n                    });\n            },\n            () => {\n                alertForm.getStorage().clean();\n                alertForm.error('request.error');\n                this.alert.error('error.invalid');\n            }\n        );\n    }\n\n    /**\n     * Display error if form is invalid\n     */\n    displayInvalidFormMessage () {\n        this.validationForce = true;\n        this.alert.error('error.invalid');\n        alertForm.getStorage().clean();\n        alertForm.error('invalid.email');\n    }\n}\n\nexport default ResetRequestController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @type {UserResource}\n */\nvar userResource;\n\n/**\n * @type {$state}\n */\nvar state;\n\n/**\n * @type {$stateParams}\n */\nvar stateParams;\n\n/**\n * @type {Alert}\n */\nvar alert;\n\n/**\n * @type {String}\n */\nconst BREADCRUMB_TEXT = 'Change your password';\n\n/**\n * @type {$scope}\n */\nvar scope;\n\n/**\n * @name security#ChangePasswordController\n * @description Controller for change password view\n */\nclass ChangePasswordController {\n    /**\n     * @param {UserResource} $userResource\n     * @param {$state} $state\n     * @param {$stateParams} $stateParams\n     * @param {Alert} $alert\n     * @param {PageInfo} PageInfo\n     * @param {$scope} $scope\n     * @param {$translate} $translate\n     */\n    constructor ($userResource, $state, $stateParams, $alert, PageInfo, $scope, $translate) {\n        this.new = {\n            first: undefined,\n            second: undefined\n        };\n\n        this.validationForce = false;\n        this.changePasswordPromise = undefined;\n        this.translate = $translate;\n\n        userResource = $userResource;\n        state = $state;\n        stateParams = $stateParams;\n        alert = $alert;\n        scope = $scope;\n\n        if (stateParams.token === '') {\n            state.go('signIn');\n            alert.error('changePassword.token');\n        }\n\n        this\n            .translate([BREADCRUMB_TEXT])\n            .then((translations) => {\n                PageInfo.clear()\n                    .add(translations[BREADCRUMB_TEXT])\n                    .broadcast();\n            });\n    }\n\n    /**\n     * @param {Object} newPassword\n     */\n    submitForm (newPassword) {\n        var password = {\n            plainPassword: newPassword\n        };\n\n        this.changePasswordPromise = userResource.setPassword(password, stateParams.token);\n\n        this.changePasswordPromise.then(\n            () => {\n                state.go('signIn');\n                alert.success('changePassword.success');\n            },\n            () => {\n                alert.error('changePassword.error');\n            }\n        );\n    }\n\n    /**\n     * Display error if form is invalid\n     * @param {Object} newPassword\n     */\n    displayInvalidFormMessage (newPassword) {\n        this.validationForce = true;\n\n        if (newPassword.first !== newPassword.second) {\n            scope.resetPasswordForm.first.$invalid = true;\n            scope.resetPasswordForm.second.$invalid = true;\n\n            this\n                .translate(['Passwords have to be identical'])\n                .then((translations) => {\n                    scope.resetPasswordForm.first.$error.first = [translations['Passwords have to be identical']];\n                });\n\n            scope.resetPasswordForm.second.$error.second = [];\n        } else if (newPassword.first === undefined || newPassword.second === undefined) {\n            alert.error('password.both');\n        }\n    }\n}\n\nexport default ChangePasswordController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar userFactory = (resource) => {\n    /**\n     * @name User\n     * @description User entity\n     */\n    class User {\n        constructor () {\n            /**\n             * @type {number}\n             */\n            this.id = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.email = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.firstName = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.lastName = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.displayName = undefined;\n\n            /**\n             * @type {Array}\n             */\n            this.roles = [];\n\n            /**\n             * @type {Boolean}\n             */\n            this.status = false;\n\n            /**\n             * @type {Date}\n             */\n            this.createdAt = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.language = undefined;\n        }\n\n        hasRole (role) {\n            return this.roles.indexOf(role) !== -1;\n        }\n\n        save () {\n            let result = {},\n                promise,\n                excludedProperty = ['id', 'displayName', 'status', 'createdAt', 'language'],\n                excludedInEdit = ['email'];\n\n            for (var property in this) {\n                if (\n                    !angular.isFunction(this[property]) &&\n                    this.hasOwnProperty(property) &&\n                    excludedProperty.indexOf(property) === -1\n                ) {\n                    if (this.id === undefined || excludedInEdit.indexOf(property) === -1) {\n                        result[property] = this[property];\n                    }\n                }\n            }\n\n            if (this.id === undefined) {\n                promise = resource.post(result);\n            } else {\n                promise = resource.put(this.id, result);\n            }\n\n            return promise;\n        }\n\n        saveMe () {\n            let result = {},\n                promise,\n                excludedProperty = ['id', 'displayName', 'roles', 'status', 'createdAt', 'email', 'language'];\n\n            for (var property in this) {\n                if (\n                    !angular.isFunction(this[property]) &&\n                    this.hasOwnProperty(property) &&\n                    excludedProperty.indexOf(property) === -1\n                ) {\n                    result[property] = this[property];\n                }\n            }\n\n            promise = resource.putMe(result);\n\n            return promise;\n        }\n\n        saveOthersSettings () {\n            let result = {},\n                promise,\n                excludedProperty = ['id', 'displayName', 'roles', 'status', 'createdAt', 'email', 'firstName', 'lastName'];\n\n            for (let property in this) {\n                if (\n                    !angular.isFunction(this[property]) &&\n                    this.hasOwnProperty(property) &&\n                    excludedProperty.indexOf(property) === -1\n                ) {\n                    result[property] = this[property];\n                }\n            }\n\n            promise = resource.othersSettingsMe(result);\n\n            return promise;\n        }\n\n        remove () {\n            if (this.id === undefined) {\n                return false;\n            }\n\n            return resource.delete(this.id);\n        }\n    }\n\n    return User;\n};\n\nexport default userFactory;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport userFactory from '../entities/User.js';\n\nconst CHANGE_PASSWORD_ROUTE = '/api/users/me/change-password';\nconst RESET_REQUEST_ROUTE = '/api/reset-password/request';\nconst RESET_PASSWORD_ROUTE = '/api/reset-password/token/';\nconst DEFAULT_LANGUAGE = 'en';\n\nvar transformResponse = function (resp) {\n    var user = this.getEntity();\n\n    if (resp !== undefined) {\n        user.id = resp.id;\n        user.email = resp.email;\n        user.firstName = resp.first_name;\n        user.lastName = resp.last_name;\n        user.displayName = resp.display_name;\n        user.roles = resp.roles;\n        user.status = resp.status;\n        user.createdAt = resp.created_at;\n\n        if (resp.language === null) {\n            user.language = DEFAULT_LANGUAGE;\n        } else {\n            user.language = resp.language;\n        }\n    }\n\n    return user;\n};\n\nvar appendTransform = function (defaults, transform) {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name UserResource\n */\nclass UserResource {\n    /**\n     * @param {$http} $http\n     * @param {$q} $q\n     */\n    constructor ($http, $q) {\n        this.http = $http;\n        this.q = $q;\n    }\n\n    /**\n     * @returns {User}\n     */\n    getEntity () {\n        var User = userFactory(this);\n\n        return new User();\n    }\n\n    /**\n     * @description Send request to get specific entity\n     *\n     * @param {number} id\n     * @returns {deferred.promise}\n     */\n    get (id) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: `/api/users/${id}`,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (status < 400) {\n                    return transformResponse.call(this, resp.data);\n                } else {\n                    return resp;\n                }\n            })\n        })\n            .success((data) => {\n                deferred.resolve(data);\n            })\n            .error(() => {\n                deferred.reject();\n            });\n\n        return deferred.promise;\n    }\n\n    /**\n     * @description Send request to get specific entity\n     *\n     * @returns {deferred.promise}\n     */\n    getMe () {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: '/api/users/me',\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (status < 400) {\n                    return transformResponse.call(this, resp.data);\n                } else {\n                    return resp;\n                }\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    /**\n     * @description Send request to get list of entity\n     *\n     * @param {Object} params\n     *\n     * @returns {deferred.promise}\n     */\n    query (params) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: '/api/users',\n            params: params,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp) => {\n                if (status < 400) {\n                    for (var element in resp.data) {\n                        if (resp.data[element] instanceof Object) {\n                            resp.data[element] = transformResponse.call(this, resp.data[element]);\n                        }\n                    }\n                }\n\n                return resp;\n            })\n        })\n            .success((data) => {\n                deferred.resolve(data);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    /**\n     * @description Send request to delete entity\n     *\n     * @param {number} id\n     *\n     * @returns {deferred.promise}\n     */\n    delete (id) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'DELETE',\n            url: `/api/users/${id}`\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    /**\n     * @description Send request to create entity\n     *\n     * @param {object} entity\n     */\n    post (entity) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'POST',\n            url: '/api/users',\n            data: entity,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (status < 400) {\n                    return transformResponse.call(this, resp.data);\n                } else {\n                    return resp;\n                }\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    /**\n     * Send request to update entity\n     *\n     * @param {number} id\n     * @param {object} entity\n     *\n     * @returns {deferred.promise}\n     */\n    put (id, entity) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'PUT',\n            url: `/api/users/${id}`,\n            data: entity,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (status < 400) {\n                    return transformResponse.call(this, resp.data);\n                } else {\n                    return resp;\n                }\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    /**\n     * Send request to update entity\n     *\n     * @param {number} id\n     * @param {object} entity\n     *\n     * @returns {deferred.promise}\n     */\n    putMe (entity) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'PUT',\n            url: '/api/users/me',\n            data: entity,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (status < 400) {\n                    return transformResponse.call(this, resp.data);\n                } else {\n                    return resp;\n                }\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    /**\n     * Send request to update entity\n     *\n     * @param {object} entity\n     *\n     * @returns {deferred.promise}\n     */\n    othersSettingsMe (entity) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'PUT',\n            url: '/api/users/me/others-settings',\n            data: entity,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (status < 400) {\n                    return transformResponse.call(this, resp.data);\n                } else {\n                    return resp;\n                }\n            })\n        })\n        .success((resp) => {\n            deferred.resolve(resp);\n        })\n        .error((err) => {\n            deferred.reject(err);\n        });\n\n        return deferred.promise;\n    }\n\n    /**\n     * @description Send request to change password\n     *\n     * @param {Object} data\n     * @returns {deferred.promise|*}\n     */\n    changePassword (data) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'POST',\n            data: data,\n            url: CHANGE_PASSWORD_ROUTE\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    /**\n     * @description Send request to reset password\n     *\n     * @param {Object} data\n     * @returns {deferred.promise|*}\n     */\n    resetPassword (data) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'POST',\n            data: data,\n            url: RESET_REQUEST_ROUTE\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    /**\n     * @description Send request to confirm password with the new one\n     *\n     * @param {Object} data\n     * @param {String} token\n     * @returns {deferred.promise|*}\n     */\n    setPassword (data, token) {\n        var deferred = this.q.defer();\n\n        this.http({\n            method: 'POST',\n            data: data,\n            url: RESET_PASSWORD_ROUTE + token\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n}\n\nexport default UserResource;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport CreateController from './controllers/CreateController.js';\nimport EditController from './controllers/EditController.js';\nimport ManageController from './controllers/ManageController.js';\n\nimport OthersSettingsController from './controllers/OthersSettingsController.js';\nimport ChangePasswordController from './controllers/ChangePasswordController.js';\nimport ResetRequestController from './controllers/ResetRequestController.js';\nimport SetPasswordController from './controllers/SetPasswordController.js';\n\nimport UserResource from './resources/UserResource.js';\n\nconst MODULE_NAME = 'clearcode.tm.user';\nconst MODULE_DIR = 'app/modules/user';\n\nCreateController.$inject = [\n    `${MODULE_NAME}.userResource`,\n    'clearcode.tm.alert.alert',\n    'clearcode.tm.pageInfo.pageInfo',\n    '$state',\n    '$scope',\n    '$translate',\n    'clearcode.tm.alert.refreshAlert'\n];\n\nEditController.$inject = [\n    `${MODULE_NAME}.userResource`,\n    '$stateParams',\n    'clearcode.tm.alert.alert',\n    'clearcode.tm.pageInfo.pageInfo',\n    '$state',\n    '$scope',\n    '$translate',\n    'clearcode.tm.alert.refreshAlert',\n    'clearcode.tm.security.security'\n];\n\nManageController.$inject = [\n    'ngTableParams',\n    `${MODULE_NAME}.userResource`,\n    'clearcode.tm.alert.alert',\n    'clearcode.tm.tagContainer.paramConverter',\n    'clearcode.tm.tagContainer.currentContainer',\n    'clearcode.tm.pageInfo.pageInfo',\n    '$translate'\n];\n\nChangePasswordController.$inject = [\n    'clearcode.tm.user.userResource',\n    'clearcode.tm.alert.alert',\n    '$state',\n    'clearcode.tm.pageInfo.pageInfo',\n    '$scope',\n    '$translate'\n];\n\nOthersSettingsController.$inject = [\n    'clearcode.tm.alert.alert',\n    '$scope',\n    '$translate',\n    'clearcode.tm.translation.translation',\n    '$window',\n    'clearcode.tm.pageInfo.pageInfo'\n];\n\nResetRequestController.$inject = [\n    `${MODULE_NAME}.userResource`,\n    'clearcode.tm.form.alertForm',\n    'clearcode.tm.alert.alert',\n    'clearcode.tm.pageInfo.pageInfo',\n    '$translate'\n];\n\nSetPasswordController.$inject = [\n    `${MODULE_NAME}.userResource`,\n    '$state',\n    '$stateParams',\n    'clearcode.tm.alert.alert',\n    'clearcode.tm.pageInfo.pageInfo',\n    '$scope',\n    '$translate'\n];\n\nUserResource.$inject = [\n    '$http',\n    '$q'\n];\n\nangular\n    .module(MODULE_NAME, [\n        'pascalprecht.translate',\n        'ui.router',\n        'ngTable',\n        'clearcode.tm.alert',\n        'clearcode.tm.pageInfo',\n        'clearcode.tm.form',\n        'clearcode.tm.tagContainer',\n        'clearcode.tm.security'\n    ])\n    .run([\n        'clearcode.tm.alert.$alert',\n\n        ($alertProvider) => {\n            $alertProvider.addMessagePattern(\n                'user.save',\n                'User account has been saved successfully.'\n            );\n\n            $alertProvider.addMessagePattern(\n                'user.change_language',\n                'The language has been changed'\n            );\n\n            $alertProvider.addMessagePattern(\n                'password.change',\n                'Your password has been changed successfully.'\n            );\n\n            $alertProvider.addMessagePattern(\n                'user.invalid',\n                'Sorry, something went wrong.'\n            );\n\n            $alertProvider.addMessagePattern(\n                'user.reset',\n                'Email with activation link has been sent.'\n            );\n\n            $alertProvider.addMessagePattern(\n                'user.others',\n                'Other settings has been saved successfully.'\n            );\n        }\n    ])\n    .config([\n        '$stateProvider',\n\n        ($stateProvider) => {\n            $stateProvider\n                .state('users', {\n                    url: '/users',\n                    controller: `${MODULE_NAME}.ManageController as view`,\n                    templateUrl: `${MODULE_DIR}/views/manage.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: false\n                    }\n                })\n                .state('userCreate', {\n                    url: '/users-create',\n                    controller: `${MODULE_NAME}.CreateController as view`,\n                    templateUrl: `${MODULE_DIR}/views/create.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: false\n                    }\n                })\n                .state('userEdit', {\n                    url: '/users-edit/{userId}',\n                    controller: `${MODULE_NAME}.EditController as view`,\n                    templateUrl: `${MODULE_DIR}/views/edit.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: false\n                    }\n                })\n                .state('editProfile', {\n                    url: '/profile',\n                    controller: `${MODULE_NAME}.EditController as view`,\n                    controllerAs: 'view',\n                    data: {\n                        roles: ['ROLE_SUPER_ADMIN'],\n                        secure: true\n                    },\n                    templateUrl: '/app/modules/user/views/profile.html'\n                })\n                .state('resetPassword', {\n                    url: '/reset-password',\n                    controller: `${MODULE_NAME}.ResetRequestController`,\n                    controllerAs: 'view',\n                    data: {\n                        roles: [],\n                        secure: false\n                    },\n                    templateUrl: '/app/modules/user/views/resetPassword.html'\n                })\n                .state('resetConfirm', {\n                    url: '/reset-password/token/{token}',\n                    controller: `${MODULE_NAME}.SetPasswordController`,\n                    controllerAs: 'view',\n                    data: {\n                        roles: [],\n                        secure: false\n                    },\n                    templateUrl: '/app/modules/user/views/setPassword.html'\n                });\n        }\n    ])\n    .controller(`${MODULE_NAME}.CreateController`, CreateController)\n    .controller(`${MODULE_NAME}.EditController`, EditController)\n    .controller(`${MODULE_NAME}.ManageController`, ManageController)\n    .controller(`${MODULE_NAME}.OthersSettingsController`, OthersSettingsController)\n    .controller(`${MODULE_NAME}.ChangePasswordController`, ChangePasswordController)\n    .controller(`${MODULE_NAME}.ResetRequestController`, ResetRequestController)\n    .controller(`${MODULE_NAME}.SetPasswordController`, SetPasswordController)\n    .service(`${MODULE_NAME}.userResource`, UserResource);\n\nmodule.exports = {MODULE_NAME};\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name BaseController\n */\nclass BaseController {\n    constructor (\n        $variableResource,\n        $typeResource,\n        $PageInfo,\n        $scope,\n        $variableFormProvider,\n        currentContainer,\n        $stateParams,\n        $alert,\n        $state,\n        $translate,\n        $condition\n        ) {\n        this.typeResource = $typeResource;\n        this.variableFormProvider = $variableFormProvider;\n        this.currentContainer = currentContainer;\n        this.condition = $condition;\n        this.stateParams = $stateParams;\n        this.alert = $alert;\n        this.state = $state;\n        this.translate = $translate;\n\n        this.variable = $variableResource.getEntityObject();\n        this.formTouched = false;\n\n        $scope.$on('pageInfo.reload', (event, args) => {\n            $translate([this.getBreadcrumbText()]).then((translations) => {\n                $PageInfo.clear()\n                    .add(args.name, 'tags', {\n                        containerId: args.id\n                    })\n                    .add(translations[this.getBreadcrumbText()], 'variables', {\n                        containerId: args.id\n                    })\n                    .broadcast();\n            });\n        });\n    }\n\n    getVariableTypes () {\n        this.typesPromise = this.typeResource.query();\n\n        this.typesPromise.then(\n            resp => {\n                this.types = resp.data;\n                if (this.variable.type && this.variable.type.id === undefined) {\n                    for (let i = 0; i < this.types.length; i++) {\n                        if (this.variable.type === this.types[i].id) {\n                            this.variable.type = this.types[i];\n                            this.formTouched = true;\n                            break;\n                        }\n                    }\n                }\n            }\n        );\n    }\n\n    setVariableType (type) {\n        this.variable.type = type;\n        this.variable.value = '';\n        this.formTouched = true;\n    }\n\n    getConfigurationTemplate () {\n        let typeId = this.variable.type.id !== undefined\n            ? this.variable.type.id\n            : this.variable.type;\n\n        return this.variableFormProvider.getType(typeId).templateUrl;\n    }\n\n    submitForm (variable) {\n        this.variablePromise = variable.save(this.stateParams.containerId);\n\n        this.variablePromise.then(\n            () => {\n                this.currentContainer.makeChanges();\n                this.condition.refresh();\n                this.alert.success(this.getAlertType());\n\n                this.state.go('variables', {\n                    containerId: this.stateParams.containerId\n                });\n            },\n            () => {\n                this.alert.error('error.invalid');\n            }\n        );\n    }\n\n    displayInvalidFormMessage () {\n        this.validateVariable = true;\n        this.alert.error('error.invalid');\n    }\n}\n\nexport default BaseController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport BaseController from './BaseController.js';\n\nconst BREADCRUMB_GLOBAL = 'Variables';\n\n/**\n * @name CreateController\n */\nclass CreateController extends BaseController {\n    constructor (\n        $variableResource,\n        $typeResource,\n        $PageInfo,\n        $scope,\n        $variableFormProvider,\n        currentContainer,\n        $stateParams,\n        $alert,\n        $state,\n        $translate,\n        $condition\n    ) {\n        super(\n            $variableResource,\n            $typeResource,\n            $PageInfo,\n            $scope,\n            $variableFormProvider,\n            currentContainer,\n            $stateParams,\n            $alert,\n            $state,\n            $translate,\n            $condition\n        );\n\n        this.variable = $variableResource.getEntityObject();\n\n        this.getVariableTypes();\n\n        currentContainer.getContainer().then( () => {\n            if (!currentContainer.$container.hasPermission('edit')) {\n                $state.go('triggers', {containerId: $stateParams.containerId});\n            }\n\n            this\n                .translate([this.getBreadcrumbText(), BREADCRUMB_GLOBAL])\n                .then((translations) => {\n                    $PageInfo.clear()\n                        .add(currentContainer.$container.name, 'tags', {\n                            containerId: currentContainer.$container.id\n                        })\n                        .add(translations[BREADCRUMB_GLOBAL], 'variables', {\n                            containerId: currentContainer.$container.id\n                        })\n                        .add(translations[this.getBreadcrumbText()])\n                        .broadcast();\n                });\n        });\n    }\n\n    getBreadcrumbText () {\n        return 'Add a new variable';\n    }\n\n    getAlertType () {\n        return 'success.create';\n    }\n}\n\nexport default CreateController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport BaseController from './BaseController.js';\n\nconst BREADCRUMB_GLOBAL = 'Variables';\n\n/**\n * @name EditController\n */\nclass EditController extends BaseController {\n    constructor (\n        $variableResource,\n        $typeResource,\n        $PageInfo,\n        $scope,\n        $variableFormProvider,\n        currentContainer,\n        $stateParams,\n        $alert,\n        $state,\n        $translate,\n        $condition\n        ) {\n        super(\n            $variableResource,\n            $typeResource,\n            $PageInfo,\n            $scope,\n            $variableFormProvider,\n            currentContainer,\n            $stateParams,\n            $alert,\n            $state,\n            $translate,\n            $condition\n        );\n\n        this.variablePromise = $variableResource.get($stateParams.variableId);\n\n        this.variablePromise.then(\n            resp => {\n                this.variable = resp;\n                this.getVariableTypes();\n            }\n        );\n\n        this.currentContainer.getContainer().then(() => {\n            if (this.currentContainer.$container.hasPermission('noaccess')) {\n                this.state.go('container');\n            }\n\n            this\n                .translate([this.getBreadcrumbText(), BREADCRUMB_GLOBAL])\n                .then((translations) => {\n                    $PageInfo.clear()\n                        .add(this.currentContainer.$container.name, 'tags', {\n                            containerId: this.currentContainer.$container.id\n                        })\n                        .add(translations[BREADCRUMB_GLOBAL], 'variables', {\n                            containerId: this.currentContainer.$container.id\n                        })\n                        .add(translations[this.getBreadcrumbText()])\n                        .broadcast();\n                });\n        });\n\n        this.formTouched = true;\n    }\n\n    getBreadcrumbText () {\n        return 'Configure variable';\n    }\n\n    getAlertType () {\n        return 'success.edit';\n    }\n}\n\nexport default EditController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet $alert,\n    stateParams,\n    currentContainer,\n    scope;\n\nconst BREADCRUMB_TEXT = 'Variables';\n\n/**\n * @name ManageController\n */\nclass ManageController {\n    constructor (\n        TableParams,\n        $stateParams,\n        variableResource,\n        alert,\n        paramConverter,\n        CurrentContainer,\n        PageInfo,\n        $scope,\n        state,\n        $translate\n    ) {\n        $alert = alert;\n        stateParams = $stateParams;\n        currentContainer = CurrentContainer;\n        scope = $scope;\n\n        this.permissions = [];\n        this.containerId = stateParams.containerId;\n\n        currentContainer.getContainer().then((container) => {\n            if (!currentContainer.$container.hasPermission('view')) {\n                state.go('container');\n            } else {\n                this.permissions = currentContainer.$container.permissions;\n            }\n\n            $translate([BREADCRUMB_TEXT]).then((translations) => {\n                PageInfo.clear()\n                    .add(container.name, 'variable', {\n                        containerId: container.id\n                    })\n                    .add(translations[BREADCRUMB_TEXT])\n                    .broadcast();\n            });\n        });\n\n        this.tableParams = new TableParams({\n            page: 1,\n            count: 10,\n            sorting: {\n                name: 'asc'\n            }\n        }, {\n            total: 0,\n            getData: ($defer, params) => {\n                variableResource.query(stateParams.containerId, paramConverter.list(params.url())).then((resp) => {\n                    params.total(resp.total);\n                    $defer.resolve(resp.data);\n                });\n            }\n        });\n\n        scope.$on('pageInfo.reload', (event, args) => {\n            $translate([BREADCRUMB_TEXT]).then((translations) => {\n                PageInfo.clear()\n                    .add(args.name, 'variables', {\n                        containerId: args.id\n                    })\n                    .add(translations[BREADCRUMB_TEXT])\n                    .broadcast();\n            });\n        });\n    }\n\n    removeVariable (variable) {\n        variable.remove().then(\n            () => {\n                $alert.success('success.remove');\n                currentContainer.makeChanges();\n\n                if (this.tableParams.data.length === 1 && this.tableParams.page() > 1) {\n                    this.tableParams.page(this.tableParams.page() - 1);\n                } else {\n                    this.tableParams.reload();\n                }\n            },\n            () => {\n                $alert.error('error.remove');\n                this.tableParams.reload();\n            }\n        );\n    }\n}\n\nexport default ManageController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet variableSelector,\n    scope,\n    compile;\n\nclass SelectorController {\n    constructor ($compile, $scope, $variableSelector, condition) {\n        compile = $compile;\n        scope = $scope;\n        variableSelector = $variableSelector;\n\n        condition.allVariables().then(resp => {\n            this.variables = resp;\n        });\n    }\n\n    init ($element, $ngModel) {\n        this.element = $element;\n        this.ngModel = $ngModel;\n\n        let listElement = compileListView();\n        this.ulElement = listElement.children();\n\n        createWrapper(this.element, listElement);\n    }\n\n    toggleVariablesList (event) {\n        let elementValue = this.element.val().trim();\n\n        this.isVariablesListVisible()\n            ? this.element.val(variableSelector.removeVariablePrompt(elementValue))\n            : this.element.val(variableSelector.addVariablePrompt(elementValue));\n\n        this.ulElement.toggleClass('show');\n        stopBubblingEvent(event);\n    }\n\n    addVariable (variable) {\n        let elementValue = this.element.val().trim();\n        this.ulElement.removeClass('show');\n\n        this.ngModel.$setViewValue(variableSelector.selectVariable(elementValue, variable));\n        this.ngModel.$render();\n        this.element[0].focus();\n    }\n\n    closeVariablePrompt (event) {\n        let elementValue = this.element.val().trim();\n\n        if (!this.isVariablesListVisible()) {\n            return;\n        }\n\n        this.ulElement.removeClass('show');\n        this.element.val(variableSelector.removeVariablePrompt(elementValue));\n        stopBubblingEvent(event);\n    }\n\n    isVariablesListVisible () {\n        return this.ulElement.hasClass('show');\n    }\n}\n\nfunction stopBubblingEvent (event) {\n    event.stopPropagation();\n    event.cancelBubble = true;\n}\n\nfunction compileListView () {\n    let listTemplate = angular.element(document.getElementById('variables-list.html')).html();\n\n    return compile(listTemplate)(scope);\n}\n\nfunction createWrapper (element, listElement) {\n    let btnElement = compile(variableSelector.getTemplate())(scope),\n        inputGroupWrapper;\n\n    element.wrap(variableSelector.getElementWrapper());\n\n    inputGroupWrapper = element.parent();\n    inputGroupWrapper.append(btnElement);\n    inputGroupWrapper.append(listElement);\n}\n\nexport default SelectorController;","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar variableClickOutside = ($document) => {\n    return {\n        restrict: 'A',\n        require: 'variableSelector',\n        link: (scope, element, attrs, selectorCtrl) => {\n            $document.on('click', documentOnClick);\n            scope.$on('$destroy', () => {\n                $document.off('click', documentOnClick);\n            });\n\n            function documentOnClick (event) {\n                let outside = !element[0].contains(event.target),\n                    listVisible = selectorCtrl.isVariablesListVisible();\n\n                if (outside && listVisible) {\n                    element.val(selectorCtrl.closeVariablePrompt(event));\n                }\n            }\n        }\n    };\n};\n\nexport default variableClickOutside;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport SelectorController from '../controllers/SelectorController.js';\n\nvar variableSelectorDirective = () => {\n    return {\n        restrict: 'A',\n        require: ['variableSelector', 'ngModel'],\n        scope: {},\n        link: (scope, element, attrs, controllers) => {\n            let selectorController = controllers[0];\n            let ngModel = controllers[1];\n\n            selectorController.init(element, ngModel);\n        },\n        controller: SelectorController,\n        controllerAs: 'selectorCtrl',\n        bindToController: true\n    };\n};\n\nexport default variableSelectorDirective;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet variableFactory = (resource) => {\n    /**\n     * @name Variable\n     * @description Variable entity\n     */\n    class Variable {\n        constructor () {\n            /**\n             * @type {number}\n             */\n            this.id = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.name = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.description = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.type = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.value = undefined;\n\n            /**\n             * @type {Object}\n             */\n            this.options = [];\n\n            /**\n             * @type {string}\n             */\n            this.updatedAt = undefined;\n        }\n\n        save (containerId) {\n            let result = {},\n                promise,\n                excludedProperty = ['id', 'updatedAt'];\n\n            for (let property in this) {\n                if (\n                    !angular.isFunction(this[property]) &&\n                    this.hasOwnProperty(property) &&\n                    excludedProperty.indexOf(property) === -1\n                ) {\n                    if (property === 'type') {\n                        result[property] = this[property].id;\n                    } else {\n                        result[property] = this[property];\n                    }\n                }\n            }\n\n            if (this.id === undefined) {\n                promise = resource.post(containerId, result);\n            } else {\n                promise = resource.put(this.id, result);\n            }\n\n            return promise;\n        }\n\n        remove () {\n            if (this.id === undefined) {\n                return false;\n            }\n\n            return resource.delete(this.id);\n        }\n    }\n\n    return Variable;\n};\n\n\nexport default variableFactory;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar variableTypeFactory = () => {\n    /**\n     * @name Variable\n     * @description Variable entity\n     */\n    class VariableType {\n        constructor () {\n            /**\n             * @type {number}\n             */\n            this.id = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.name = undefined;\n\n            /**\n             * @type {string}\n             */\n            this.helper = undefined;\n        }\n    }\n\n    return VariableType;\n};\n\n\nexport default variableTypeFactory;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name variable#VariableFormProvider\n * @namespace clearcode.tm.variable\n */\n/* eslint-disable */\nclass VariableFormProvider {\n    constructor () {\n        this.collection = {};\n    }\n\n    addType (name, settings) {\n        if (this.collection[name] !== undefined) {\n            throw new Error('Form type with provided name already exist');\n        }\n\n        this.collection[name] = settings;\n\n        return this;\n    }\n\n    getType (name) {\n        if (this.collection[name] === undefined) {\n            return false;\n        }\n\n        return this.collection[name];\n    }\n\n    $get () {\n        return this;\n    }\n}\n/* eslint-enable */\nexport default VariableFormProvider;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport variableFactory from '../entity/Variable.js';\n\nlet transformResponse = function (resp) {\n    let Variable = variableFactory(this);\n\n    let variable = new Variable();\n\n    variable.id = resp.id;\n    variable.name = resp.name;\n    variable.description = resp.description;\n    variable.type = resp.type;\n    variable.value = resp.value;\n    variable.options = resp.options;\n    variable.updatedAt = resp.updated_at;\n\n    return variable;\n};\n\n\nlet appendTransform = function (defaults, transform) {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name VariableResource\n */\nclass VariableResource {\n    constructor ($http, $q) {\n        this.http = $http;\n        this.q = $q;\n    }\n\n    getEntityObject () {\n        let Variable = variableFactory(this);\n\n        return new Variable();\n    }\n\n    get (id) {\n        let deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: `/api/variables/${id}`,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (status < 400) {\n                    return transformResponse.call(this, resp.data);\n                } else {\n                    return resp;\n                }\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    query (containerId, params) {\n        let deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: `/api/containers/${containerId}/variables`,\n            params: params,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp) => {\n                for (let element in resp.data) {\n                    if (resp.data[element] instanceof Object) {\n                        resp.data[element] = transformResponse.call(this, resp.data[element]);\n                    }\n                }\n\n                return resp;\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    queryAllAvailable (containerId, params) {\n        let deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: `/api/containers/${containerId}/available-variables`,\n            params: params,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp) => {\n                for (let element in resp.data) {\n                    if (resp.data[element] instanceof Object) {\n                        resp.data[element] = transformResponse.call(this, resp.data[element]);\n                    }\n                }\n\n                return resp;\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    delete (id) {\n        let deferred = this.q.defer();\n\n        this.http({\n            method: 'DELETE',\n            url: `/api/variables/${id}`\n        })\n            .success((data) => {\n                deferred.resolve(data);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    post (containerId, entity) {\n        let deferred = this.q.defer();\n\n        this.http({\n            method: 'POST',\n            url: `/api/containers/${containerId}/variables`,\n            data: entity,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (status < 400) {\n                    return transformResponse.call(this, resp.data);\n                } else {\n                    return resp;\n                }\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n\n    put (id, entity) {\n        let deferred = this.q.defer();\n\n        this.http({\n            method: 'PUT',\n            url: `/api/variables/${id}`,\n            data: entity,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp, header, status) => {\n                if (status < 400) {\n                    return transformResponse.call(this, resp.data);\n                } else {\n                    return resp;\n                }\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n}\n\nexport default VariableResource;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport variableTypeFactory from '../entity/VariableType.js';\n\nlet transformResponse = function (resp) {\n    let VariableType = variableTypeFactory(this);\n\n    let type = new VariableType();\n\n    type.id = resp.id;\n    type.name = resp.name;\n    type.helper = resp.helper;\n\n    return type;\n};\n\n\nlet appendTransform = function (defaults, transform) {\n    defaults = angular.isArray(defaults) ? defaults : [defaults];\n\n    return defaults.concat(transform);\n};\n\n/**\n * @name VariableResource\n */\nclass VariableTypeResource {\n    constructor ($http, $q) {\n        this.http = $http;\n        this.q = $q;\n    }\n\n    getEntityObject () {\n        let VariableType = variableTypeFactory(this);\n\n        return new VariableType();\n    }\n\n    query (params) {\n        let deferred = this.q.defer();\n\n        this.http({\n            method: 'GET',\n            url: '/api/variable-types',\n            params: params,\n            transformResponse: appendTransform(this.http.defaults.transformResponse, (resp) => {\n                for (let element in resp.data) {\n                    if (resp.data[element] instanceof Object) {\n                        resp.data[element] = transformResponse.call(this, resp.data[element]);\n                    }\n                }\n\n                return resp;\n            })\n        })\n            .success((resp) => {\n                deferred.resolve(resp);\n            })\n            .error((err) => {\n                deferred.reject(err);\n            });\n\n        return deferred.promise;\n    }\n}\n\nexport default VariableTypeResource;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nconst template = `\n    <span class=\"input-group-addon\" ng-click=\"selectorCtrl.toggleVariablesList($event)\" style=\"cursor: pointer;\">\n        <i class=\"icon-variable-insert\"></i>\n    </span>`;\n\nconst elementWrapper = '<div class=\"input-group cc-select\"></div>';\n\n/**\n * @name VariableSelector\n */\nclass VariableSelector {\n    getTemplate () {\n        return template;\n    }\n\n    getElementWrapper () {\n        return elementWrapper;\n    }\n\n    addVariablePrompt (elementValue) {\n        let text = !isVariablePromptOpen(elementValue)\n            ? openVariablePrompt(elementValue)\n            : elementValue;\n\n        return text;\n    }\n\n    selectVariable (elementValue, variable) {\n        return `${elementValue} ${variable.name} }}`.trim();\n    }\n\n    removeVariablePrompt (elementValue) {\n        return isVariablePromptOpen(elementValue)\n            ? removeVariablePrompt(elementValue)\n            : elementValue;\n    }\n\n    static selectorFactory () {\n        return new VariableSelector();\n    }\n}\n\nfunction isVariablePromptOpen (elementValue) {\n    return elementValue.slice(-2) === '{{';\n}\n\nfunction openVariablePrompt (elementValue) {\n    return `${elementValue} {{`.trim();\n}\n\nfunction removeVariablePrompt (elementValue) {\n    return elementValue.substring(0, elementValue.length - 2).trim();\n}\nexport default VariableSelector;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport ManageController from './controllers/ManageController.js';\nimport CreateController from './controllers/CreateController.js';\nimport EditController from './controllers/EditController.js';\nimport SelectorController from './controllers/SelectorController';\n\nimport VariableResource from './resource/VariableResource.js';\nimport VariableTypeResource from './resource/VariableTypeResource.js';\nimport VariableFormProvider from './providers/VariableFormProvider.js';\nimport VariableSelector from './services/VariableSelector.js';\n\nimport variableSelectorDirective from './directives/variableSelector.js';\nimport clickOutsideElement from './directives/variableClickOutside.js';\n\nconst MODULE_NAME = 'clearcode.tm.variable';\nconst MODULE_DIR = 'app/modules/variable';\n\nconst CONDITION_MODULE_NAME = 'clearcode.tm.condition';\n\nManageController.$inject = [\n    'ngTableParams',\n    '$stateParams',\n    `${MODULE_NAME}.variableResource`,\n    'clearcode.tm.alert.alert',\n    'clearcode.tm.tagContainer.paramConverter',\n    'clearcode.tm.tagContainer.currentContainer',\n    'clearcode.tm.pageInfo.pageInfo',\n    '$scope',\n    '$state',\n    '$translate'\n];\n\nSelectorController.$inject = [\n    '$compile',\n    '$scope',\n    `${MODULE_NAME}.variableSelector`,\n    `${CONDITION_MODULE_NAME}.condition`\n];\n\nCreateController.$inject = [\n    `${MODULE_NAME}.variableResource`,\n    `${MODULE_NAME}.variableTypeResource`,\n    'clearcode.tm.pageInfo.pageInfo',\n    '$scope',\n    `${MODULE_NAME}.$variableForm`,\n    'clearcode.tm.tagContainer.currentContainer',\n    '$stateParams',\n    'clearcode.tm.alert.alert',\n    '$state',\n    '$translate',\n    'clearcode.tm.condition.condition'\n];\n\nEditController.$inject = [\n    `${MODULE_NAME}.variableResource`,\n    `${MODULE_NAME}.variableTypeResource`,\n    'clearcode.tm.pageInfo.pageInfo',\n    '$scope',\n    `${MODULE_NAME}.$variableForm`,\n    'clearcode.tm.tagContainer.currentContainer',\n    '$stateParams',\n    'clearcode.tm.alert.alert',\n    '$state',\n    '$translate',\n    'clearcode.tm.condition.condition'\n];\n\nVariableResource.$inject = [\n    '$http',\n    '$q'\n];\n\nclickOutsideElement.$inject = [\n    '$document'\n];\n\nVariableTypeResource.$inject = [\n    '$http',\n    '$q'\n];\n\nangular\n    .module(MODULE_NAME, [\n        'pascalprecht.translate',\n        'ui.router',\n        'ngTable',\n        'clearcode.tm.alert',\n        'clearcode.tm.pageInfo',\n        'clearcode.tm.tagContainer'\n    ])\n    .config([\n        '$stateProvider',\n\n        ($stateProvider) => {\n            $stateProvider\n                .state('variables', {\n                    url: '/containers/{containerId}/variables',\n                    controller: `${MODULE_NAME}.ManageController as view`,\n                    templateUrl: `${MODULE_DIR}/views/manage.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: true\n                    }\n                })\n                .state('variableCreate', {\n                    url: '/containers/{containerId}/variable-create',\n                    controller: `${MODULE_NAME}.CreateController as view`,\n                    templateUrl: `${MODULE_DIR}/views/create.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: true\n                    }\n                })\n                .state('variableEdit', {\n                    url: '/containers/{containerId}/variable-edit/{variableId}',\n                    controller: `${MODULE_NAME}.EditController as view`,\n                    templateUrl: `${MODULE_DIR}/views/edit.html`,\n                    data: {\n                        roles: [\n                            'ROLE_SUPER_ADMIN'\n                        ],\n                        hasContainerList: true\n                    }\n                });\n        }\n    ])\n    .run([\n        'clearcode.tm.alert.$alert',\n        ($alertProvider) => {\n            $alertProvider.addMessagePattern(\n                'variables.close',\n                'You are trying to close unsaved variable.'\n            );\n        }\n    ])\n    .controller(`${MODULE_NAME}.ManageController`, ManageController)\n    .controller(`${MODULE_NAME}.CreateController`, CreateController)\n    .controller(`${MODULE_NAME}.EditController`, EditController)\n    .controller(`${MODULE_NAME}.SelectorController`, SelectorController)\n    .service(`${MODULE_NAME}.variableResource`, VariableResource)\n    .service(`${MODULE_NAME}.variableTypeResource`, VariableTypeResource)\n    .provider(`${MODULE_NAME}.$variableForm`, VariableFormProvider)\n    .service(`${MODULE_NAME}.variableSelector`, VariableSelector)\n    .directive('variableSelector', variableSelectorDirective)\n    .directive('variableClickOutside', clickOutsideElement);\n\nmodule.exports = {MODULE_NAME};\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport AlertProvider from './providers/AlertProvider.js';\nimport AlertController from './controllers/AlertController.js';\nimport AlertDirective from './directives/AlertDirective.js';\nimport Alert from './services/Alert.js';\nimport RefreshAlert from './services/RefreshAlert.js';\nimport AlertStorage from './services/AlertStorage.js';\nimport UniqueStorage from './services/UniqueStorage.js';\n\nconst MODULE_NAME = 'clearcode.tm.alert';\n\nAlert.$inject = [\n    '$timeout',\n    `${MODULE_NAME}.alertStorage`,\n    `${MODULE_NAME}.$alert`,\n    '$translate'\n];\n\nRefreshAlert.$inject = [\n    '$timeout',\n    `${MODULE_NAME}.alertStorage`,\n    `${MODULE_NAME}.$alert`,\n    '$translate',\n    '$window'\n];\n\nAlertDirective.$inject = [\n    `${MODULE_NAME}.alert`,\n    `${MODULE_NAME}.$alert`,\n    '$window'\n];\n\nAlertController.$inject = [\n    `${MODULE_NAME}.alertStorage`\n];\n\nangular\n    .module(MODULE_NAME, ['pascalprecht.translate', 'ngSanitize', 'ngAnimate'])\n    .provider(`${MODULE_NAME}.$alert`, AlertProvider)\n    .factory(`${MODULE_NAME}.alertStorage`, () => new AlertStorage())\n    .factory(`${MODULE_NAME}.alertUniqueStorage`, () => new UniqueStorage())\n    .service(`${MODULE_NAME}.alert`, Alert)\n    .service(`${MODULE_NAME}.refreshAlert`, RefreshAlert)\n    .directive('ccNotification', AlertDirective)\n    .controller(`${MODULE_NAME}.AlertController`, AlertController);\n\nmodule.exports = {MODULE_NAME};\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name alert#AlertController\n * @namespace clearcode.tm.form\n */\nclass AlertController {\n    /**\n     * @param {AlertStorage} storage\n     */\n    constructor (AlertStorage) {\n        this.storage = AlertStorage;\n    }\n\n    getAll () {\n        return this.storage.getAlerts();\n    }\n\n    remove (id) {\n        this.storage.remove(id);\n    }\n\n    clear () {\n        this.storage.clean();\n    }\n}\n\nexport default AlertController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name alert#AlertDirective\n * @namespace clearcode.tm.alert\n */\n\nvar alertDirective = (Alert, alertProvider) => {\n    return {\n        restrict: 'E',\n        templateUrl: 'modules/alert/views/alert.html',\n        scope: {\n            interval: '='\n        },\n        controller: 'clearcode.tm.alert.AlertController',\n        controllerAs: 'alertCtrl',\n        link: (scope) => {\n            Alert.settings.interval = angular.isDefined(scope.interval) ? scope.interval : alertProvider.interval;\n        }\n    };\n};\n\nexport default alertDirective;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name alert#AlertProvider\n * @namespace clearcode.tm.alert\n */\n/* eslint-disable */\nclass AlertProvider {\n    constructor () {\n        this.interval = 6000;\n        this.messagePatterns = {};\n    }\n\n    /**\n     * @description Add message pattern\n     *\n     * @param {String} id\n     * @param {String} pattern\n     * @returns {AlertProvider}\n     */\n    addMessagePattern (id, pattern) {\n        if (this.messagePatterns[id] !== undefined) {\n            throw new Error('Pattern with provided id already exist');\n        }\n\n        this.messagePatterns[id] = pattern;\n\n        return this;\n    }\n\n    /**\n     * @description Add message patterns from array of objects\n     *\n     * @param {Array} patterns\n     * @returns {AlertProvider}\n     */\n     addMessagesPattern (patterns) {\n        if (!angular.isArray(patterns)) {\n            throw new Error(\n                `AlertProvider.addMessagesPattern expects\n                 first argument to be Array but received ${(typeof patterns)}`\n            );\n        }\n\n        angular.forEach(patterns, (obj) => {\n            if (angular.isObject(obj)) {\n                angular.forEach(obj, (elem, key) => {\n                    this.addMessagePattern(key, elem);\n                });\n            }\n        });\n\n        return this;\n    }\n\n    /**\n     * @description Get specific message pattern by id\n     *\n     * @param {String} id\n     * @returns {String|Boolean}\n     */\n    getMessagePattern (id) {\n        if (this.messagePatterns[id] !== undefined) {\n            return this.messagePatterns[id];\n        }\n\n        return false;\n    }\n\n    $get () {\n        return this;\n    }\n}\n/* eslint-enable */\nexport default AlertProvider;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\nlet removeAfterTimeout = function (id) {\n    if (this.settings.interval > 0) {\n        return this.$timeout(() => {\n            this.storage.remove(id);\n        }, this.settings.interval);\n    }\n};\n\nlet addAlert = function (type, pattern, params) {\n    let id,\n        message = this.convertToMessage(pattern, params);\n\n    this\n        .translate([message])\n        .then((translations) => {\n            id = this.storage.add(type, translations[message]);\n            removeAfterTimeout.call(this, id);\n\n            return id;\n        });\n};\n\nclass Alert {\n    constructor ($timeout, storage, provider, $translate) {\n        /**\n         * @type {AlertStorage}\n         */\n        this.storage = storage;\n        /**\n         * @type {Object}\n         */\n        this.$timeout = $timeout;\n        /**\n         * @type {TranslationProvider}\n         */\n        this.settings = this.settings === undefined\n            ? provider\n            : angular.extend(this.settings, provider);\n\n        /**\n         * @readonly\n         * @type {string}\n         */\n        this.INFO_TYPE = 'info';\n\n        /**\n         * @readonly\n         * @type {string}\n         */\n        this.ERROR_TYPE = 'danger';\n\n        /**\n         * @readonly\n         * @type {string}\n         */\n        this.SUCCESS_TYPE = 'success';\n\n        /**\n         * @readonly\n         * @type {$translate}\n         */\n        this.translate = $translate;\n    }\n\n    success (id, params = []) {\n        addAlert.call(this, this.SUCCESS_TYPE, id, params);\n    }\n\n    error (id, params = []) {\n        addAlert.call(this, this.ERROR_TYPE, id, params);\n    }\n\n    info (id, params = []) {\n        addAlert.call(this, this.INFO_TYPE, id, params);\n    }\n\n    getStorage () {\n        return this.storage;\n    }\n\n    convertToMessage (pattern, params) {\n        if (angular.isDefined(pattern)) {\n            pattern = this.settings.getMessagePattern(pattern);\n        }\n\n        return vsprintf(pattern, params);\n    }\n}\n\nexport default Alert;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nlet indicator;\n\nclass AlertStorage {\n    constructor () {\n        indicator = 0;\n        this.collection = {};\n    }\n\n    getAlerts () {\n        return this.collection;\n    }\n\n    getAlert (id) {\n        return this.collection[id];\n    }\n\n    add (type, message) {\n        this.collection[indicator] = {\n            type: type,\n            message: message\n        };\n\n        return indicator++;\n    }\n\n    has (type, message) {\n        for (var alert in this.collection) {\n            if (type === this.collection[alert].type && message === this.collection[alert].message) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    remove (id) {\n        if (this.collection[id] === undefined) {\n            return false;\n        }\n\n        delete this.collection[id];\n\n        return true;\n    }\n\n    clean () {\n        this.collection = {};\n    }\n}\n\nexport default AlertStorage;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport Alert from './Alert.js';\n\n/**\n * @name alert#RefreshAlert\n * @namespace clearcode.tm.alert\n */\nclass RefreshAlert extends Alert {\n    constructor ($timeout, storage, provider, $translate, $window) {\n        super($timeout, storage, provider, $translate);\n        this.window = $window;\n    }\n\n    /**\n     * Add success message after refresh page\n     *\n     * @param localStorageKey\n     * @param message\n     */\n    success (localStorageKey, message) {\n        if (this.window.localStorage[localStorageKey]) {\n            super.success(message);\n            this.window.localStorage.removeItem(localStorageKey);\n        }\n    }\n}\n\nexport default RefreshAlert;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport AlertStorage from './AlertStorage.js';\n\n/**\n * @name alert#UniqueStorage\n * @namespace clearcode.tm.alert\n */\nclass UniqueStorage extends AlertStorage {\n    /**\n     * @description Add alert to collection\n     *\n     * @param {String} type\n     * @param {String} message\n     * @returns {Number}\n     */\n    add (type, message) {\n        if (this.has(type, message)) {\n            return -1;\n        }\n        return super.add(type, message);\n    }\n}\n\nexport default UniqueStorage;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport clipboard from './directives/clipboardDirective.js';\n\nconst MODULE_NAME = 'clearcode.tm.clipboard';\n\nclipboard.$inject = [\n    '$compile',\n    '$document'\n];\n\nangular\n    .module(MODULE_NAME, ['ngClipboard'])\n    .directive('ccClipboard', clipboard);\n\nmodule.exports = {MODULE_NAME};\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar clipboardDirective = ($compile, $document) => {\n    return {\n        restrict: 'A',\n        scope: {\n            ngModel: '='\n        },\n        link: (scope, element) => {\n            element.wrap('<div class=\"cc-clipboard\"></div>');\n\n            let template = angular.element($document[0].getElementById('clipboard.html')).html(),\n                tplElement = $compile(template)(scope),\n                clipboard = element.parent();\n\n            clipboard.append(tplElement);\n\n            let button = clipboard.find('button');\n\n            button.addClass('hidden');\n\n            clipboard.on('mouseenter', setCopyButtonVisible(true))\n                .on('mouseleave', setCopyButtonVisible(false));\n\n            scope.copyToClipboard = () => scope.ngModel;\n\n            function setCopyButtonVisible (setVisible) {\n                return (event) => {\n                    if (!eventTriggeredOverTextArea(event)) {\n                        return;\n                    }\n\n                    if (setVisible) {\n                        button.removeClass('hidden');\n                    } else {\n                        button.addClass('hidden');\n                    }\n                }\n            }\n\n            function eventTriggeredOverTextArea (event) {\n                let target = event.target || event.srcElement;\n                return target && target.nodeName === 'TEXTAREA';\n            }\n        }\n    };\n};\n\nexport default clipboardDirective;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport confirmDirective from './directives/ConfirmDirective.js';\n\nconst MODULE_NAME = 'clearcode.tm.confirm';\n\nangular\n    .module(MODULE_NAME, [])\n    .directive('ccConfirm', confirmDirective);\n\nmodule.exports = {MODULE_NAME};\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar confirmDirective = () => {\n    return {\n        restrict: 'A',\n        templateUrl: 'modules/confirm/views/confirm.html',\n        transclude: true,\n        replace: true,\n        scope: {\n            ccConfirm: '&'\n        },\n        link: (scope) => {\n            scope.turnOn = false;\n\n            scope.approve = () => {\n                scope.ccConfirm();\n            };\n\n            scope.cancel = () => {\n                scope.turnOn = false;\n            };\n\n            scope.confirm = () => {\n                scope.turnOn = true;\n            };\n        }\n    };\n};\n\nexport default confirmDirective;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport AlertController from '../../alert/controllers/AlertController.js';\n\n/**\n * @name alert#AlertFormController\n * @namespace clearcode.tm.alert\n */\nclass AlertFormController extends AlertController {\n}\n\nexport default AlertFormController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name form#AlertFormDirective\n * @namespace clearcode.tm.form\n */\n\nvar alertFormDirective = (Alert, alertProvider) => {\n    return {\n        restrict: 'E',\n        templateUrl: 'modules/form/views/alertForm.html',\n        scope: {\n            interval: '='\n        },\n        controller: 'clearcode.tm.form.AlertFormController',\n        controllerAs: 'alertFormCtrl',\n        link: (scope) => {\n            Alert.settings.interval = angular.isDefined(scope.interval) ? scope.interval : alertProvider.interval;\n        }\n    };\n};\n\nexport default alertFormDirective;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name form#CheckboxDirective\n * @namespace clearcode.tm.form\n */\nvar CheckboxDirective = () => {\n    return {\n        restrict: 'A',\n        require: '?ngModel',\n        scope: {\n            ngModel: '=',\n            ngDisabled: '='\n        },\n        link: (scope, element, attrs) => {\n            var checkedClass = 'cc-checkbox-checked',\n                disabledClass = 'cc-checkbox-disabled';\n\n            element.wrap('<div class=\"cc-checkbox\"></div>');\n\n            if (scope.ngModel !== undefined) {\n                updateViewFromValue(scope.ngModel);\n            }\n\n            scope.$watch('ngModel', updateViewFromValue);\n\n            scope.$watch('ngDisabled', (isDisabled) => {\n                if (isDisabled) {\n                    element.parent().addClass(disabledClass);\n                } else {\n                    element.parent().removeClass(disabledClass);\n                }\n            });\n\n            function updateViewFromValue (value) {\n                if (value === true || isEqualToCustomTrueValue(value)) {\n                    element.parent().addClass(checkedClass);\n                } else {\n                    element.parent().removeClass(checkedClass);\n                }\n            }\n\n            function isEqualToCustomTrueValue (value) {\n                return attrs.ngTrueValue !== undefined && value === attrs.ngTrueValue;\n            }\n        }\n    };\n};\n\nexport default CheckboxDirective;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name form#CheckboxDirective\n * @namespace clearcode.tm.form\n */\n/* eslint-disable */\nvar RadioButtonDirective = () => {\n\n    return {\n        restrict: 'A',\n        require: '?ccRadioModel',\n        scope: {\n            ccRadioModel: '=',\n            ccDisabled: '='\n        },\n        link: (scope, element, attrs) => {\n\n            element.wrap('<div class=\"cc-radio\"></div>');\n\n            if (scope.ccRadioModel !== undefined) {\n\n                if(scope.ccDisabled) {\n\n                    element.parent().addClass('radioDisabled');\n\n                }\n\n                if (scope.ccRadioModel === element[0].defaultValue) {\n\n                    element.parent().addClass('radioSelected');\n\n                } else {\n\n                    element.parent().removeClass('radioSelected');\n\n                }\n\n            }\n\n            scope.$watch('ccRadioModel', (value) => {\n\n                if (value === element[0].defaultValue) {\n\n                    element.parent().addClass('radioSelected');\n\n                } else {\n\n                    element.parent().removeClass('radioSelected');\n\n                }\n\n            });\n\n        }\n    };\n\n};\n/* eslint-enable */\n\nexport default RadioButtonDirective;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name form#SelectDirective\n * @namespace clearcode.tm.form\n */\n\nvar SelectDirective = ($compile) => {\n    return {\n        restrict: 'A',\n        priority: 1,\n        scope: {\n            ngModel: '=',\n            ccSelectOptions: '=',\n            ccSelectValue: '@',\n            ccSelectLabel: '@'\n        },\n        link: (scope, element, attrs) => {\n            /* eslint-disable */\n            element.wrap('<div class=\"cc-select\"></div>');\n            /* eslint-enable */\n            element.addClass('ng-hide');\n\n            var template = angular.element(document.getElementById('select-template.html')).html();\n            var tmpElement = $compile(template)(scope);\n\n            element.parent().append(tmpElement);\n\n            scope.id = attrs.id;\n\n            var searchByValue = (value) => {\n                for (var index in scope.ccSelectOptions) {\n                    if (scope.ccSelectOptions[index][scope.ccSelectValue] === value) {\n                        return index;\n                    }\n                }\n\n                return false;\n            };\n\n            scope.getActiveOptionLabel = () => {\n                var index = searchByValue(scope.ngModel);\n\n                if (index !== false) {\n                    return scope.ccSelectOptions[index][scope.ccSelectLabel];\n                } else {\n                    return '';\n                }\n            };\n\n            scope.changeSelection = (element) => {\n                scope.ngModel = element[scope.ccSelectValue];\n            };\n        }\n    };\n};\n\nexport default SelectDirective;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport CheckboxDirective from './directives/CheckboxDirective.js';\nimport RadioButtonDirective from './directives/RadioButtonDirective.js';\nimport SelectDirective from './directives/SelectDirective.js';\nimport AlertForm from './services/AlertForm.js';\nimport AlertFormDirective from './directives/AlertFormDirective.js';\nimport AlertFormController from './controller/AlertFormController.js';\n\nconst MODULE_NAME = 'clearcode.tm.form';\n\nAlertForm.$inject = [\n    '$timeout',\n    'clearcode.tm.alert.alertUniqueStorage',\n    'clearcode.tm.alert.$alert',\n    '$translate'\n];\n\nAlertFormDirective.$inject = [\n    `${MODULE_NAME}.alertForm`,\n    'clearcode.tm.alert.$alert'\n];\n\nAlertFormController.$inject = [\n    'clearcode.tm.alert.alertUniqueStorage'\n];\n\nSelectDirective.$inject = [\n    '$compile'\n];\n\nangular\n    .module(MODULE_NAME, [\n        'pascalprecht.translate',\n        'clearcode.tm.alert'\n    ])\n    .service(`${MODULE_NAME}.alertForm`, AlertForm)\n    .directive('ccSelect', SelectDirective)\n    .directive('ccCheckbox', CheckboxDirective)\n    .directive('ccRadio', RadioButtonDirective)\n    .directive('ccNotificationForm', AlertFormDirective)\n    .controller(`${MODULE_NAME}.AlertFormController`, AlertFormController);\n\nmodule.exports = {MODULE_NAME};\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport Alert from '../../alert/services/Alert.js';\n\n/**\n * @name alert#AlertForm\n * @namespace clearcode.tm.form\n */\n\nclass AlertForm extends Alert {\n}\n\nexport default AlertForm;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name helpSystem#HelpSystemDirective\n * @namespace clearcode.tm.helpSystem\n */\n\nvar helpSystemDirective = () => {\n    return {\n        restrict: 'EA',\n        replace: true,\n        scope: { content: '@', placement: '@' },\n        templateUrl: 'modules/helpSystem/views/helpSystem.html'\n    };\n};\n\nexport default helpSystemDirective;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport HelpSystemDirective from './directives/HelpSystemDirective.js';\n\nconst MODULE_NAME = 'clearcode.tm.helpSystem';\n\nangular\n    .module(MODULE_NAME, [])\n    .directive( 'ccHelp', HelpSystemDirective);\n\nmodule.exports = {MODULE_NAME};\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @type {$state}\n */\nvar state;\n\nclass BreadcrumbController {\n    /**\n     * @param PageInfo\n     */\n    constructor (scope, $state, PageInfo) {\n        this.breadcrumb = PageInfo.get();\n        state = $state;\n\n        scope.$on('page.info', () => {\n            this.breadcrumb = PageInfo.get();\n        });\n    }\n\n    /**\n     * @param breadcrumb\n     */\n    stateGo (breadcrumb) {\n        state.go(breadcrumb.state, breadcrumb.params);\n    }\n}\n\nexport default BreadcrumbController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @type {String}\n */\nconst DEFAULT_TITLE = 'Impono Tag Manager';\n\nclass TitleController {\n    /**\n     * @param {Object} scope\n     * @param PageInfo\n     */\n    constructor (scope, PageInfo) {\n        this.title = DEFAULT_TITLE;\n        this.default = DEFAULT_TITLE;\n\n        scope.$on('page.info', () => {\n            this.info = PageInfo.get();\n            this.setTitle();\n        });\n    }\n\n    setTitle () {\n        /* eslint-disable */\n        this.title = this.info.map(element => element.name).reduce((previous, current) => previous += ' - ' + current);\n        /* eslint-enable */\n    }\n}\n\nexport default TitleController;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name pageInfo#BreadcrumbDirective\n * @namespace clearcode.tm.pageInfo\n */\nvar breadcrumbDirective = () => {\n    return {\n        restrict: 'E',\n        templateUrl: 'modules/pageInfo/views/breadcrumb.html',\n        controller: 'clearcode.tm.pageInfo.BreadcrumbController',\n        controllerAs: 'breadcrumbCtrl'\n    };\n};\n\nexport default breadcrumbDirective;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name pageInfo#TitleDirective\n * @namespace clearcode.tm.pageInfo\n */\nvar titleDirective = () => {\n    return {\n        restrict: 'A',\n        controller: 'clearcode.tm.pageInfo.TitleController',\n        controllerAs: 'titleCtrl'\n    };\n};\n\nexport default titleDirective;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport BreadcrumbController from './controllers/BreadcrumbController.js';\nimport TitleController from './controllers/TitleController.js';\nimport BreadcrumbDirective from './directives/BreadcrumbDirective.js';\nimport PageInfo from './services/PageInfo.js';\nimport TitleDirective from './directives/TitleDirective.js';\n\nconst MODULE_NAME = 'clearcode.tm.pageInfo';\n\nBreadcrumbController.$inject = [\n    '$scope',\n    '$state',\n    `${MODULE_NAME}.pageInfo`\n];\n\nTitleController.$inject = [\n    '$scope',\n    `${MODULE_NAME}.pageInfo`\n];\n\nPageInfo.$inject = [\n    '$rootScope'\n];\n\nangular\n    .module(MODULE_NAME, [])\n    .controller(`${MODULE_NAME}.BreadcrumbController`, BreadcrumbController)\n    .controller(`${MODULE_NAME}.TitleController`, TitleController)\n    .directive('ccBreadcrumb', BreadcrumbDirective)\n    .directive('ccTitle', TitleDirective)\n    .service(`${MODULE_NAME}.pageInfo`, PageInfo);\n\nmodule.exports = {MODULE_NAME};\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @type {rootScope}\n */\nvar rootScope;\n\nclass PageInfo {\n    /**\n     * @param $rootScope\n     */\n    constructor ($rootScope) {\n        this.navigation = [];\n        rootScope = $rootScope;\n    }\n\n    /**\n     * @param name\n     * @param state\n     * @param params\n     *\n     * @return {PageInfo}\n     */\n    add (name, state, params) {\n        this.navigation.push({\n            name: name,\n            state: state,\n            params: params\n        });\n\n        return this;\n    }\n\n    /**\n     * @return {PageInfo}\n     */\n    clear () {\n        this.navigation = [];\n\n        return this;\n    }\n\n\n    /**\n     * Gives signal into breadcrumb and title\n     */\n    broadcast () {\n        rootScope.$broadcast('page.info');\n    }\n\n    /**\n     * @return {Array}\n     */\n    get () {\n        return this.navigation;\n    }\n}\n\nexport default PageInfo;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * Math.ceil in angular filter\n *\n * @returns {Function}\n */\nvar tmCeilFilter = () => {\n    return (number) => {\n        return Math.ceil(number);\n    };\n};\n\nexport default tmCeilFilter;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar tmDateFilter = ($filter, defaultDateFormat) => {\n    var angularDateFilter = $filter('date');\n\n    return (theDate, format = null) => {\n        if (format === null) {\n            format = defaultDateFormat;\n        }\n\n        return angularDateFilter(theDate, format);\n    };\n};\n\nexport default tmDateFilter;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport tmDateFilter from './filters/tmDateFilter.js';\nimport tmCeilFilter from './filters/tmCeilFilter.js';\n\nconst MODULE_NAME = 'clearcode.tm.sanitize';\n\ntmDateFilter.$inject = [\n    '$filter',\n    'defaultDateFormat'\n];\n\nangular\n    .module(MODULE_NAME, [])\n    .filter('tmDate', tmDateFilter)\n    .filter('tmCeil', tmCeilFilter);\n\nmodule.exports = {MODULE_NAME};\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @name HTMLLinter\n */\nclass HTMLLinter {\n    constructor ($window) {\n        this.$window = $window;\n    }\n\n    lint (text, lintRules) {\n        return this.$window.HTMLHint ? this.$window.HTMLHint.verify(text, lintRules) : [];\n    }\n}\n\nexport default HTMLLinter;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nconst HTML_LINT_RULES = {\n    'tagname-lowercase': false,\n    'attr-lowercase': false,\n    'attr-value-double-quotes': false,\n    'attr-value-not-empty': false,\n    'attr-no-duplication': false,\n    'doctype-first': false,\n    'tag-pair': false,\n    'tag-self-close': false,\n    'spec-char-escape': false,\n    'id-unique': false,\n    'src-not-empty': false,\n    'title-require': false,\n    'head-script-disabled': false,\n    'doctype-html5': false,\n    'id-class-value': false,\n    'style-disabled': false,\n    'inline-style-disabled': false,\n    'inline-script-disabled': false,\n    'space-tab-mixed-disabled': false,\n    'id-class-ad-disabled': false,\n    'href-abs-or-rel': false,\n    'attr-unsafe-chars': false,\n};\n\nconst JS_LINT_RULES = {\n    browser: true,\n    devel: true,\n    dojo: true,\n    jquery: true,\n    mootools: true,\n    nonstandard: true,\n    prototypejs: true,\n    yui: true,\n    bitwise: false,\n    camelcase: false,\n    curly: true,\n    enforceall: false,\n    eqeqeq: true,\n    es3: false,\n    es5: false,\n    forin: false,\n    freeze: false,\n    funcscope: true,\n    futurehostile: true,\n    immed: false,\n    latedef: false,\n    nocomma: true,\n    nonew: true,\n    notypeof: true,\n    shadow: 'inner',\n    strict: false,\n    sub: false,\n    undef: true,\n    unused: true,\n    asi: true\n};\n\n/**\n * @name LintingRules\n */\nclass LintingRules {\n    getLintingRules () {\n        let jsHintRules = angular.copy(JS_LINT_RULES),\n            htmlHintRules = angular.copy(HTML_LINT_RULES);\n\n        htmlHintRules.jshint = jsHintRules;\n\n        return htmlHintRules;\n    }\n}\n\nexport default LintingRules;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nconst HTML_HEAD_WRAP_START = '<!DOCTYPE HTML><html><head>';\nconst HTML_HEAD_WRAP_END = '</head><body></body></html>';\n\n/**\n * @name TagTemplateLinter\n */\nclass TagTemplateLinter {\n    constructor (tagTemplateToJsConverter, lintingRules, htmlLinter) {\n        this.tagTemplateToJsConverter = tagTemplateToJsConverter;\n        this.lintingRules = lintingRules;\n        this.htmlLinter = htmlLinter;\n    }\n\n    validate (text, options, cm) {\n        if (options.deactivate) {\n            return [];\n        }\n\n        let htmlWrappedText = this.wrapInHtmlTag(text),\n            lines = htmlWrappedText.split('\\n');\n\n        this.tagTemplateToJsConverter.convert(lines, cm.options);\n\n        let tagTemplateWithFixedJsText = lines.join('\\n'),\n            allErrors = this.lint(tagTemplateWithFixedJsText, options),\n            jsErrors = this.filterOutHtmlErrors(allErrors, lines.length),\n            errors = [];\n\n        for (let i = 0; i < jsErrors.length; i++) {\n            errors.push(this.mapToLintRepresentation(jsErrors[i]));\n        }\n\n        return errors;\n    }\n\n    wrapInHtmlTag (text) {\n        return `${HTML_HEAD_WRAP_START}\n                ${text}\n                ${HTML_HEAD_WRAP_END}`;\n    }\n\n    filterOutHtmlErrors (errors, lineCount) {\n        let jsErrors = [];\n\n        for (let i = 0; i < errors.length; i++) {\n            let error = errors[i];\n\n            if (!this.isHtmlError(error, lineCount)) {\n                error.line -= 1;\n                jsErrors.push(error);\n            }\n        }\n\n        return jsErrors;\n    }\n\n    isHtmlError (error, lastLineIdx) {\n        return error.line === 0 || error.line === lastLineIdx;\n    }\n\n    lint (text, options) {\n        options = options || {};\n        let lintRules = angular.extend({}, this.lintingRules.getLintingRules(), options);\n\n        return this.htmlLinter.lint(text, lintRules);\n    }\n\n    /* eslint-disable */\n    mapToLintRepresentation (message) {\n        return {\n            from: CodeMirror.Pos(message.line - 1, 0),\n            to: CodeMirror.Pos(message.line - 1, 0),\n            message: message.message,\n            severity : message.type\n        };\n    }\n    /* eslint-enable */\n}\n\nexport default TagTemplateLinter;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nconst TAG_TEMPLATE_VARIABLE_START = '{{';\nconst TAG_TEMPLATE_VARIABLE_END = '}}';\n\n\nclass TagTemplateToJsConverter {\n    convert (textLines, options) {\n        if (!options || !options.variables) {\n            return textLines;\n        }\n\n        let variables = this.getVariables(options),\n            lineIdx = 0;\n\n        while (!this.isCursorAfterTheEndOfText(textLines.length, lineIdx)) {\n            let line = textLines[lineIdx],\n                lineContainsVariable = line.indexOf(TAG_TEMPLATE_VARIABLE_START) !== -1;\n\n            if (lineContainsVariable) {\n                textLines[lineIdx] = this.replaceVariablesExpressions(variables, line);\n            }\n\n            ++lineIdx;\n        }\n\n        return textLines;\n    }\n\n    isCursorAfterTheEndOfText (totalLines, line) {\n        return line >= totalLines\n    }\n\n    getVariables (options) {\n        let variables = [];\n\n        for (let i = 0; i < options.variables.length; i++) {\n            let variable = options.variables[i],\n                words = variable.name.trim().split(/\\s+/),\n                variableObj = {\n                    name: variable.name,\n                    pattern: this.createVariableSearchPattern(variable.name),\n                    replacement: `'${words.join('_')}'`\n                };\n\n            variables.push(variableObj);\n        }\n\n        return variables;\n    }\n\n    createVariableSearchPattern (variableName) {\n        let whitespace = '[\\\\s]',\n            words = variableName.split(/[\\s]+/),\n            regexStr = words.join(`${whitespace}+`);\n\n        regexStr = `${TAG_TEMPLATE_VARIABLE_START}${whitespace}*${regexStr}${whitespace}*${TAG_TEMPLATE_VARIABLE_END}`;\n\n        return new RegExp(regexStr, 'g');\n    }\n\n    replaceVariablesExpressions (variables, line) {\n        for (let i = 0; i < variables.length; i++) {\n            let variable = variables[i];\n            line = line.replace(variable.pattern, variable.replacement);\n        }\n\n        return line;\n    }\n}\n\nexport default TagTemplateToJsConverter;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nconst DEFAULT_CONFIG = {\n    mode: {\n        name: 'htmlmixed'\n    },\n    lineNumbers: true,\n    styleActiveLine: true,\n    matchBrackets: true,\n    theme: 'stg',\n    gutters: ['CodeMirror-lint-markers'],\n    lint: {}\n};\n\n/**\n * @name TextEditorConfig\n */\nclass TextEditorConfig {\n  /**\n   * @param {TagTemplateLinter} tagTemplateLinter\n   */\n    constructor (tagTemplateLinter) {\n        this.tagTemplateLinter = tagTemplateLinter;\n    }\n\n    /**\n     * @param {Object} configOverrides\n     *\n     * @return {Object}\n     */\n    getConfig (configOverrides) {\n        var overrides = angular.isObject(configOverrides) ? configOverrides : {},\n            cfg = angular.extend({}, DEFAULT_CONFIG, overrides);\n\n        cfg.lint.getAnnotations = (value, opt, cm) => {\n            return this.tagTemplateLinter.validate(value, opt, cm)\n        };\n\n        return cfg;\n    }\n}\n\nexport default TextEditorConfig;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport TextEditorConfig from './service/TextEditorConfig.js';\nimport TagTemplateLinter from './service/TagTemplateLinter.js';\nimport TagTemplateToJsConverter from './service/TagTemplateToJsConverter.js';\nimport LintingRules from './service/LintingRules.js';\nimport HTMLLinter from './service/HTMLLinter.js';\n\nconst MODULE_NAME = 'clearcode.tm.textEditor';\n\nTextEditorConfig.$inject = [\n    `${MODULE_NAME}.TagTemplateLinter`\n];\n\nTagTemplateLinter.$inject = [\n    `${MODULE_NAME}.TagTemplateToJsConverter`,\n    `${MODULE_NAME}.LintingRules`,\n    `${MODULE_NAME}.HTMLLinter`\n];\n\nHTMLLinter.$inject = [\n    '$window'\n];\n\n\nangular\n    .module(MODULE_NAME, [])\n    .service(`${MODULE_NAME}.LintingRules`, LintingRules)\n    .service(`${MODULE_NAME}.HTMLLinter`, HTMLLinter)\n    .service(`${MODULE_NAME}.TagTemplateToJsConverter`, TagTemplateToJsConverter)\n    .service(`${MODULE_NAME}.TagTemplateLinter`, TagTemplateLinter)\n    .service(`${MODULE_NAME}.TextEditorConfig`, TextEditorConfig)\n    .run([\n        '$rootScope',\n        `${MODULE_NAME}.TextEditorConfig`,\n\n        ($rootScope, TextEditorConfig) => {\n            $rootScope.TextEditorConfig = TextEditorConfig;\n        }]);\n\nmodule.exports = {MODULE_NAME};\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar translationFactory = ($http, $q) => {\n    return function (options) {\n        var deferred = $q.defer();\n\n        $http({\n            method: 'GET',\n            url: options.url,\n            cache: options.cache\n        })\n            .success((data) => {\n                deferred.resolve(data);\n            })\n            .error(() => {\n                deferred.reject();\n            });\n\n        return deferred.promise;\n    };\n};\n\nexport default translationFactory;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nclass Translation {\n    constructor (translationFactory) {\n        this.languages = [];\n        this.translationFactory = translationFactory;\n    }\n\n    /**\n     * @returns {*}\n     */\n    getLanguages () {\n        return this.languages;\n    }\n\n    /**\n     * @param language\n     * @returns {boolean}\n     */\n    hasLanguage (language) {\n        return this.languages.hasOwnProperty(language);\n    }\n\n    loadAvailableTranslations () {\n        return this.translationFactory({\n            url: '/api/translations',\n            cache: false\n        }).then((data) => {\n            for (let key in data) {\n                this.languages.push({\n                    id: key,\n                    name: data[key]\n                });\n            }\n        });\n    }\n}\n\nexport default Translation;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport TranslationFactory from './factory/TranslationFactory.js';\nimport Translation from './services/Translation.js';\n\nconst MODULE_NAME = 'clearcode.tm.translation';\n\nTranslationFactory.$inject = [\n    '$http',\n    '$q'\n];\n\nTranslation.$inject = [\n    `${MODULE_NAME}.translationFactory`\n];\n\nangular\n    .module(MODULE_NAME, [])\n    .factory(`${MODULE_NAME}.translationFactory`, TranslationFactory)\n    .service(`${MODULE_NAME}.translation`, Translation);\n\nmodule.exports = {MODULE_NAME};\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @name validator#stgFormDirective\n * @namespace clearcode.tm.validator\n */\n\nlet isPromise = (promise) => {\n    if (typeof promise === 'object' && typeof promise.then === 'function') {\n        return true;\n    }\n\n    return false;\n};\n\nvar stgFormDirective = function ($alertProvider, $alertForm) {\n    return {\n        restrict: 'A',\n        scope: {\n            formResource: '='\n        },\n        link: (scope, element) => {\n            scope.$watch('formResource', (formPromise) => {\n                if (formPromise && isPromise(formPromise)) {\n                    formPromise.then(\n                        () => {},\n                        (resp) => {\n                            if (resp.errors.hasOwnProperty('form')) {\n                                if (!$alertProvider.getMessagePattern('login.server')) {\n                                    $alertProvider.addMessagePattern(\n                                        'login.server',\n                                        resp.errors.form[0]\n                                    );\n                                }\n\n                                $alertForm.getStorage().clean();\n                                $alertForm.error('login.server');\n                            }\n\n                            for (let field in resp.errors.fields) {\n                                if (resp.errors.fields.hasOwnProperty(field)) {\n                                    let form = scope.$parent[element[0].attributes.name.value];\n\n                                    if (isNotEmptyArray(resp, field)) {\n                                        form[field].$invalid = true;\n                                        form[field].$setDirty();\n                                        form[field].$error[field] = resp.errors.fields[field];\n                                    } else {\n                                        for (let nested in resp.errors.fields[field].fields) {\n                                            if (isNested(resp, field, nested)) {\n                                                form[nested].$invalid = true;\n                                                form[nested].$error[nested] = resp.errors.fields[field].fields[nested];\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    );\n                }\n            }, false);\n        }\n    };\n\n    function isNotEmptyArray (resp, field) {\n        return resp.errors.fields[field] instanceof Array &&\n            resp.errors.fields[field].length !== 0\n    }\n\n    function isNested (resp, field, nested) {\n        return resp.errors.fields[field].fields.hasOwnProperty(nested) &&\n            resp.errors.fields[field].fields[nested].length !== 0\n    }\n};\n\nexport default stgFormDirective;\n","/**\n * Copyright (C) 2015 Digimedia Sp. z.o.o. d/b/a Clearcode\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any\n * later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport stgFormDirective from './directives/stgFormDirective.js';\n\nconst MODULE_NAME = 'clearcode.tm.validator';\n\nstgFormDirective.$inject = [\n    'clearcode.tm.alert.$alert',\n    'clearcode.tm.form.alertForm'\n];\n\nangular\n    .module(MODULE_NAME, [\n        'clearcode.tm.alert',\n        'clearcode.tm.form'\n    ])\n    .directive('stgForm', stgFormDirective);\n\nmodule.exports = {MODULE_NAME};\n"]}